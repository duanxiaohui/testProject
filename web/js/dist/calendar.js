function Calendar(e){this.date=e?new Date(+e):G.currDate||new Date}typeof JSON!="object"&&(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("rebuild/base/json2",function(){}),define("rebuild/base/common",["rebuild/base/json2"],function(){var e;$.route=function(t,n){t=t||{};var r;(e||(e=/([\d\w_]+)/g)).lastIndex=0;while((r=e.exec(n))!==null){t=t[r[0]];if(t==undefined)break}return t};var t;$.format=function(){var e=$.makeArray(arguments),n=String(e.shift()||""),r=[],i=e[0];return e=$.isArray(i)?i:typeof i=="object"?e:[e],$.each(e,function(e,i){r.push(n.replace(t||(t=/\{([\d\w\.]+)\}/g),function(t,n,r){return r=n==="INDEX"?e:n.indexOf(".")<0?i[n]:$.route(i,n),r===undefined?t:$.isFunction(r)?r.call(i,n):r}))}),r.join("")};var n=/[^\x00-\xff]/g;$.lenW=function(e){return e.replace(n,"**").length},$.ellipsis=function(e,t,n){e=String(e);if(isNaN(t-=0))return e;var r=e.length,i=Math.min(Math.floor(t/2),r),s=$.lenW(e.slice(0,i));for(;i<r&&s<t;i++)s+=1+(e.charCodeAt(i)>255);return e.slice(0,s>t?i-1:i)+(i<r?n||"":"")},$.r=function(e,t){var n=Math.random(),r=arguments.length;return r==2?e+Math.floor(n*(t-e)):r==1?e[Math.floor(n*e.length)]:n},$.randomArray=function(e){var t=[],n;while(n=e.length)t.push(e.splice(Math.floor(Math.random()*n),1)[0]);return t},$.isProgression=function(e){if(e.length<2)return!1;e=e.slice();for(var t=e.shift(),n=e[0]-t,r=1,i=e.length;r<i;r++)if(e[r]-e[r-1]!=n)return!1;return!0},$.cookie=function(e,t,n){if(typeof t=="undefined"){var a=null;if(document.cookie&&document.cookie!=""){var f=document.cookie.split(";");for(var l=0;l<f.length;l++){var c=jQuery.trim(f[l]);if(c.substring(0,e.length+1)==e+"="){a=decodeURIComponent(c.substring(e.length+1));break}}}return a}n=n||{},t===null&&(t="",n.expires=-1);var r="";if(n.expires&&(typeof n.expires=="number"||n.expires.toUTCString)){var i;typeof n.expires=="number"?(i=new Date,i.setTime(i.getTime()+n.expires*24*60*60*1e3)):i=n.expires,r="; expires="+i.toUTCString()}var s=n.path?"; path="+n.path:"",o=n.domain?"; domain="+n.domain:"",u=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),r,s,o,u].join("")},$.query=function(e,t){var n=new RegExp("(^|\\?|&)"+e+"=([^&^#]*)(\\s|&|#|$)","i");return t=t||location.href,n.test(t)?unescape(RegExp.$2.replace(/\+/g," ")):""},$.alert=function(e,t){t=$.extend(!0,{modal:!0,title:"温馨提示",buttons:{"确定":function(){$(this).dialog("close")}}},t),$(['<div class="dialog-content">',e,"</div>"].join("")).dialog(t)},$.confirm=function(e,t){t=$.extend(!0,{modal:!0,title:"温馨提示",buttons:[{text:"确定",click:function(){$(this).dialog("close")}},{text:"取消",click:function(){$(this).dialog("close")}}]},t),$(['<div class="dialog-content">',e,"</div>"].join("")).dialog(t)},$.loading=function(){if($.loading.is())return;var e='<div class="cld-ui-loading">				    		<div class="blue"></div>				    		<div class="red"></div>				    		<div class="black"></div>				    		<div class="green"></div>				    	</div>',t='<div class="loading_mask"></div>';$(t).appendTo("body").css({position:"absolute",width:"100%",height:$(window).height()+"px",top:"0",left:"0",background:"rgba(0,0,0,.2)","z-index":"998"}),$(e).appendTo("body").css({position:"absolute",left:"50%",top:"50%",margin:"-42px 0 0 -42px","z-index":"999"})},$.loading.close=function(){$(".cld-ui-loading").remove(),$(".loading_mask").remove()},$.loading.is=function(){return $(".cld-ui-loading:visible").size()},$.getDPOptions=function(e){return $.extend({closeText:"关闭",prevText:"&#x3C;上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},e)},function(e){function t(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(i=n.wheelDelta/120),n.detail&&(i=-n.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=-1*i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=-1*n.wheelDeltaX/120),r.unshift(t,i,o,u),(e.event.dispatch||e.event.handle).apply(this,r)}var n=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var r=n.length;r;)e.event.fixHooks[n[--r]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery),jQuery.fn.extend({propertychange:function(e){return $.browser.msie||$(this)[0].addEventListener("input",e,!1),$(this).bind("propertychange",e),this},unpropertychange:function(e){return $.browser.msie||$(this).get(0).removeEventListener("input",e,!1),$(this).unbind("propertychange",e),this}});var r={formatDate:function(e){return[e.getFullYear(),e.getMonth()+1,e.getDate()].join("-").replace(/(\D)(\d)(?=\D|$)/g,"$10$2")},browserCheck:function(){if($.browser.msie){var e=parseInt($.browser.version);if(e<8){var t=e<7?'对不起，您使用的网页浏览器版本非常古老，<br/>不仅无法使用365日历的部分功能，而且还会错过其它网站的精彩体验，<br/>强烈建议您升级您的浏览器！<br/><a href="http://www.ie6countdown.com/" target="_blank" style="color:blue">看看正在消失的IE6浏览器</a>':"尊敬的365日历用户，您想体验更好用的、更快的、更酷的365日历产品吗？请升级您的网页浏览器！";$.confirm(t,{width:500,buttons:[{text:"马上升级",click:function(){open("http://www.microsoft.com/zh-cn/download/ie.aspx?q=internet+explorer"),$(this).dialog("close")}},{text:"下次再说",click:function(){$(this).dialog("close")}}]})}}},openRegBindWin:function(){return $.confirm('<form class="form_reg"><dl><dt>用  户  名：</dt><dd><input type="text" class="username" placeholder="请输入用户名，4~20个普通字符"/></dd><dt>密码：</dt><dd><input type="password" class="password"/></dd><dd class="hint">(6-20位)</dd><dt>重复密码：</dt><dd><input type="password" class="cfmpassword"/></dd><dd class="message"></dd></dl></form>',{title:"注册365日历账号并绑定",width:420,height:280,create:function(e,t){var n=$(this),r=n.find("form"),i=r.find("input.username"),s=r.find("input.password"),o=r.find("input.cfmpassword");i.placeholder()},buttons:[{text:"绑定",click:function(){var e=$(this),t=e.find("form"),n=t.find("input.username"),r=t.find("input.password"),i=t.find("input.cfmpassword"),s=t.find("dd.message"),o=n.val(),u=r.val(),a=i.val();if(o.length==0)return s.html("请输入用户名！"),n.focus().select();if(o.length<4||o.length>20)return s.html("用户名长度应在4至20位之间！"),n.focus().select();if(null!=o.match(/[`,\.;\/\\'" \t\r\n<>\?~!@#\$%\^&\*\(\)\[\]\{\}\+\-\|]/ig))return s.html("用户名不能含有特殊字符！"),n.focus().select();if(u.length==0)return s.html("请输入密码！"),r.focus().select();if(u.length<6||u.length>20)return s.html("密码长度应为6-20位！"),r.focus().select();if(u!=a)return s.html("两次密码输入不一致！"),i.focus().select();s.html(""),$.ajax({type:"post",url:"/account/checkUsername4Bind.do",data:{username:o},success:function(e){e.state=="usernameExist"?(s.html("该名称已被占用！"),$("#div_reg").find(".tip")[0].innerHTML="该名称已被占用！"):e.state=="success"?(s.html(""),$.ajax({url:"/main/bind-365-reg.do",type:"POST",dataType:"json",data:{username:o,password:u},success:function(e){e=="success"?location.reload():s.html("对不起，系统异常，请稍后重试！")}})):e.state=="emptyUsername"?s.html("该名称已被占用！"):s.html("对不起，系统异常，请稍后重试！")}})}}]}),!1},uniform:function(e){if(String(e).slice(0,3)=="rgb"){var t=e.slice(4,-1).split(","),n=parseInt(t[0]),r=parseInt(t[1]),i=parseInt(t[2]);return["#",n<16?"0":"",n.toString(16),r<16?"0":"",r.toString(16),i<16?"0":"",i.toString(16)].join("")}return e},hslToRgb:function(e,t,n){var i,s,o;if(t==0)i=s=o=n;else{var u=n<.5?n*(1+t):n+t-n*t,a=2*n-u;i=r.hue2rgb(a,u,e+1/3),s=r.hue2rgb(a,u,e),o=r.hue2rgb(a,u,e-1/3)}return r.uniform(["rgb(",Math.round(i*255),", ",Math.round(s*255),", ",Math.round(o*255),")"].join(""))},rgbToHsl:function(e,t,n){if(typeof e=="string")return arguments.callee.apply(null,r.convertHexColor(e));e/=255,t/=255,n/=255;var i=Math.max(e,t,n),s=Math.min(e,t,n),o=0,u=0,a=(i+s)/2,f,l=i+s;if(f=i-s)u=a>.5?f/(2-l):f/l,o=(i==e?(t-n)/f+(t<n?6:0):i==t?(n-e)/f+2:(e-t)/f+4)/6;return[o,u,a]},hue2rgb:function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},convertHexColor:function(e){return e=String(e||""),e.charAt(0)=="#"&&(e=e.substring(1)),e.length==3&&(e=e.replace(/([0-9a-f])/ig,"$1$1")),e.length==6?[parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16)]:[0,0,0]},isPCVersion:function(){return $.browser.webkit&&typeof js365!="undefined"?!0:!1},disableSelectAndRightClick:function(){document.oncontextmenu=function(e){e.target.nodeName!="TEXTAREA"&&e.target.nodeName!="INPUT"&&(window.event.returnValue=!1)},document.ondragstart=function(){window.event.returnValue=!1},document.onselectstart=function(){window.event.returnValue=!1}},htmlDecode:function(e){var t="";return e.length==0?"":(t=e.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&nbsp;/g," "),t=t.replace(/&#39;/g,"'"),t=t.replace(/&quot;/g,'"'),t)},htmlEncode:function(e){var t="";return e.length==0?"":(t=e.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/ /g,"&nbsp;"),t=t.replace(/\'/g,"&#39;"),t=t.replace(/\"/g,"&quot;"),t)},relogin:function(){$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}})}};return window.openRegBindWin=r.openRegBindWin,amplify.subscribe("initApp",r.browserCheck),amplify.subscribe("loginTimeout",r.relogin),r}),define("rebuild/base/calendar_Protocol",["rebuild/base/common"],function(e){var t=window.d={},n={buildData:function(){t.firstDay=$.cookie("calendar_panel_first")||"",t.normalPanel=(G.currUser?$.cookie("normalPanel"+G.currUser.id):$.cookie("normalPanel"))||"month"},saveNormalPanel:function(){var e=arguments[0];t.normalPanel=e,G.currUser?$.cookie("normalPanel"+G.currUser.id,e,{expires:365,path:"/"}):$.cookie("normalPanel",e,{expires:365,path:"/"})},updateCalendarList:function(){var e=arguments[0];t.calendarList=e},updateCurrentList:function(){t.selectedCld=arguments[0]},updateScheduleData:function(){t.scheduleList=arguments[0].scheduleList,t.allSchedule=arguments[0].allSchedule,t.allScheduleById=arguments[0].allScheduleById,t.getedCalendars=arguments[0].getedCalendars},updateAllCalendarListData:function(){t.allCalendarList=arguments[0]},updateDateInfo:function(){t.dateInfo=arguments[0]},setCurrentCalendarPanel:function(){t.currentPanel=arguments[0]},updateDateRange:function(){var e=arguments[1].from,n=arguments[1].to;if(!t.dateRange){t.dateRange={from:e,to:n},t.currentDateRange={from:e,to:n};return}new Date(e.replace(/-/g,"/"))<new Date(t.dateRange.from.replace(/-/g,"/"))&&(t.dateRange.from=e),new Date(n.replace(/-/g,"/"))>new Date(t.dateRange.to.replace(/-/g,"/"))&&(t.dateRange.to=n)},updateTopicData:function(){t.topic=arguments[0]}},r={getNormalPanel:function(){return t.normalPanel},getCalendarList:function(){try{return t.calendarList}catch(e){return!1}},getCalendarListSelectedCld:function(){return t.calendarList.selectedCld==-1?t.calendarList.selectedClds:[t.calendarList.selectedCld]},getSelectedCalIds:function(){return t.calendarList.selectedClds},getRealCalendarList:function(){return t.calendarList.calendarList},getScheduleDataForListWidget:function(){var n=t.scheduleList,i=r.getCalendarListSelectedCld(),s=[],o,u,a,f=new Date;for(var l=0;l<7;l++){var h=new Date(f.getTime()+864e5*l);o=n[e.formatDate(h)];if(o&&i)for(var p=0,d=i.length;p<d;p++){a=i[p],u=o[a];if(u&&u.length>0)for(var v=0,m=u.length;v<m;v++)s.push(u[v])}}return s},getScheduleDataForCalendarWidget:function(){var n=new Date(t.currentDateRange.from.replace(/-/g,"/")),i=t.scheduleList,s=r.getCalendarListSelectedCld(),o=[],u,a,f;for(var l=0;l<42;l++){var h=new Date(n.getTime()+864e5*l);u=i[e.formatDate(h)];if(u&&s)for(var p=0,d=s.length;p<d;p++){f=s[p],a=u[f];if(a&&a.length>0)for(var v=0,m=a.length;v<m;v++)o.push(a[v])}}return o},getCurrentDateRange:function(){return t.currentDateRange},getInitedStatus:function(){return t.isInited?!0:(t.isInited=!0,!1)},getAllCalendarList:function(){return t.allCalendarList},getUsedColors:function(){try{return t.calendarList.usedColors}catch(e){return!1}},getCurrentPanel:function(){try{return t.currentPanel}catch(e){return!1}},getCalendarById:function(e){var n=t.calendarList.calendarList;for(var r=0,i=n.length;r<i;r++)if(n[r].id==e)return n[r];return null},getScheduleByPrimary:function(e){var n=t.allSchedule;return n[e]},getScheduleList:function(){return t.scheduleList||null},getAllSchedule:function(){return t.allSchedule||null},getAllScheduleById:function(){return t.allScheduleById||null},getScheduleById:function(e){return t.allScheduleById[e]||null},getPublic:function(e){var n=t.calendarList.calendarList;for(var r,i=0,s=n.length;i<s;i++){r=n[i];if(r.id==e)return r.is_public}return null},getAllCalendarNames:function(e){var n=[],r=t.calendarList.calendarList,i=t.calendarList.oPermissions;return r&&$.each(r,function(t,r){(!e||i[r.id]!=1)&&n.push({id:r.id,name:r.title})}),n},getDateRange:function(){return t.dateRange},getFirstDay:function(){return t.firstDay},isCalendarGeted:function(e){return t.getedCalendars[e]?!0:!1},getTopic:function(){return t.topic},getTopicByScheduleId:function(){var e=arguments[0];if(!t.topic)return null;for(var n=0;n<t.topic.length;n++)if(t.topic[n].scheduleId==e)return t.topic[n];return null},getTopicById:function(){var e=arguments[0];for(var n=0;n<t.topic.length;n++)if(t.topic[n].id==e)return t.topic[n];return null}};return amplify.subscribe("calendarListDataUpdated",n.updateCalendarList),amplify.subscribe("currentListChanged",n.updateCurrentList),amplify.subscribe("scheduleDataChanged",n.updateScheduleData),amplify.subscribe("calendarPanelChanged",n.setCurrentCalendarPanel),amplify.subscribe("dateUpdated",n.updateDateInfo),amplify.subscribe("initApp",n.buildData),amplify.subscribe("calendarPanelChanged",n.saveNormalPanel),amplify.subscribe("sceduleDataGeted",n.updateDateRange),amplify.subscribe("updateTopicData",n.updateTopicData),amplify.subscribe("allCalendarListUpdated",n.updateAllCalendarListData),r}),Calendar.prototype={getMonthFirstDate:function(){var e=new Date(+this.date);return e.setDate(1),e},getCalendarFirstDate:function(){var e=this.getMonthFirstDate(),t=e.getDay(),n=[-6,0,-1,-2,-3,-4,-5];return e.setDate(e.getDate()+n[t]),e},getCalendarSundayFirstDate:function(){var e=this.getMonthFirstDate(),t=e.getDay(),n=[0,-1,-2,-3,-4,-5,-6];return e.setDate(e.getDate()+n[t]),e},getCalendarMonthRowCount:function(){var e=new Date(+this.date);e.setDate(1);var t=[31,28,31,30,31,30,31,31,30,31,30,31],n=e.getFullYear(),r=e.getMonth(),i=e.getDay();return r!=1||i!=1||n%4==0&&n%100!=0||n%400==0?i==6&&t[r]==31||i==0&&t[r]>=30?6:5:4},getWeekFirstDate:function(){var e=new Date(+this.date),t=e.getDay(),n=[-6,0,-1,-2,-3,-4,-5];return e.setDate(e.getDate()+n[t]),e},getWeekSundayFirstDate:function(){var e=new Date(+this.date),t=e.getDay(),n=[0,-1,-2,-3,-4,-5,-6];return e.setDate(e.getDate()+n[t]),e}},function(){function e(e){var n=new Date(e);return+n<-0x94e9b950e00?null:new t(n)}function t(e){this.oDate=e,this.julianDay=h.fromDate(this.oDate),this.cnDay=this.oDate.getDay()?f.digitCN[this.oDate.getDay()]:"日";var t=this.mjd=this.julianDay-h.JD2000,n=this.terms=c.getTerms(t),r=this.newMoons=l.getNewMoons(n);for(var i=Math.round(t-r[0].JD),s=0,o;s<r.length;s++){o=r[s];if(i<o.days){this.isBigMonth=o.days==30,this.isLeap=o.isLeap,this.monthIndex=(o.index+10)%12,this.lMonth=o.name,this.lNextMonth=o.nextName,this.lDate=f.dateCn[i],this.dateIndex=i;break}i-=o.days}t=Math.round(t),this.lYear=Math.floor((n[3].JD+(t<n[3].JD?-365:0)+5844-35)/365.2422+.5);var u=r[r.zyIndex].JD;u-=t<u?365:0,u+=5810,this.sYear=Math.floor(u/365.2422+.5),this.hYear=this.sYear+1984+2698;var u=n.hash[t];this.term=u?u.name:"";var u=this.lYear+6e3;this.animal=f.chineseZodiac[u%12],this.gzYear=f.heavenlyStems[u%10]+f.earthlyBranches[u%12];var u=Math.floor((t-n[0].JD)/30.43685);u<12&&t>=n[2*u+1].JD&&u++,u+=Math.floor((n[12].JD+390)/365.2422)*12+9e5,this.gzMonth=f.heavenlyStems[u%10]+f.earthlyBranches[u%12];var u=t-6+9e6;this.gzDate=f.heavenlyStems[u%10]+f.earthlyBranches[u%12],this.gzChrono=f.earthlyBranches[Math.floor((this.oDate.getHours()+1)/2)]||"子"}function r(e){var t,r=348;for(t=32768;t>8;t>>=1)r+=n[e-1900]&t?1:0;return r+i(e)}function i(e){return s(e)?(n[e-1899]&15)==15?30:29:0}function s(e){var t=n[e-1900]&15;return t==15?0:t}function o(e,t){return n[e-1900]&65536>>t?30:29}function u(e,t,n,u){var a=0;for(var f=1900;f<e;f++)a+=r(f);for(var f=1;f<t;f++)f==s(e)&&(a+=i(e)),a+=o(e,f);u&&(a+=o(e,f)),a+=parseInt(n)-1;var l=new Date(1900,0,31),c=new Date(l.valueOf()+a*864e5);return c}function a(e){return f.chineseZodiac[Math.abs(e-1984)%12]}function b(e){var t=-0.043126+628.301955*e-2732e-9*e*e,n=.016708634-42037e-9*e-1.267e-7*e*e;return-20.49552*(1+n*Math.cos(t))/m}function w(e){return-0.0000034}function E(e){var t,n,r=e*e,i=0,s=y;for(t=0;t<s.length;t+=5)t==0?n=-1.742*e:n=0,i+=(s[t+3]+n)*Math.sin(s[t]+s[t+1]*e+s[t+2]*r);return i/100/m}function S(e){return T(e/365.2425+2e3)/86400}function x(e,t){var n=(e-1820)/100;return-20+t*n*n}function T(e){var t=g[g.length-2],n=g[g.length-1];if(e>=t){var r=31;if(e>t+100)return x(e,r);var i=x(e,r),s=x(t,r)-n;return i-s*(t+100-e)/100}var o,u=g;for(o=0;o<u.length;o+=5)if(e<u[o+5])break;var a=(e-u[o])/(u[o+5]-u[o])*10,f=a*a,l=f*a;return u[o+1]+u[o+2]*a+u[o+3]*f+u[o+4]*l}function N(e,t,n,r){n/=10;var i,s,o=0,u=1,a,f=d[e],l,c,h,v,g=t*6+1,y=f[g+1]-f[g];for(i=0;i<6;i++,u*=n){l=f[g+i],c=f[g+1+i],v=c-l;if(!v)continue;r<0?h=c:(h=Math.floor(3*r*v/y+.5)+l,i&&(h+=3),h>c&&(h=c));for(s=l,a=0;s<h;s+=3)a+=f[s]*Math.cos(f[s+1]+n*f[s+2]);o+=a*u}o/=f[0];if(e==0){var b=n*n,w=b*n;t==0&&(o+=(-0.0728-2.7702*n-1.1019*b-.0996*w)/m),t==1&&(o+=(0+4e-4*n+4e-4*b-.0026*w)/m),t==2&&(o+=(-0.002+.0044*n+.0213*b-.025*w)/1e6)}else{var E=p[(e-1)*3+t];t==0&&(o+=-3*n/m),t==2?o+=E/1e6:o+=E/m}return o}function C(e,t,n){var r=v[e],i,s,o,u,a=0,f=1,l,c=t*t,h=c*t,p=h*t,d=p*t,g=t-10;e==0&&(a+=(3.81034409+8399.684730072*t-3319e-8*c+3.11e-8*h-2.033e-10*p)*m,a+=5028.792262*t+1.1124406*c+7699e-8*h-23479e-9*p-1.78e-8*d,g>0&&(a+=-0.866+1.43*g+.054*g*g)),c/=1e4,h/=1e8,p/=1e8,n*=6,n<0&&(n=r[0].length);for(i=0;i<r.length;i++,f*=t){o=r[i],u=Math.floor(n*o.length/r[0].length+.5),i&&(u+=6),u>=o.length&&(u=o.length);for(s=0,l=0;s<u;s+=6)l+=o[s]*Math.cos(o[s+1]+t*o[s+2]+c*o[s+3]+h*o[s+4]+p*o[s+5]);a+=l*f}return e!=2&&(a/=m),a}function L(e){var t="0000000000",n=t+t,r={J:"00",I:"000",H:"0000",G:"00000",t:"01",s:"001",r:"0001",q:"00001",p:"000001",o:"0000001",n:"00000001",m:"000000001",l:"0000000001",k:"03",j:"0303",i:"003",h:"003003",g:"0003",f:"00003",e:"000003",d:"0000003",c:"00000003",b:"000000003",a:"0000000003",A:n+n+n,B:n+n+t,C:n+n,D:n+t,E:n,F:t};return e.replace(/\D/g,function(e){return r[e]})}var n=new Array(19416,19168,42352,21717,53856,55632,21844,22191,39632,21970,19168,42422,42192,53840,53909,46415,54944,44450,38320,18807,18815,42160,46261,27216,27968,43860,11119,38256,21234,18800,25958,54432,59984,27285,23263,11104,34531,37615,51415,51551,54432,55462,46431,22176,42420,9695,37584,53938,43344,46423,27808,46416,21333,19887,42416,17779,21183,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,38310,38335,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,20854,21183,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,53430,53855,54560,56645,46496,22224,21938,18864,42359,42160,43600,45653,27951,44448,19299,37759,18936,18800,25776,26790,59999,27424,42692,43759,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,19285,19311,42352,21732,53856,59752,54560,55968,27302,22239,19168,43476,42192,53584,62034,54560),f=t.DB={digitCN:["零","一","二","三","四","五","六","七","八","九","十"],heavenlyStems:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],earthlyBranches:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],chineseZodiac:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],term:["冬至","小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪"],monthCn:["十一","十二","正","二","三","四","五","六","七","八","九","十"],dateCn:["初一","初二","初三","初四","初五","初六","初七","初八","初九","初十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十","廿一","廿二","廿三","廿四","廿五","廿六","廿七","廿八","廿九","三十","卅一"]},l={correction:L("EqoFscDcrFpmEsF1DfFideFelFpFfFfFiaipqti3ksttikptikqckstekqttgkqttgkqteksttikptikq1fjstgjqttjkqttgkqtekstfkptikq1tijstgjiFkirFsAeACoFsiDaDiADc3AFbBfgdfikijFifegF3FhaikgFag3E1btaieeibggiffdeigFfqDfaiBkF3kEaikhkigeidhhdiegcFfakF3ggkidbiaedksaFffckekidhhdhdikcikiakicjF3deedFhFccgicdekgiFbiaikcfi3kbFibefgEgFdcFkFeFkdcfkF3kfkcickEiFkDacFiEfbiaejcFfffkhkdgkaiei3ehigikhdFikfckF3dhhdikcfgjikhfjicjicgiehdikcikggcifgiejF3jkieFhegikggcikFegiegkfjebhigikggcikdgkaFkijcfkcikfkcifikiggkaeeigefkcdfcfkhkdgkegieidhijcFfakhfgeidieidiegikhfkfckfcjbdehdikggikgkfkicjicjF3dbidikFiggcifgiejkiegkigcdiegfggcikdbgfgefjF3kfegikggcikdgFkeeijcfkcikfkekcikdgkabhkFikaffcfkhkdgkegbiaekfkiakicjhfgqdq1fkiakgkfkhfkfcjiekgFebicggbedF3jikejbbbiakgbgkacgiejkijjgigfiakggfggcibFifjefjF3kfekdgjcibFeFkijcfkfhkfkeaieigekgbhkfikidfcjeaibgekgdkiffiffkiakF3jhbakgdki3dj3ikfkicjicjieeFkgdkicggkighdF3jfgkgfgbdkicggfggkidFkiekgijkeigfiskiggfaidheigF3jekijcikickiggkidhhdbgcfkFikikhkigeidieFikggikhkffaffijhidhhakgdkhkijF3kiakF3kfheakgdkifiggkigicjiejkieedikgdfcggkigieeiejfgkgkigbgikicggkiaideeijkefjeijikhkiggkiaidheigcikaikffikijgkiahi3hhdikgjfifaakekighie3hiaikggikhkffakicjhiahaikggikhkijF3kfejfeFhidikggiffiggkigicjiekgieeigikggiffiggkidheigkgfjkeigiegikifiggkidhedeijcfkFikikhkiggkidhh3ehigcikaffkhkiggkidhh3hhigikekfiFkFikcidhh3hitcikggikhkfkicjicghiediaikggikhkijbjfejfeFhaikggifikiggkigiejkikgkgieeigikggiffiggkigieeigekijcijikggifikiggkideedeijkefkfckikhkiggkidhh3ehijcikaffkhkiggkidhh3hhigikhkikFikfckcidhh3hiaikgjikhfjicjicgiehdikcikggifikigiejfejkieFhegikggifikiggfghigkfjeijkhigikggifikiggkigieeijcijcikfksikifikiggkidehdeijcfdckikhkiggkhghh3ehijikifffffkhsFngErD3pAfBoDd3BlEtFqA1AqoEpDqElAEsEeB1BmADlDkqBtC3FnEpDqnEmFsFsAFnllBbFmDsDiCtDmAB1BmtCgpEplCpAEiBiEoFqFtEqsDcCnFtADnFlEgdkEgmEtEsCtDmADqFtAFrAtEcCqAE3BoFqC3F3DrFtBmFtAC1ACnFaoCgADcADcCcFfoFtDlAFgmFqBq1bpEoAEmkqnEeCtAE3bAEqgDfFfCrgEcBrACfAAABqAAB3AAClEnFeCtCgAADqDoBmtAAACbFiAAADsEtBqAB1FsDqpFqEmFsCeDtFlCeDtoEpClEqAAFrAFoCgFmFsFqEnAEcCqFeCtFtEnAEeFtAAEkFnErAABbFkADnAAeCtFeAfBoAEpFtAABtFqAApDcCGJ"),calcForLow:function(e){var t=7771.37714500204,n=(e+1.08472)/t,r;return n-=(-0.0000331*n*n+.10976*Math.cos(.785+8328.6914*n)+.02224*Math.cos(.187+7214.0629*n)-.03342*Math.cos(4.669+628.3076*n))/t+(32*(n+1.8)*(n+1.8)-20)/86400/36525,n*36525+8/24},calcForHigh:function(e){var t=k.MS_aLon_t2(e)*36525;t=t-S(t)+8/24;var n=(t+.5)%1*86400;if(n<1800||n>84600)t=k.MS_aLon_t(e)*36525-S(t)+8/24;return t},cache:{},getNewMoons:function(e){var t=e[0].JD,n=l.calc(t),r=[];n>t&&(n-=29.53);if(l.cache[n])r=l.cache[n];else{for(var i=0;i<16;i++)r.push({JD:l.calc(n+29.5306*i),index:i}),i&&(r[i-1].days=r[i].JD-r[i-1].JD);if(r[13].JD<=e[24].JD){for(i=1;r[i+1].JD>e[2*i].JD&&i<13;i++);r[i].isLeap=!0,r.leapIndex=i;for(;i<16;i++)r[i].index--}for(i=0;i<16;i++)r[i].name=(r[i].isLeap?"闰":"")+f.monthCn[r[i].index%12],r[i+1]&&(r[i].nextName=(r[i+1].isLeap?"闰":"")+f.monthCn[r[i+1].index%12]),r.zyIndex==undefined&&r[i].index==2&&(r.zyIndex=i);l.cache[n]=r}return r},calc:function(e){e+=h.JD2000;var t,n,r=14,i=1947168,s=2436935;if(e>=s)return Math.floor(this.calcForHigh(Math.floor((e+r-2451551)/29.5306)*Math.PI*2)+.5);if(e>=i&&e<s)return t=Math.floor(this.calcForLow(Math.floor((e+r-2451551)/29.5306)*Math.PI*2)+.5),n=this.correction.substr(Math.floor((e-i)/29.5306),1)-0,t+(n?n-2:n)}},c={correction:L("FrcFs11AFsckF1tsDtFqEtF3posFdFgiFseFtmelpsEfhkF1anmelpFlF3ikrotcnEqEq1FfqmcDsrFor11FgFrcgDscFs11FgEeFtE1sfFs11sCoEsaF1tsD3FpeE1eFsssEciFsFnmelpFcFhkF1tcnEqEpFgkrotcnEqrEtFermcDsrE111FgBmcmr11DaEfnaF111sD3FpeForeF1tssEfiFpEoeFssD3iFstEqFppDgFstcnEqEpFg33FscnEqrAoAF1ClAEsDmDtCtBaDlAFbAEpAAAAAD1FgBiBqoBbnBaBoAAAAAAAEgDqAdBqAFrBaBoACdAAf3AACgAAAeBbCamDgEifAE1AABa3C3BgFdiAAACoCeE3ADiEifDaAEqAAFe3AcFbcAAAAAF3iFaAAACpACmFmAAAAAAAACrDaAAADG0"),calcForLow:function(e){var t,n,r=628.3319653318;return t=(e-4.895062166)/r,t-=(53*t*t+334116*Math.cos(4.67+628.307585*t)+2061*Math.cos(2.678+628.3076*t)*t)/r/1e7,n=48950621.66+6283319653.318*t+53*t*t+334166*Math.cos(4.669257+628.307585*t)+3489*Math.cos(4.6261+1256.61517*t)+2060.6*Math.cos(2.67823+628.307585*t)*t-994-834*Math.sin(2.1824-33.75705*t),t-=(n/1e7-e)/628.332+(32*(t+1.8)*(t+1.8)-20)/86400/36525,t*36525+8/24},getNearestWinter:function(e){var t=Math.floor((e-355+183)/365.2422)*365.2422+355;return c.calc(t)>e&&(t-=365.2422),t},cache:{},getTerms:function(e){var t=c.getNearestWinter(e),n=[];if(c.cache[t])n=c.cache[t];else{n.hash={};for(var r=0,i;r<25;r++)i={JD:c.calc(t+15.2184*r),name:f.term[r%24]},n.push(i),n.hash[i.JD]=i;c.cache[t]=n}return n},calcForHigh:function(e){var t=k.S_aLon_t2(e)*36525;t=t-S(t)+8/24;var n=(t+.5)%1*86400;if(n<1200||n>85200)t=k.S_aLon_t(e)*36525-S(t)+8/24;return t},calc:function(e){e+=h.JD2000;var t,n,r,i=7,s=2322147.76,o=2436935;if(e>=o)return Math.floor(this.calcForHigh(Math.floor((e+i-2451259)/365.2422*24)*Math.PI/12)+.5);if(e>=s&&e<o)return n=Math.floor(this.calcForLow(Math.floor((e+i-2451259)/365.2422*24)*Math.PI/12)+.5),r=this.correction.substr(Math.floor((e-s)/365.2422*24),1)-0,n+(r?r-2:r)}},h={JD2000:2451545,fromDate:function(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate()+((e.getSeconds()/60+e.getMinutes())/60+e.getHours())/24,i=t*372+n*31+Math.floor(r)>=588829,s=0;return n<=2&&(n+=12,t-=1),i&&(s=Math.floor(t/100),s=2-s+Math.floor(s/4)),Math.floor(365.25*(t+4716))+Math.floor(30.6001*(n+1))+r+s-1524.5}},p=[-0.08631,39e-5,-0.00008,-0.07447,6e-5,17e-5,-0.07135,-0.00026,-0.00176,-0.20239,.00273,-0.00347,-0.25486,.00276,.42926,.24588,.00345,-14.46266,-0.95116,.02481,58.30651],d=new Array(new Array(1e10,20,578,920,1100,1124,1136,1148,1217,1226,1229,1229,1229,1229,1937,2363,2618,2633,2660,2666,17534704567,0,0,334165646,4.669256804,6283.075849991,3489428,4.6261024,12566.1517,349706,2.744118,5753.384885,341757,2.828866,3.523118,313590,3.62767,77713.771468,267622,4.418084,7860.419392,234269,6.135162,3930.209696,132429,.742464,11506.76977,127317,2.037097,529.690965,119917,1.109629,1577.343542,99025,5.23268,5884.92685,90186,2.04505,26.29832,85722,3.50849,398.149,77979,1.17883,5223.69392,75314,2.53339,5507.55324,50526,4.58293,18849.22755,49238,4.20507,775.52261,35666,2.91954,.06731,31709,5.84902,11790.62909,28413,1.89869,796.29801,27104,.31489,10977.0788,24281,.34481,5486.77784,20616,4.80647,2544.31442,20539,1.86948,5573.1428,20226,2.45768,6069.77675,15552,.83306,213.2991,13221,3.41118,2942.46342,12618,1.08303,20.7754,11513,.64545,.98032,10285,.636,4694.00295,10190,.97569,15720.83878,10172,4.2668,7.11355,9921,6.2099,2146.1654,9761,.681,155.4204,8580,5.9832,161000.6857,8513,1.2987,6275.9623,8471,3.6708,71430.6956,7964,1.8079,17260.1547,7876,3.037,12036.4607,7465,1.7551,5088.6288,7387,3.5032,3154.6871,7355,4.6793,801.8209,6963,.833,9437.7629,6245,3.9776,8827.3903,6115,1.8184,7084.8968,5696,2.7843,6286.599,5612,4.3869,14143.4952,5558,3.4701,6279.5527,5199,.1891,12139.5535,5161,1.3328,1748.0164,5115,.2831,5856.4777,4900,.4874,1194.447,4104,5.3682,8429.2413,4094,2.3985,19651.0485,3920,6.1683,10447.3878,3677,6.0413,10213.2855,3660,2.5696,1059.3819,3595,1.7088,2352.8662,3557,1.776,6812.7668,3329,.5931,17789.8456,3041,.4429,83996.8473,3005,2.7398,1349.8674,2535,3.1647,4690.4798,2474,.2148,3.5904,2366,.4847,8031.0923,2357,2.0653,3340.6124,2282,5.222,4705.7323,2189,5.5559,553.5694,2142,1.4256,16730.4637,2109,4.1483,951.7184,2030,.3713,283.8593,1992,5.2221,12168.0027,1986,5.7747,6309.3742,1912,3.8222,23581.2582,1889,5.3863,149854.4001,1790,2.2149,13367.9726,1748,4.5605,135.0651,1622,5.9884,11769.8537,1508,4.1957,6256.7775,1442,4.1932,242.7286,1435,3.7236,38.0277,1397,4.4014,6681.2249,1362,1.8893,7632.9433,1250,1.1305,5.5229,1205,2.6223,955.5997,1200,1.0035,632.7837,1129,.1774,4164.312,1083,.3273,103.0928,1052,.9387,11926.2544,1050,5.3591,1592.596,1033,6.1998,6438.4962,1001,6.0291,5746.2713,980,.999,11371.705,980,5.244,27511.468,938,2.624,5760.498,923,.483,522.577,922,4.571,4292.331,905,5.337,6386.169,862,4.165,7058.598,841,3.299,7234.794,836,4.539,25132.303,813,6.112,4732.031,812,6.271,426.598,801,5.821,28.449,787,.996,5643.179,776,2.957,23013.54,769,3.121,7238.676,758,3.974,11499.656,735,4.386,316.392,731,.607,11513.883,719,3.998,74.782,706,.323,263.084,676,5.911,90955.552,663,3.665,17298.182,653,5.791,18073.705,630,4.717,6836.645,615,1.458,233141.314,612,1.075,19804.827,596,3.321,6283.009,596,2.876,6283.143,555,2.452,12352.853,541,5.392,419.485,531,.382,31441.678,519,4.065,6208.294,513,2.361,10973.556,494,5.737,9917.697,450,3.272,11015.106,449,3.653,206.186,447,2.064,7079.374,435,4.423,5216.58,421,1.906,245.832,413,.921,3738.761,402,.84,20.355,387,1.826,11856.219,379,2.344,3.881,374,2.954,3128.389,370,5.031,536.805,365,1.018,16200.773,365,1.083,88860.057,352,5.978,3894.182,352,2.056,244287.6,351,3.713,6290.189,340,1.106,14712.317,339,.978,8635.942,339,3.202,5120.601,333,.837,6496.375,325,3.479,6133.513,316,5.089,21228.392,316,1.328,10873.986,309,3.646,10.637,303,1.802,35371.887,296,3.397,9225.539,288,6.026,154717.61,281,2.585,14314.168,262,3.856,266.607,262,2.579,22483.849,257,1.561,23543.231,255,3.949,1990.745,251,3.744,10575.407,240,1.161,10984.192,238,.106,7.046,236,4.272,6040.347,234,3.577,10969.965,211,3.714,65147.62,210,.754,13521.751,207,4.228,5650.292,202,.814,170.673,201,4.629,6037.244,200,.381,6172.87,199,3.933,6206.81,199,5.197,6262.3,197,1.046,18209.33,195,1.07,5230.807,195,4.869,36.028,194,4.313,6244.943,192,1.229,709.933,192,5.595,6282.096,192,.602,6284.056,189,3.744,23.878,188,1.904,15.252,188,.867,22003.915,182,3.681,15110.466,181,.491,1.484,179,3.222,39302.097,179,1.259,12559.038,62833196674749,0,0,20605886,2.67823456,6283.07584999,430343,2.635127,12566.1517,42526,1.59047,3.52312,11926,5.79557,26.29832,10898,2.96618,1577.34354,9348,2.5921,18849.2275,7212,1.1385,529.691,6777,1.8747,398.149,6733,4.4092,5507.5532,5903,2.888,5223.6939,5598,2.1747,155.4204,4541,.398,796.298,3637,.4662,775.5226,2896,2.6471,7.1135,2084,5.3414,.9803,1910,1.8463,5486.7778,1851,4.9686,213.2991,1729,2.9912,6275.9623,1623,.0322,2544.3144,1583,1.4305,2146.1654,1462,1.2053,10977.0788,1246,2.8343,1748.0164,1188,3.258,5088.6288,1181,5.2738,1194.447,1151,2.075,4694.003,1064,.7661,553.5694,997,1.303,6286.599,972,4.239,1349.867,945,2.7,242.729,858,5.645,951.718,758,5.301,2352.866,639,2.65,9437.763,610,4.666,4690.48,583,1.766,1059.382,531,.909,3154.687,522,5.661,71430.696,520,1.854,801.821,504,1.425,6438.496,433,.241,6812.767,426,.774,10447.388,413,5.24,7084.897,374,2.001,8031.092,356,2.429,14143.495,350,4.8,6279.553,337,.888,12036.461,337,3.862,1592.596,325,3.4,7632.943,322,.616,8429.241,318,3.188,4705.732,297,6.07,4292.331,295,1.431,5746.271,290,2.325,20.355,275,.935,5760.498,270,4.804,7234.794,253,6.223,6836.645,228,5.003,17789.846,225,5.672,11499.656,215,5.202,11513.883,208,3.955,10213.286,208,2.268,522.577,206,2.224,5856.478,206,2.55,25132.303,203,.91,6256.778,189,.532,3340.612,188,4.735,83996.847,179,1.474,4164.312,178,3.025,5.523,177,3.026,5753.385,159,4.637,3.286,157,6.124,5216.58,155,3.077,6681.225,154,4.2,13367.973,143,1.191,3894.182,138,3.093,135.065,136,4.245,426.598,134,5.765,6040.347,128,3.085,5643.179,127,2.092,6290.189,125,3.077,11926.254,125,3.445,536.805,114,3.244,12168.003,112,2.318,16730.464,111,3.901,11506.77,111,5.32,23.878,105,3.75,7860.419,103,2.447,1990.745,96,.82,3.88,96,4.08,6127.66,91,5.42,206.19,91,.42,7079.37,88,5.17,11790.63,81,.34,9917.7,80,3.89,10973.56,78,2.4,1589.07,78,2.58,11371.7,77,3.98,955.6,77,3.36,36.03,76,1.3,103.09,75,5.18,10969.97,75,4.96,6496.37,73,5.21,38.03,72,2.65,6309.37,70,5.61,3738.76,69,2.6,3496.03,69,.39,15.25,69,2.78,20.78,65,1.13,7058.6,64,4.28,28.45,61,5.63,10984.19,60,.73,419.48,60,5.28,10575.41,58,5.55,17298.18,58,3.19,4732.03,5291887,0,0,871984,1.072097,6283.07585,30913,.86729,12566.1517,2734,.053,3.5231,1633,5.1883,26.2983,1575,3.6846,155.4204,954,.757,18849.228,894,2.057,77713.771,695,.827,775.523,506,4.663,1577.344,406,1.031,7.114,381,3.441,5573.143,346,5.141,796.298,317,6.053,5507.553,302,1.192,242.729,289,6.117,529.691,271,.306,398.149,254,2.28,553.569,237,4.381,5223.694,208,3.754,.98,168,.902,951.718,153,5.759,1349.867,145,4.364,1748.016,134,3.721,1194.447,125,2.948,6438.496,122,2.973,2146.165,110,1.271,161000.686,104,.604,3154.687,100,5.986,6286.599,92,4.8,5088.63,89,5.23,7084.9,83,3.31,213.3,76,3.42,5486.78,71,6.19,4690.48,68,3.43,4694,65,1.6,2544.31,64,1.98,801.82,61,2.48,10977.08,50,1.44,6836.65,49,2.34,1592.6,46,1.31,4292.33,46,3.81,149854.4,43,.04,7234.79,40,4.94,7632.94,39,1.57,71430.7,38,3.17,6309.37,35,.99,6040.35,35,.67,1059.38,31,3.18,2352.87,31,3.55,8031.09,30,1.92,10447.39,30,2.52,6127.66,28,4.42,9437.76,28,2.71,3894.18,27,.67,25132.3,26,5.27,6812.77,25,.55,6279.55,23,1.38,4705.73,22,.64,6256.78,20,6.07,640.88,28923,5.84384,6283.07585,3496,0,0,1682,5.4877,12566.1517,296,5.196,155.42,129,4.722,3.523,71,5.3,18849.23,64,5.97,242.73,40,3.79,553.57,11408,3.14159,0,772,4.134,6283.076,77,3.84,12566.15,42,.42,155.42,88,3.14,0,17,2.77,6283.08,5,2.01,155.42,3,2.21,12566.15,27962,3.1987,84334.66158,10164,5.42249,5507.55324,8045,3.8801,5223.6939,4381,3.7044,2352.8662,3193,4.0003,1577.3435,2272,3.9847,1047.7473,1814,4.9837,6283.0758,1639,3.5646,5856.4777,1444,3.7028,9437.7629,1430,3.4112,10213.2855,1125,4.8282,14143.4952,1090,2.0857,6812.7668,1037,4.0566,71092.8814,971,3.473,4694.003,915,1.142,6620.89,878,4.44,5753.385,837,4.993,7084.897,770,5.554,167621.576,719,3.602,529.691,692,4.326,6275.962,558,4.41,7860.419,529,2.484,4705.732,521,6.25,18073.705,903,3.897,5507.553,618,1.73,5223.694,380,5.244,2352.866,166,1.627,84334.662,10001398880,0,0,167069963,3.098463508,6283.075849991,1395602,3.0552461,12566.1517,308372,5.198467,77713.771468,162846,1.173877,5753.384885,157557,2.846852,7860.419392,92480,5.45292,11506.76977,54244,4.56409,3930.2097,47211,3.661,5884.92685,34598,.96369,5507.55324,32878,5.89984,5223.69392,30678,.29867,5573.1428,24319,4.2735,11790.62909,21183,5.84715,1577.34354,18575,5.02194,10977.0788,17484,3.01194,18849.22755,10984,5.05511,5486.77784,9832,.8868,6069.7768,8650,5.6896,15720.8388,8583,1.2708,161000.6857,6490,.2725,17260.1547,6292,.9218,529.691,5706,2.0137,83996.8473,5574,5.2416,71430.6956,4938,3.245,2544.3144,4696,2.5781,775.5226,4466,5.5372,9437.7629,4252,6.0111,6275.9623,3897,5.3607,4694.003,3825,2.3926,8827.3903,3749,.8295,19651.0485,3696,4.9011,12139.5535,3566,1.6747,12036.4607,3454,1.8427,2942.4634,3319,.2437,7084.8968,3192,.1837,5088.6288,3185,1.7778,398.149,2846,1.2134,6286.599,2779,1.8993,6279.5527,2628,4.589,10447.3878,2460,3.7866,8429.2413,2393,4.996,5856.4777,2359,.2687,796.298,2329,2.8078,14143.4952,2210,1.95,3154.6871,2035,4.6527,2146.1654,1951,5.3823,2352.8662,1883,.6731,149854.4001,1833,2.2535,23581.2582,1796,.1987,6812.7668,1731,6.152,16730.4637,1717,4.4332,10213.2855,1619,5.2316,17789.8456,1381,5.1896,8031.0923,1364,3.6852,4705.7323,1314,.6529,13367.9726,1041,4.3329,11769.8537,1017,1.5939,4690.4798,998,4.201,6309.374,966,3.676,27511.468,874,6.064,1748.016,779,3.674,12168.003,771,.312,7632.943,756,2.626,6256.778,746,5.648,11926.254,693,2.924,6681.225,680,1.423,23013.54,674,.563,3340.612,663,5.661,11371.705,659,3.136,801.821,648,2.65,19804.827,615,3.029,233141.314,612,5.134,1194.447,563,4.341,90955.552,552,2.091,17298.182,534,5.1,31441.678,531,2.407,11499.656,523,4.624,6438.496,513,5.324,11513.883,477,.256,11856.219,461,1.722,7234.794,458,3.766,6386.169,458,4.466,5746.271,423,1.055,5760.498,422,1.557,7238.676,415,2.599,7058.598,401,3.03,1059.382,397,1.201,1349.867,379,4.907,4164.312,360,5.707,5643.179,352,3.626,244287.6,348,.761,10973.556,342,3.001,4292.331,336,4.546,4732.031,334,3.138,6836.645,324,4.164,9917.697,316,1.691,11015.106,307,.238,35371.887,298,1.306,6283.143,298,1.75,6283.009,293,5.738,16200.773,286,5.928,14712.317,281,3.515,21228.392,280,5.663,8635.942,277,.513,26.298,268,4.207,18073.705,266,.9,12352.853,260,2.962,25132.303,255,2.477,6208.294,242,2.8,709.933,231,1.054,22483.849,229,1.07,14314.168,216,1.314,154717.61,215,6.038,10873.986,200,.561,7079.374,198,2.614,951.718,197,4.369,167283.762,186,2.861,5216.58,183,1.66,39302.097,183,5.912,3738.761,175,2.145,6290.189,173,2.168,10575.407,171,3.702,1592.596,171,1.343,3128.389,164,5.55,6496.375,164,5.856,10984.192,161,1.998,10969.965,161,1.909,6133.513,157,4.955,25158.602,154,6.216,23543.231,153,5.357,13521.751,150,5.77,18209.33,150,5.439,155.42,139,1.778,9225.539,139,1.626,5120.601,128,2.46,13916.019,123,.717,143571.324,122,2.654,88860.057,121,4.414,3894.182,121,1.192,3.523,120,4.03,553.569,119,1.513,17654.781,117,3.117,14945.316,113,2.698,6040.347,110,3.085,43232.307,109,.998,955.6,108,2.939,17256.632,107,5.285,65147.62,103,.139,11712.955,103,5.85,213.299,102,3.046,6037.244,101,2.842,8662.24,100,3.626,6262.3,98,2.36,6206.81,98,5.11,6172.87,98,2,15110.47,97,2.67,5650.29,97,2.75,6244.94,96,4.02,6282.1,96,5.31,6284.06,92,.1,29088.81,85,3.26,20426.57,84,2.6,28766.92,81,3.58,10177.26,80,5.81,5230.81,78,2.53,16496.36,77,4.06,6127.66,73,.04,5481.25,72,5.96,12559.04,72,5.92,4136.91,71,5.49,22003.91,70,3.41,7.11,69,.62,11403.68,69,3.9,1589.07,69,1.96,12416.59,69,4.51,426.6,67,1.61,11087.29,66,4.5,47162.52,66,5.08,283.86,66,4.32,16858.48,65,1.04,6062.66,64,1.59,18319.54,63,5.7,45892.73,63,4.6,66567.49,63,3.82,13517.87,62,2.62,11190.38,61,1.54,33019.02,60,5.58,10344.3,60,5.38,316428.23,60,5.78,632.78,59,6.12,9623.69,57,.16,17267.27,57,3.86,6076.89,57,1.98,7668.64,56,4.78,20199.09,55,4.56,18875.53,55,3.51,17253.04,54,3.07,226858.24,54,4.83,18422.63,53,5.02,12132.44,52,3.63,5333.9,52,.97,155427.54,51,3.36,20597.24,50,.99,11609.86,50,2.21,1990.75,48,1.62,12146.67,48,1.17,12569.67,47,4.62,5436.99,47,1.81,12562.63,47,.59,21954.16,47,.76,7342.46,46,.27,4590.91,46,3.77,156137.48,45,5.66,10454.5,44,5.84,3496.03,43,.24,17996.03,41,5.93,51092.73,41,4.21,12592.45,40,5.14,1551.05,40,5.28,15671.08,39,3.69,18052.93,39,4.94,24356.78,38,2.72,11933.37,38,5.23,7477.52,38,4.99,9779.11,37,3.7,9388.01,37,4.44,4535.06,36,2.16,28237.23,36,2.54,242.73,36,.22,5429.88,35,6.15,19800.95,35,2.92,36949.23,34,5.63,2379.16,34,5.73,16460.33,34,5.11,5849.36,33,6.19,6268.85,10301861,1.1074897,6283.07584999,172124,1.064423,12566.1517,70222,3.14159,0,3235,1.0217,18849.2275,3080,2.8435,5507.5532,2497,1.3191,5223.6939,1849,1.4243,1577.3435,1008,5.9138,10977.0788,865,1.42,6275.962,863,.271,5486.778,507,1.686,5088.629,499,6.014,6286.599,467,5.987,529.691,440,.518,4694.003,410,1.084,9437.763,387,4.75,2544.314,375,5.071,796.298,352,.023,83996.847,344,.949,71430.696,341,5.412,775.523,322,6.156,2146.165,286,5.484,10447.388,284,3.42,2352.866,255,6.132,6438.496,252,.243,398.149,243,3.092,4690.48,225,3.689,7084.897,220,4.952,6812.767,219,.42,8031.092,209,1.282,1748.016,193,5.314,8429.241,185,1.82,7632.943,175,3.229,6279.553,173,1.537,4705.732,158,4.097,11499.656,158,5.539,3154.687,150,3.633,11513.883,148,3.222,7234.794,147,3.653,1194.447,144,.817,14143.495,135,6.151,5746.271,134,4.644,6836.645,128,2.693,1349.867,123,5.65,5760.498,118,2.577,13367.973,113,3.357,17789.846,110,4.497,4292.331,108,5.828,12036.461,102,5.621,6256.778,99,1.14,1059.38,98,.66,5856.48,93,2.32,10213.29,92,.77,16730.46,88,1.5,11926.25,86,1.42,5753.38,85,.66,155.42,81,1.64,6681.22,80,4.11,951.72,66,4.55,5216.58,65,.98,25132.3,64,4.19,6040.35,64,.52,6290.19,63,1.51,5643.18,59,6.18,4164.31,57,2.3,10973.56,55,2.32,11506.77,55,2.2,1592.6,55,5.27,3340.61,54,5.54,553.57,53,5.04,9917.7,53,.92,11371.7,52,3.98,17298.18,52,3.6,10969.97,49,5.91,3894.18,49,2.51,6127.66,48,1.67,12168,46,.31,801.82,42,3.7,10575.41,42,4.05,10984.19,40,2.17,7860.42,40,4.17,26.3,38,5.82,7058.6,37,3.39,6496.37,36,1.08,6309.37,36,5.34,7079.37,34,3.62,11790.63,32,.32,16200.77,31,4.24,3738.76,29,4.55,11856.22,29,1.26,8635.94,27,3.45,5884.93,26,5.08,10177.26,26,5.38,21228.39,24,2.26,11712.96,24,1.05,242.73,24,5.59,6069.78,23,3.63,6284.06,23,1.64,4732.03,22,3.46,213.3,21,1.05,3496.03,21,3.92,13916.02,21,4.01,5230.81,20,5.16,12352.85,20,.69,1990.75,19,2.73,6062.66,19,5.01,11015.11,18,6.04,6283.01,18,2.85,7238.68,18,5.6,6283.14,18,5.16,17253.04,18,2.54,14314.17,17,1.58,7.11,17,.98,3930.21,17,4.75,17267.27,16,2.19,6076.89,16,2.19,18073.7,16,6.12,3.52,16,4.61,9623.69,16,3.4,16496.36,15,.19,9779.11,15,5.3,13517.87,15,4.26,3128.39,15,.81,709.93,14,.5,25158.6,14,4.38,4136.91,13,.98,65147.62,13,3.31,154717.61,13,2.11,1589.07,13,1.92,22483.85,12,6.03,9225.54,12,1.53,12559.04,12,5.82,6282.1,12,5.61,5642.2,12,2.38,167283.76,12,.39,12132.44,12,3.98,4686.89,12,5.81,12569.67,12,.56,5849.36,11,.45,6172.87,11,5.8,16858.48,11,6.22,12146.67,11,2.27,5429.88,435939,5.784551,6283.07585,12363,5.57935,12566.1517,1234,3.1416,0,879,3.628,77713.771,569,1.87,5573.143,330,5.47,18849.228,147,4.48,5507.553,110,2.842,161000.686,101,2.815,5223.694,85,3.11,1577.34,65,5.47,775.52,61,1.38,6438.5,50,4.42,6286.6,47,3.66,7084.9,46,5.39,149854.4,42,.9,10977.08,40,3.2,5088.63,35,1.81,5486.78,32,5.35,3154.69,30,3.52,796.3,29,4.62,4690.48,28,1.84,4694,27,3.14,71430.7,27,6.17,6836.65,26,1.42,2146.17,25,2.81,1748.02,24,2.18,155.42,23,4.76,7234.79,21,3.38,7632.94,21,.22,4705.73,20,4.22,1349.87,20,2.01,1194.45,20,4.58,529.69,19,1.59,6309.37,18,5.7,6040.35,18,6.03,4292.33,17,2.9,9437.76,17,2,8031.09,17,5.78,83996.85,16,.05,2544.31,15,.95,6127.66,14,.36,10447.39,14,1.48,2352.87,13,.77,553.57,13,5.48,951.72,13,5.27,6279.55,13,3.76,6812.77,11,5.41,6256.78,10,.68,1592.6,10,4.95,398.15,10,1.15,3894.18,10,5.2,244287.6,10,1.94,11856.22,9,5.39,25132.3,8,6.18,1059.38,8,.69,8429.24,8,5.85,242.73,7,5.26,14143.5,7,.52,801.82,6,2.24,8635.94,6,4,13367.97,6,2.77,90955.55,6,5.17,7058.6,5,1.46,233141.31,5,4.13,7860.42,5,3.91,26.3,5,3.89,12036.46,5,5.58,6290.19,5,5.54,1990.75,5,.83,11506.77,5,6.22,6681.22,4,5.26,10575.41,4,1.91,7477.52,4,.43,10213.29,4,1.09,709.93,4,5.09,11015.11,4,4.22,88860.06,4,3.57,7079.37,4,1.98,6284.06,4,3.93,10973.56,4,6.18,9917.7,4,.36,10177.26,4,2.75,3738.76,4,3.33,5643.18,4,5.36,25158.6,14459,4.27319,6283.07585,673,3.917,12566.152,77,0,0,25,3.73,18849.23,4,2.8,6286.6,386,2.564,6283.076,31,2.27,12566.15,5,3.44,5573.14,2,2.05,18849.23,1,2.06,77713.77,1,4.41,161000.69,1,3.82,149854.4,1,4.08,6127.66,1,5.26,6438.5,9,1.22,6283.08,1,.66,12566.15)),v=[[[22639.586,.78475822,8328.691424623,1.5229241,25.0719,-0.123598,4586.438,.1873974,7214.06286536,-2.184756,-18.86,.0828,2369.914,2.542952,15542.75428998,-0.661832,6.212,-0.0408,769.026,3.140313,16657.38284925,3.04585,50.144,-0.2472,666.418,1.527671,628.30195521,-0.02664,.062,-0.0054,411.596,4.826607,16866.932315,-1.28012,-1.07,-0.0059,211.656,4.115028,-1114.6285593,-3.70768,-43.93,.2064,205.436,.230523,6585.7609101,-2.15812,-18.92,.0882,191.956,4.898507,23871.4457146,.86109,31.28,-0.164,164.729,2.586078,14914.4523348,-0.6352,6.15,-0.035,147.321,5.4553,-7700.3894694,-1.5496,-25.01,.118,124.988,.48608,7771.377145,-0.3309,3.11,-0.02,109.38,3.88323,8956.9933798,1.4963,25.13,-0.129,55.177,5.57033,-1324.178025,.6183,7.3,-0.035,45.1,.89898,25195.62374,.2428,24,-0.129,39.533,3.81213,-8538.24089,2.803,26.1,-0.118,38.43,4.30115,22756.817155,-2.8466,-12.6,.042,36.124,5.49587,24986.074274,4.5688,75.2,-0.371,30.773,1.94559,14428.125731,-4.3695,-37.7,.166,28.397,3.28586,7842.364821,-2.2114,-18.8,.077,24.358,5.64142,16171.056245,-0.6885,6.3,-0.046,18.585,4.41371,-557.31428,-1.8538,-22,.1,17.954,3.58454,8399.6791,-0.3576,3.2,-0.03,14.53,4.9416,23243.143759,.888,31.2,-0.16,14.38,.9709,32200.137139,2.384,56.4,-0.29,14.251,5.7641,-2.3012,1.523,25.1,-0.12,13.899,.3735,31085.50858,-1.324,12.4,-0.08,13.194,1.7595,-9443.319984,-5.231,-69,.33,9.679,3.0997,-16029.080894,-3.072,-50.1,.24,9.366,.3016,24080.99518,-3.465,-19.9,.08,8.606,4.1582,-1742.930514,-3.681,-44,.21,8.453,2.8416,16100.06857,1.192,28.2,-0.14,8.05,2.6292,14286.15038,-0.609,6.1,-0.03,7.63,6.2388,17285.684804,3.019,50.2,-0.25,7.447,1.4845,1256.60391,-0.053,.1,-0.01,7.371,.2736,5957.458955,-2.131,-19,.09,7.063,5.6715,33.757047,-0.308,-3.6,.02,6.383,4.7843,7004.5134,2.141,32.4,-0.16,5.742,2.6572,32409.686605,-1.942,5,-0.05,4.374,4.3443,22128.5152,-2.82,-13,.05,3.998,3.2545,33524.31516,1.766,49,-0.25,3.21,2.2443,14985.44001,-2.516,-16,.06,2.915,1.7138,24499.74767,.834,31,-0.17,2.732,1.9887,13799.82378,-4.343,-38,.17,2.568,5.4122,-7072.08751,-1.576,-25,.11,2.521,3.2427,8470.66678,-2.238,-19,.07,2.489,4.0719,-486.3266,-3.734,-44,.2,2.146,5.6135,-1952.47998,.645,7,-0.03,1.978,2.7291,39414.2,.199,37,-0.21,1.934,1.5682,33314.7657,6.092,100,-0.5,1.871,.4166,30457.20662,-1.297,12,-0.1,1.753,2.0582,-8886.0057,-3.38,-47,.2,1.437,2.386,-695.87607,.59,7,0,1.373,3.026,-209.54947,4.33,51,-0.2,1.262,5.94,16728.37052,1.17,28,-0.1,1.224,6.172,6656.74859,-4.04,-41,.2,1.187,5.873,6099.43431,-5.89,-63,.3,1.177,1.014,31571.83518,2.41,56,-0.3,1.162,3.84,9585.29534,1.47,25,-0.1,1.143,5.639,8364.73984,-2.18,-19,.1,1.078,1.229,70.98768,-1.88,-22,.1,1.059,3.326,40528.82856,3.91,81,-0.4,.99,5.013,40738.37803,-0.42,30,-0.2,.948,5.687,-17772.01141,-6.75,-94,.5,.876,.298,-0.35232,0,0,0,.822,2.994,393.02097,0,0,0,.788,1.836,8326.39022,3.05,50,-0.2,.752,4.985,22614.8418,.91,31,-0.2,.74,2.875,8330.99262,0,0,0,.669,.744,-24357.77232,-4.6,-75,.4,.644,1.314,8393.12577,-2.18,-19,.1,.639,5.888,575.33849,0,0,0,.635,1.116,23385.11911,-2.87,-13,0,.584,5.197,24428.75999,2.71,53,-0.3,.583,3.513,-9095.55517,.95,4,0,.572,6.059,29970.88002,-5.03,-32,.1,.565,2.96,.32863,1.52,25,-0.1,.561,4.001,-17981.56087,-2.43,-43,.2,.557,.529,7143.07519,-0.3,3,0,.546,2.311,25614.37623,4.54,75,-0.4,.536,4.229,15752.30376,-4.99,-45,.2,.493,3.316,-8294.9344,-1.83,-29,.1,.491,1.744,8362.4485,1.21,21,-0.1,.478,1.803,-10071.6219,-5.2,-69,.3,.454,.857,15333.2048,3.66,57,-0.3,.445,2.071,8311.7707,-2.18,-19,.1,.426,.345,23452.6932,-3.44,-20,.1,.42,4.941,33733.8646,-2.56,-2,0,.413,1.642,17495.2343,-1.31,-1,0,.404,1.458,23314.1314,-0.99,9,-0.1,.395,2.132,38299.5714,-3.51,-6,0,.382,2.7,31781.3846,-1.92,5,0,.375,4.827,6376.2114,2.17,32,-0.2,.361,3.867,16833.1753,-0.97,3,0,.358,5.044,15056.4277,-4.4,-38,.2,.35,5.157,-8257.7037,-3.4,-47,.2,.344,4.233,157.7344,0,0,0,.34,2.672,13657.8484,-0.58,6,0,.329,5.61,41853.0066,3.29,74,-0.4,.325,5.895,-39.8149,0,0,0,.309,4.387,21500.2132,-2.79,-13,.1,.302,1.278,786.0419,0,0,0,.302,5.341,-24567.3218,-0.27,-24,.1,.301,1.045,5889.8848,-1.57,-12,0,.294,4.201,-2371.2325,-3.65,-44,.2,.293,3.704,21642.1886,-6.55,-57,.2,.29,4.069,32828.4391,2.36,56,-0.3,.289,3.472,31713.8105,-1.35,12,-0.1,.285,5.407,-33.7814,.31,4,0,.283,5.998,-16.9207,-3.71,-44,.2,.283,2.772,38785.898,.23,37,-0.2,.274,5.343,15613.742,-2.54,-16,.1,.263,3.997,25823.9257,.22,24,-0.1,.254,.6,24638.3095,-1.61,2,0,.253,1.344,6447.1991,.29,10,-0.1,.25,.887,141.9754,-3.76,-44,.2,.247,.317,5329.157,-2.1,-19,.1,.245,.141,36.0484,-3.71,-44,.2,.231,2.287,14357.1381,-2.49,-16,.1,.227,5.158,2.6298,0,0,0,.219,5.085,47742.8914,1.72,63,-0.3,.211,2.145,6638.7244,-2.18,-19,.1,.201,4.415,39623.7495,-4.13,-14,0,.194,2.091,588.4927,0,0,0,.193,3.057,-15400.7789,-3.1,-50,0,.186,5.598,16799.3582,-0.72,6,0,.185,3.886,1150.677,0,0,0,.183,1.619,7178.0144,1.52,25,0,.181,2.635,8328.3391,1.52,25,0,.181,2.077,8329.0437,1.52,25,0,.179,3.215,-9652.8694,-0.9,-18,0,.176,1.716,-8815.018,-5.26,-69,0,.175,5.673,550.7553,0,0,0,.17,2.06,31295.058,-5.6,-39,0,.167,1.239,7211.7617,-0.7,6,0,.165,4.499,14967.4158,-0.7,6,0,.164,3.595,15540.4531,.9,31,0,.164,4.237,522.3694,0,0,0,.163,4.633,15545.0555,-2.2,-19,0,.161,.478,6428.0209,-2.2,-19,0,.158,2.03,13171.5218,-4.3,-38,0,.157,2.28,7216.3641,-3.7,-44,0,.154,5.65,7935.6705,1.5,25,0,.152,.46,29828.9047,-1.3,12,0,.151,1.19,-0.7113,0,0,0,.15,1.42,23942.4334,-1,9,0,.144,2.75,7753.3529,1.5,25,0,.137,2.08,7213.7105,-2.2,-19,0,.137,1.44,7214.4152,-2.2,-19,0,.136,4.46,-1185.6162,-1.8,-22,0,.136,3.03,8000.1048,-2.2,-19,0,.134,2.83,14756.7124,-0.7,6,0,.131,5.05,6821.0419,-2.2,-19,0,.128,5.99,-17214.6971,-4.9,-72,0,.127,5.35,8721.7124,1.5,25,0,.126,4.49,46628.2629,-2,19,0,.125,5.94,7149.6285,1.5,25,0,.124,1.09,49067.0695,1.1,55,0,.121,2.88,15471.7666,1.2,28,0,.111,3.92,41643.4571,7.6,125,-1,.11,1.96,8904.0299,1.5,25,0,.106,3.3,-18.0489,-2.2,-19,0,.105,2.3,-4.931,1.5,25,0,.104,2.22,-6.559,-1.9,-22,0,.101,1.44,1884.9059,-0.1,0,0,.1,5.92,5471.1324,-5.9,-63,0,.099,1.12,15149.7333,-0.7,6,0,.096,4.73,15508.9972,-0.4,10,0,.095,5.18,7230.9835,1.5,25,0,.093,3.37,39900.5266,3.9,81,0,.092,2.01,25057.0619,2.7,53,0,.092,1.21,-79.6298,0,0,0,.092,1.65,-26310.2523,-4,-68,0,.091,1.01,42062.5561,-1,23,0,.09,6.1,29342.5781,-5,-32,0,.09,4.43,15542.402,-0.7,6,0,.09,3.8,15543.1066,-0.7,6,0,.089,4.15,6063.3859,-2.2,-19,0,.086,4.03,52.9691,0,0,0,.085,.49,47952.4409,-2.6,11,0,.085,1.6,7632.8154,2.1,32,0,.084,.22,14392.0773,-0.7,6,0,.083,6.22,6028.4466,-4,-41,0,.083,.63,-7909.9389,2.8,26,0,.083,5.2,-77.5523,0,0,0,.082,2.74,8786.1467,-2.2,-19,0,.08,2.43,9166.5428,-2.8,-26,0,.08,3.7,-25405.1732,4.1,27,0,.078,5.68,48857.52,5.4,106,-1,.077,1.85,8315.5735,-2.2,-19,0,.075,5.46,-18191.1103,1.9,8,0,.075,1.41,-16238.6304,1.3,1,0,.074,5.06,40110.0761,-0.4,30,0,.072,2.1,64.4343,-3.7,-44,0,.071,2.17,37671.2695,-3.5,-6,0,.069,1.71,16693.4313,-0.7,6,0,.069,3.33,-26100.7028,-8.3,-119,1,.068,1.09,8329.4028,1.5,25,0,.068,3.62,8327.9801,1.5,25,0,.068,2.41,16833.1509,-1,3,0,.067,3.4,24709.2971,-3.5,-20,0,.067,1.65,8346.7156,-0.3,3,0,.066,2.61,22547.2677,1.5,39,0,.066,3.5,15576.5113,-1,3,0,.065,5.76,33037.9886,-2,5,0,.065,4.58,8322.1325,-0.3,3,0,.065,6.2,17913.9868,3,50,0,.065,1.5,22685.8295,-1,9,0,.065,2.37,7180.3058,-1.9,-15,0,.064,1.06,30943.5332,2.4,56,0,.064,1.89,8288.8765,1.5,25,0,.064,4.7,6.0335,.3,4,0,.063,2.83,8368.5063,1.5,25,0,.063,5.66,-2580.7819,.7,7,0,.062,3.78,7056.3285,-2.2,-19,0,.061,1.49,8294.91,1.8,29,0,.061,.12,-10281.1714,-0.9,-18,0,.061,3.06,-8362.4729,-1.2,-21,0,.061,4.43,8170.9571,1.5,25,0,.059,5.78,-13.1179,-3.7,-44,0,.059,5.97,6625.5702,-2.2,-19,0,.058,5.01,-0.508,-0.3,0,0,.058,2.73,7161.0938,-2.2,-19,0,.057,.19,7214.0629,-2.2,-19,0,.057,4,22199.5029,-4.7,-35,0,.057,5.38,8119.142,5.8,76,0,.056,1.07,7542.6495,1.5,25,0,.056,.28,8486.4258,1.5,25,0,.054,4.19,16655.0816,4.6,75,0,.053,.72,7267.032,-2.2,-19,0,.053,3.12,12.6192,.6,7,0,.052,2.99,-32896.013,-1.8,-49,0,.052,3.46,1097.708,0,0,0,.051,5.37,-6443.786,-1.6,-25,0,.051,1.35,7789.401,-2.2,-19,0,.051,5.83,40042.502,.2,38,0,.051,3.63,9114.733,1.5,25,0,.05,1.51,8504.484,-2.5,-22,0,.05,5.23,16659.684,1.5,25,0,.05,1.15,7247.82,-2.5,-23,0,.047,.25,-1290.421,.3,0,0,.047,4.67,-32686.464,-6.1,-100,0,.047,3.49,548.678,0,0,0,.047,2.37,6663.308,-2.2,-19,0,.046,.98,1572.084,0,0,0,.046,2.04,14954.262,-0.7,6,0,.046,3.72,6691.693,-2.2,-19,0,.045,6.19,-235.287,0,0,0,.044,2.96,32967.001,-0.1,27,0,.044,3.82,-1671.943,-5.6,-66,0,.043,5.82,1179.063,0,0,0,.043,.07,34152.617,1.7,49,0,.043,3.71,6514.773,-0.3,0,0,.043,5.62,15.732,-2.5,-23,0,.043,5.8,8351.233,-2.2,-19,0,.042,.27,7740.199,1.5,25,0,.042,6.14,15385.02,-0.7,6,0,.042,6.13,7285.051,-4.1,-41,0,.041,1.27,32757.451,4.2,78,0,.041,4.46,8275.722,1.5,25,0,.04,.23,8381.661,1.5,25,0,.04,5.87,-766.864,2.5,29,0,.04,1.66,254.431,0,0,0,.04,.4,9027.981,-0.4,0,0,.04,2.96,7777.936,1.5,25,0,.039,4.67,33943.068,6.1,100,0,.039,3.52,8326.062,1.5,25,0,.039,3.75,21013.887,-6.5,-57,0,.039,5.6,606.978,0,0,0,.039,1.19,8331.321,1.5,25,0,.039,2.84,7211.433,-2.2,-19,0,.038,.67,7216.693,-2.2,-19,0,.038,6.22,25161.867,.6,28,0,.038,4.4,7806.322,1.5,25,0,.038,4.16,9179.168,-2.2,-19,0,.037,4.73,14991.999,-0.7,6,0,.036,.35,67.514,-0.6,-7,0,.036,3.7,25266.611,-1.6,0,0,.036,5.39,16328.796,-0.7,6,0,.035,1.44,7174.248,-2.2,-19,0,.035,5,15684.73,-4.4,-38,0,.035,.39,-15.419,-2.2,-19,0,.035,6.07,15020.385,-0.7,6,0,.034,6.01,7371.797,-2.2,-19,0,.034,.96,-16623.626,-3.4,-54,0,.033,6.24,9479.368,1.5,25,0,.033,3.21,23661.896,5.2,82,0,.033,4.06,8311.418,-2.2,-19,0,.033,2.4,1965.105,0,0,0,.033,5.17,15489.785,-0.7,6,0,.033,5.03,21986.54,.9,31,0,.033,4.1,16691.14,2.7,46,0,.033,5.13,47114.589,1.7,63,0,.033,4.45,8917.184,1.5,25,0,.033,4.23,2.078,0,0,0,.032,2.33,75.251,1.5,25,0,.032,2.1,7253.878,-2.2,-19,0,.032,3.11,-0.224,1.5,25,0,.032,4.43,16640.462,-0.7,6,0,.032,5.68,8328.363,0,0,0,.031,5.32,8329.02,3,50,0,.031,3.7,16118.093,-0.7,6,0,.03,3.67,16721.817,-0.7,6,0,.03,5.27,-1881.492,-1.2,-15,0,.03,5.72,8157.839,-2.2,-19,0,.029,5.73,-18400.313,-6.7,-94,0,.029,2.76,16,-2.2,-19,0,.029,1.75,8879.447,1.5,25,0,.029,.32,8851.061,1.5,25,0,.029,.9,14704.903,3.7,57,0,.028,2.9,15595.723,-0.7,6,0,.028,5.88,16864.631,.2,24,0,.028,.63,16869.234,-2.8,-26,0,.028,4.04,-18609.863,-2.4,-43,0,.027,5.83,6727.736,-5.9,-63,0,.027,6.12,418.752,4.3,51,0,.027,.14,41157.131,3.9,81,0,.026,3.8,15.542,0,0,0,.026,1.68,50181.698,4.8,99,-1,.026,.32,315.469,0,0,0,.025,5.67,19.188,.3,0,0,.025,3.16,62.133,-2.2,-19,0,.025,3.76,15502.939,-0.7,6,0,.025,4.53,45999.961,-2,19,0,.024,3.21,837.851,-4.4,-51,0,.024,2.82,38157.596,.3,37,0,.024,5.21,15540.124,-0.7,6,0,.024,.26,14218.576,0,13,0,.024,3.01,15545.384,-0.7,6,0,.024,1.16,-17424.247,-0.6,-21,0,.023,2.34,-67.574,.6,7,0,.023,2.44,18.024,-1.9,-22,0,.023,3.7,469.4,0,0,0,.023,.72,7136.511,-2.2,-19,0,.023,4.5,15582.569,-0.7,6,0,.023,2.8,-16586.395,-4.9,-72,0,.023,1.51,80.182,0,0,0,.023,1.09,5261.583,-1.5,-12,0,.023,.56,54956.954,-0.5,44,0,.023,4.01,8550.86,-2.2,-19,0,.023,4.46,38995.448,-4.1,-14,0,.023,3.82,2358.126,0,0,0,.022,3.77,32271.125,.5,34,0,.022,.82,15935.775,-0.7,6,0,.022,1.07,24013.421,-2.9,-13,0,.022,.4,8940.078,-2.2,-19,0,.022,2.06,15700.489,-0.7,6,0,.022,4.27,15124.002,-5,-45,0,.021,1.16,56071.583,3.2,88,0,.021,5.58,9572.189,-2.2,-19,0,.02,1.7,-17.273,-3.7,-44,0,.02,3.05,214.617,0,0,0,.02,4.41,8391.048,-2.2,-19,0,.02,5.95,23869.145,2.4,56,0,.02,.42,40947.927,-4.7,-21,0,.019,1.39,5818.897,.3,10,0,.019,.71,23873.747,-0.7,6,0,.019,2.81,7291.615,-2.2,-19,0,.019,5.09,8428.018,-2.2,-19,0,.019,4.14,6518.187,-1.6,-12,0,.019,3.85,21.33,0,0,0,.018,.66,14445.046,-0.7,6,0,.018,1.65,.966,-4,-48,0,.018,5.64,-17143.709,-6.8,-94,0,.018,6.01,7736.432,-2.2,-19,0,.018,2.74,31153.083,-1.9,5,0,.018,4.58,6116.355,-2.2,-19,0,.018,2.28,46.401,.3,0,0,.018,3.8,10213.597,1.4,25,0,.018,2.84,56281.132,-1.1,36,0,.018,3.53,8249.062,1.5,25,0,.017,4.43,20871.911,-3,-13,0,.017,4.44,627.596,0,0,0,.017,1.85,628.308,0,0,0,.017,1.19,8408.321,2,25,0,.017,1.95,7214.056,-2,-19,0,.017,1.57,7214.07,-2,-19,0,.017,1.65,13870.811,-6,-60,0,.017,.3,22.542,-4,-44,0,.017,2.62,-119.445,0,0,0,.016,4.87,5747.909,2,32,0,.016,4.45,14339.108,-1,6,0,.016,1.83,41366.68,0,30,0,.016,4.53,16309.618,-3,-23,0,.016,2.54,15542.754,-1,6,0,.016,6.05,1203.646,0,0,0,.015,5.2,2751.147,0,0,0,.015,1.8,-10699.924,-5,-69,0,.015,.4,22824.391,-3,-20,0,.015,2.1,30666.756,-6,-39,0,.015,2.1,6010.417,-2,-19,0,.015,.7,-23729.47,-5,-75,0,.015,1.4,14363.691,-1,6,0,.015,5.8,16900.689,-2,0,0,.015,5.2,23800.458,3,53,0,.015,5.3,6035,-2,-19,0,.015,1.2,8251.139,2,25,0,.015,3.6,-8.86,0,0,0,.015,.8,882.739,0,0,0,.015,3,1021.329,0,0,0,.015,.6,23296.107,1,31,0,.014,5.4,7227.181,2,25,0,.014,.1,7213.352,-2,-19,0,.014,4,15506.706,3,50,0,.014,3.4,7214.774,-2,-19,0,.014,4.6,6665.385,-2,-19,0,.014,.1,-8.636,-2,-22,0,.014,3.1,15465.202,-1,6,0,.014,4.9,508.863,0,0,0,.014,3.5,8406.244,2,25,0,.014,1.3,13313.497,-8,-82,0,.014,2.8,49276.619,-3,0,0,.014,.1,30528.194,-3,-10,0,.013,1.7,25128.05,1,31,0,.013,2.9,14128.405,-1,6,0,.013,3.4,57395.761,3,80,0,.013,2.7,13029.546,-1,6,0,.013,3.9,7802.556,-2,-19,0,.013,1.6,8258.802,-2,-19,0,.013,2.2,8417.709,-2,-19,0,.013,.7,9965.21,-2,-19,0,.013,3.4,50391.247,0,48,0,.013,3,7134.433,-2,-19,0,.013,2.9,30599.182,-5,-31,0,.013,3.6,-9723.857,1,0,0,.013,4.8,7607.084,-2,-19,0,.012,.8,23837.689,1,35,0,.012,3.6,4.409,-4,-44,0,.012,5,16657.031,3,50,0,.012,4.4,16657.735,3,50,0,.012,1.1,15578.803,-4,-38,0,.012,6,-11.49,0,0,0,.012,1.9,8164.398,0,0,0,.012,2.4,31852.372,-4,-17,0,.012,2.4,6607.085,-2,-19,0,.012,4.2,8359.87,0,0,0,.012,.5,5799.713,-2,-19,0,.012,2.7,7220.622,0,0,0,.012,4.3,-139.72,0,0,0,.012,2.3,13728.836,-2,-16,0,.011,3.6,14912.146,1,31,0,.011,4.7,14916.748,-2,-19,0],[1.6768,4.66926,628.301955,-0.0266,.1,-0.005,.51642,3.3721,6585.76091,-2.158,-18.9,.09,.41383,5.7277,14914.452335,-0.635,6.2,-0.04,.37115,3.9695,7700.389469,1.55,25,-0.12,.2756,.7416,8956.99338,1.496,25.1,-0.13,.24599,4.2253,-2.3012,1.523,25.1,-0.12,.07118,.1443,7842.36482,-2.211,-19,.08,.06128,2.4998,16171.05625,-0.688,6,0,.04516,.443,8399.6791,-0.36,3,0,.04048,5.771,14286.15038,-0.61,6,0,.03747,4.626,1256.60391,-0.05,0,0,.03707,3.415,5957.45895,-2.13,-19,.1,.03649,1.8,23243.14376,.89,31,-0.2,.02438,.042,16029.08089,3.07,50,-0.2,.02165,1.017,-1742.93051,-3.68,-44,.2,.01923,3.097,17285.6848,3.02,50,-0.3,.01692,1.28,.3286,1.52,25,-0.1,.01361,.298,8326.3902,3.05,50,-0.2,.01293,4.013,7072.0875,1.58,25,-0.1,.01276,4.413,8330.9926,0,0,0,.0127,.101,8470.6668,-2.24,-19,.1,.01097,1.203,22128.5152,-2.82,-13,0,.01088,2.545,15542.7543,-0.66,6,0,.00835,.19,7214.0629,-2.18,-19,.1,.00734,4.855,24499.7477,.83,31,-0.2,.00686,5.13,13799.8238,-4.34,-38,.2,.00631,.93,-486.3266,-3.73,-44,0,.00585,.699,9585.2953,1.5,25,0,.00566,4.073,8328.3391,1.5,25,0,.00566,.638,8329.0437,1.5,25,0,.00539,2.472,-1952.48,.6,7,0,.00509,2.88,-0.7113,0,0,0,.00469,3.56,30457.2066,-1.3,12,0,.00387,.78,-0.3523,0,0,0,.00378,1.84,22614.8418,.9,31,0,.00362,5.53,-695.8761,.6,7,0,.00317,2.8,16728.3705,1.2,28,0,.00303,6.07,157.7344,0,0,0,.003,2.53,33.757,-0.3,-4,0,.00295,4.16,31571.8352,2.4,56,0,.00289,5.98,7211.7617,-0.7,6,0,.00285,2.06,15540.4531,.9,31,0,.00283,2.65,2.6298,0,0,0,.00282,6.17,15545.0555,-2.2,-19,0,.00278,1.23,-39.8149,0,0,0,.00272,3.82,7216.3641,-3.7,-44,0,.0027,4.37,70.9877,-1.9,-22,0,.00256,5.81,13657.8484,-0.6,6,0,.00244,5.64,-0.2237,1.5,25,0,.0024,2.96,8311.7707,-2.2,-19,0,.00239,.87,-33.7814,.3,4,0,.00216,2.31,15.9995,-2.2,-19,0,.00186,3.46,5329.157,-2.1,-19,0,.00169,2.4,24357.772,4.6,75,0,.00161,5.8,8329.403,1.5,25,0,.00161,5.2,8327.98,1.5,25,0,.0016,4.26,23385.119,-2.9,-13,0,.00156,1.26,550.755,0,0,0,.00155,1.25,21500.213,-2.8,-13,0,.00152,.6,-16.921,-3.7,-44,0,.0015,2.71,-79.63,0,0,0,.0015,5.29,15.542,0,0,0,.00148,1.06,-2371.232,-3.7,-44,0,.00141,.77,8328.691,1.5,25,0,.00141,3.67,7143.075,-0.3,0,0,.00138,5.45,25614.376,4.5,75,0,.00129,4.9,23871.446,.9,31,0,.00126,4.03,141.975,-3.8,-44,0,.00124,6.01,522.369,0,0,0,.0012,4.94,-10071.622,-5.2,-69,0,.00118,5.07,-15.419,-2.2,-19,0,.00107,3.49,23452.693,-3.4,-20,0,.00104,4.78,17495.234,-1.3,0,0,.00103,1.44,-18.049,-2.2,-19,0,.00102,5.63,15542.402,-0.7,6,0,.00102,2.59,15543.107,-0.7,6,0,.001,4.11,-6.559,-1.9,-22,0,97e-5,.08,15400.779,3.1,50,0,96e-5,5.84,31781.385,-1.9,5,0,94e-5,1.08,8328.363,0,0,0,94e-5,2.46,16799.358,-0.7,6,0,94e-5,1.69,6376.211,2.2,32,0,93e-5,3.64,8329.02,3,50,0,93e-5,2.65,16655.082,4.6,75,0,9e-4,1.9,15056.428,-4.4,-38,0,89e-5,1.59,52.969,0,0,0,88e-5,2.02,-8257.704,-3.4,-47,0,88e-5,3.02,7213.711,-2.2,-19,0,87e-5,.5,7214.415,-2.2,-19,0,87e-5,.49,16659.684,1.5,25,0,82e-5,5.64,-4.931,1.5,25,0,79e-5,5.17,13171.522,-4.3,-38,0,76e-5,3.6,29828.905,-1.3,12,0,76e-5,4.08,24567.322,.3,24,0,76e-5,4.58,1884.906,-0.1,0,0,73e-5,.33,31713.811,-1.4,12,0,73e-5,.93,32828.439,2.4,56,0,71e-5,5.91,38785.898,.2,37,0,69e-5,2.2,15613.742,-2.5,-16,0,66e-5,3.87,15.732,-2.5,-23,0,66e-5,.86,25823.926,.2,24,0,65e-5,2.52,8170.957,1.5,25,0,63e-5,.18,8322.132,-0.3,0,0,6e-4,5.84,8326.062,1.5,25,0,6e-4,5.15,8331.321,1.5,25,0,6e-4,2.18,8486.426,1.5,25,0,58e-5,2.3,-1.731,-4,-44,0,58e-5,5.43,14357.138,-2,-16,0,57e-5,3.09,8294.91,2,29,0,57e-5,4.67,-8362.473,-1,-21,0,56e-5,4.15,16833.151,-1,0,0,54e-5,1.93,7056.329,-2,-19,0,54e-5,5.27,8315.574,-2,-19,0,52e-5,5.6,8311.418,-2,-19,0,52e-5,2.7,-77.552,0,0,0,51e-5,4.3,7230.984,2,25,0,5e-4,.4,-0.508,0,0,0,49e-5,5.4,7211.433,-2,-19,0,49e-5,4.4,7216.693,-2,-19,0,49e-5,4.3,16864.631,0,24,0,49e-5,2.2,16869.234,-3,-26,0,47e-5,6.1,627.596,0,0,0,47e-5,5,12.619,1,7,0,45e-5,4.9,-8815.018,-5,-69,0,44e-5,1.6,62.133,-2,-19,0,42e-5,2.9,-13.118,-4,-44,0,42e-5,4.1,-119.445,0,0,0,41e-5,4.3,22756.817,-3,-13,0,41e-5,3.6,8288.877,2,25,0,4e-4,.5,6663.308,-2,-19,0,4e-4,1.1,8368.506,2,25,0,39e-5,4.1,6443.786,2,25,0,39e-5,3.1,16657.383,3,50,0,38e-5,.1,16657.031,3,50,0,38e-5,3,16657.735,3,50,0,38e-5,4.6,23942.433,-1,9,0,37e-5,4.3,15385.02,-1,6,0,37e-5,5,548.678,0,0,0,36e-5,1.8,7213.352,-2,-19,0,36e-5,1.7,7214.774,-2,-19,0,35e-5,1.1,7777.936,2,25,0,35e-5,1.6,-8.86,0,0,0,35e-5,4.4,23869.145,2,56,0,35e-5,2,6691.693,-2,-19,0,34e-5,1.3,-1185.616,-2,-22,0,34e-5,2.2,23873.747,-1,6,0,33e-5,2,-235.287,0,0,0,33e-5,3.1,17913.987,3,50,0,33e-5,1,8351.233,-2,-19,0],[.00487,4.6693,628.30196,-0.027,0,-0.01,.00228,2.6746,-2.3012,1.523,25,-0.12,.0015,3.372,6585.76091,-2.16,-19,.1,.0012,5.728,14914.45233,-0.64,6,0,.00108,3.969,7700.38947,1.55,25,-0.1,8e-4,.742,8956.99338,1.5,25,-0.1,254e-6,6.002,.3286,1.52,25,-0.1,21e-5,.144,7842.3648,-2.21,-19,0,18e-5,2.5,16171.0562,-0.7,6,0,13e-5,.44,8399.6791,-0.4,3,0,126e-6,5.03,8326.3902,3,50,0,12e-5,5.77,14286.1504,-0.6,6,0,118e-6,5.96,8330.9926,0,0,0,11e-5,1.8,23243.1438,.9,31,0,11e-5,3.42,5957.459,-2.1,-19,0,11e-5,4.63,1256.6039,-0.1,0,0,99e-6,4.7,-0.7113,0,0,0,7e-5,.04,16029.0809,3.1,50,0,7e-5,5.14,8328.3391,1.5,25,0,7e-5,5.85,8329.0437,1.5,25,0,6e-5,1.02,-1742.9305,-3.7,-44,0,6e-5,3.1,17285.6848,3,50,0,54e-6,5.69,-0.352,0,0,0,43e-6,.52,15.542,0,0,0,41e-6,2.03,2.63,0,0,0,4e-5,.1,8470.667,-2.2,-19,0,4e-5,4.01,7072.088,1.6,25,0,36e-6,2.93,-8.86,-0.3,0,0,3e-5,1.2,22128.515,-2.8,-13,0,3e-5,2.54,15542.754,-0.7,6,0,27e-6,4.43,7211.762,-0.7,6,0,26e-6,.51,15540.453,.9,31,0,26e-6,1.44,15545.055,-2.2,-19,0,25e-6,5.37,7216.364,-3.7,-44,0],[12e-6,1.041,-2.3012,1.52,25,-0.1,17e-7,.31,-0.711,0,0,0]]],m=648e3/Math.PI,g=new Array(-4e3,108371.7,-13036.8,392,0,-500,17201,-627.82,16.17,-0.3413,-150,12200.6,-346.41,5.403,-0.1593,150,9113.8,-328.13,-1.647,.0377,500,5707.5,-391.41,.915,.3145,900,2203.4,-283.45,13.034,-0.1778,1300,490.1,-57.35,2.085,-0.0072,1600,120,-9.81,-1.532,.1403,1700,10.2,-0.91,.51,-0.037,1800,13.4,-0.72,.202,-0.0193,1830,7.8,-1.81,.416,-0.0247,1860,8.3,-0.13,-0.406,.0292,1880,-5.4,.32,-0.183,.0173,1900,-2.3,2.06,.169,-0.0135,1920,21.2,1.69,-0.304,.0167,1940,24.2,1.22,-0.064,.0031,1960,33.2,.51,.231,-0.0109,1980,51,1.29,-0.026,.0032,2e3,63.87,.1,0,0,2005,64.7,.4,0,0,2015,69),y=new Array(2.1824,-33.75705,36e-6,-1720,920,3.5069,1256.66393,11e-6,-132,57,1.3375,16799.4182,-0.000051,-23,10,4.3649,-67.5141,72e-6,21,-9,.04,-628.302,0,-14,0,2.36,8328.691,0,7,0,3.46,1884.966,0,-5,2,5.44,16833.175,0,-4,2,3.69,25128.11,0,-3,0,3.55,628.362,0,2,0),k={E_Lon:function(e,t){return N(0,0,e,t)},M_Lon:function(e,t){return C(0,e,t)},E_v:function(e){var t=628.307585*e;return 628.332+21*Math.sin(1.527+t)+.44*Math.sin(1.48+t*2)+.129*Math.sin(5.82+t)*e+55e-5*Math.sin(4.21+t)*e*e},M_v:function(e){var t=8399.71-914*Math.sin(.7848+8328.691425*e+1523e-7*e*e);return t-=179*Math.sin(2.543+15542.7543*e)+160*Math.sin(.1874+7214.0629*e)+62*Math.sin(3.14+16657.3828*e)+34*Math.sin(4.827+16866.9323*e)+22*Math.sin(4.9+23871.4457*e)+12*Math.sin(2.59+14914.4523*e)+7*Math.sin(.23+6585.7609*e)+5*Math.sin(.9+25195.624*e)+5*Math.sin(2.32-7700.3895*e)+5*Math.sin(3.88+8956.9934*e)+5*Math.sin(.49+7771.3771*e),t},MS_aLon:function(e,t,n){return this.M_Lon(e,t)+w(e)-(this.E_Lon(e,n)+b(e)+Math.PI)},S_aLon:function(e,t){return this.E_Lon(e,t)+E(e)+b(e)+Math.PI},MS_aLon_t:function(e){var t,n=7771.37714500204;return t=(e+1.08472)/n,t+=(e-this.MS_aLon(t,3,3))/n,n=this.M_v(t)-this.E_v(t),t+=(e-this.MS_aLon(t,20,10))/n,t+=(e-this.MS_aLon(t,-1,60))/n,t},S_aLon_t:function(e){var t,n=628.3319653318;return t=(e-1.75347-Math.PI)/n,n=this.E_v(t),t+=(e-this.S_aLon(t,10))/n,n=this.E_v(t),t+=(e-this.S_aLon(t,-1))/n,t},MS_aLon_t2:function(e){var t,n=7771.37714500204;t=(e+1.08472)/n;var r,i=t*t;return t-=(-0.00003309*i+.10976*Math.cos(.784758+8328.6914246*t+152292e-9*i)+.02224*Math.cos(.1874+7214.0628654*t-21848e-8*i)-.03342*Math.cos(4.669257+628.307585*t))/n,r=this.M_Lon(t,20)-(4.8950632+628.3319653318*t+5297e-9*t*t+.0334166*Math.cos(4.669257+628.307585*t)+2061e-7*Math.cos(2.67823+628.307585*t)*t+349e-6*Math.cos(4.6261+1256.61517*t)-20.5/m),n=7771.38-914*Math.sin(.7848+8328.691425*t+1523e-7*t*t)-179*Math.sin(2.543+15542.7543*t)-160*Math.sin(.1874+7214.0629*t),t+=(e-r)/n,t},S_aLon_t2:function(e){var t,n,r=628.3319653318;return t=(e-1.75347-Math.PI)/r,t-=(5297e-9*t*t+.0334166*Math.cos(4.669257+628.307585*t)+2061e-7*Math.cos(2.67823+628.307585*t)*t)/r,t+=(e-this.E_Lon(t,8)-Math.PI+(20.5+17.2*Math.sin(2.1824-33.75705*t))/m)/r,t}};window.Lunar=t,window.lunar=e,window.NewMoon=l,window.Term=c,window.zodiacForLunarYear=a,window.getSolarDate=u,window.leapDays=i,window.leapMonth=s,window.monthDays=o}(),function(){function t(e){return(e<10?"0":"")+e}var e={"正月初一":"t,春节 ","正月十五":"t,元宵节","二月初二":"t,龙头节","五月初五":"t,端午节","七月初七":"t,七夕节","七月十五":"t,中元节","八月十五":"t,中秋节","九月初九":"t,重阳节","十月初一":"t,寒衣节","十月十五":"t,下元节","腊月初八":"t,腊八节","腊月廿三":"t,祭灶节","0308":"i,妇女节,1975","0501":"i,劳动节,1889","0512":"i,护士节,1912","0531":"i,无烟日,1988",1201:"i,艾滋病日,1988","0101":"h,元旦","0312":"h,植树节,1979","0504":"h,青年节,1939","0601":"h,儿童节,1950","0701":"h,建党节,1941","0801":"h,建军节,1933","0910":"h,教师节,1985",1001:"h,国庆节,1949","0606":"n,爱眼日,1996","0918":"n,九一八,1931",1111:"n,光棍节,1990",1213:"n,南京大屠杀,1938",1031:"c,万圣节",1224:"c,平安夜",1225:"c,圣诞节","0214":"a,情人节","0401":"a,愚人节",w:{"0520":"i,母亲节,1913","0630":"a,父亲节",1144:"a,感恩节(美国)",1021:"a,感恩节(加拿大)"}};Lunar.prototype.festival=function(){var n=this.oDate.getFullYear(),r=this.oDate.getMonth()+1,i=this.oDate.getDate(),s=t(r)+t(i),o=this.oDate.getDay(),u=Math.ceil(i/7),a=t(r)+u+o,f=this.lMonth,l=this.lDate,c=f+"月"+l,h=[];this.lNextMonth=="正"&&l==(this.isBigMonth?"三十":"廿九")&&h.push("t,除夕"),e.w[a]&&(h=h.concat(e.w[a].split("|"))),e[s]&&(h=h.concat(e[s].split("|"))),e[c]&&(h=h.concat(e[c].split("|")));for(var p,d=h.length-1;d>-1;d--){p=h[d].split(",");if(p[2]&&n<p[2]-0){h.splice(d,1);continue}h[d]={type:p[0],desc:p[1]}}return h.sort(function(e,t){return t.type.charCodeAt(0)-e.type.charCodeAt(0)})}}(),function(){Lunar.prototype.getMonthInfo=function(){var e=this.newMoons,t=new Date(this.oDate);return this.mjd<this.newMoons[e.zyIndex].JD&&(e=NewMoon.getNewMoons(Term.getTerms(this.terms[3].JD-365.2416))),e=e.slice(e.zyIndex).slice(0,e.leapIndex?13:12),t.setDate(t.getDate()-Math.round(this.mjd)+e[0].JD),e.solarSpringDay=t,e}}(),define("rebuild/base/solarAndLunar",function(){}),define("rebuild/module/user",["rebuild/base/common","rebuild/base/solarAndLunar"],function(e){function t(){$("#sp_user_info").html(r(G.currDate)),amplify.publish("userInfoShown")}function n(e){var t=e.getHours(),n;return t<6?n="凌晨好，":t<9?n="早上好，":t<12?n="上午好，":t<14?n="中午好，":t<17?n="下午好，":t<19?n="傍晚好，":t<22?n="晚上好，":n="深夜好，",n}function r(t){if(G.needBind)return $(".calendar_site").hide(),n(t)+'<a href="#" class="user_reg_bind" onclick="return openRegBindWin();">注册365日历账号并绑定</a>';if(e.isPCVersion())return n(t)+(window.G&&G.currUser&&G.currUser.username);var r=lunar(t),i=window.G&&G.currUser&&G.currUser.username&&G.currUser.username+"，"||"",s=r.festival(),o="今天是"+t.getFullYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日，",u="农历"+r.lMonth+"月"+r.lDate+"，",a=[n(t),i,o,u,"周"+r.cnDay].join("");return s[0]&&s[0].desc&&(a+="，",a+=s[0].desc),a}amplify.subscribe("initApp",t)}),define("rebuild/widget/rightBubbleMenu",["rebuild/base/common"],function(e){var t=null;$.widget("mxx.rightBubbleMenu",{options:{buttons:[],stopPropagation:!1},_create:function(){var e=this,n=this.options;if(n.buttons.length==0)return e.destroy();t!==null&&(t.destroy(),t=null),e._buildMenu(),e._bindLogic(),t=e},destroy:function(e){var n=this,r=n.menu;try{r.off(".rightBubbleMenu"),$("body").off(".rightBubbleMenu"),amplify.unsubscribe("closeRightBubbleMenu",e),r.fadeOut("fast",function(){r.remove()})}catch(i){}t=null,$.Widget.prototype.destroy.call(n)},_buildMenu:function(){var e=this,t=e.options;window.self=e;var n='						<div class="create_schedule_list_layer none">							<ul>{list}</ul>							<div class="layer_arrow_left">								<em class="arrow_10"></em><em class="arrow_9"></em><em class="arrow_8"></em><em class="arrow_7"></em><em class="arrow_6"></em><em class="arrow_5"></em><em class="arrow_4"></em><em class="arrow_3"></em><em class="arrow_2"></em><em class="arrow_1"></em>							</div>						<div class="layer_arrow_left">',r=$.format('<li i="{INDEX}"><a href="javascript:;">{text}</a></li>',t.buttons),i=e.menu=$($.format(n,{list:r})).appendTo("body"),s=function(){e.destroy(s)};i.on("click.rightBubbleMenu",s),$("body").on("click.rightBubbleMenu",s),amplify.subscribe("closeRightBubbleMenu",s);var o=$(this.element),u=o.offset();i.css({top:u.top-20+Math.floor(o.height()/2),left:u.left+o.width()+10}).fadeIn("fast")},_bindLogic:function(){var e=this,t=e.options,n=$(this.element);e.menu.on("click.rightBubbleMenu","li",function(){var e=$(this),r=e.attr("i"),i=t.buttons[r].onclick;$.isFunction(i)?i.call(n):e[i]($.extend(t.buttons[r].params,{target:n}))})}})}),define("rebuild/widget/placeholder",["rebuild/base/common"],function(e){$.widget("mxx.placeholder",{options:{attr:"placeholder",holdingClass:"holding",value:""},_create:function(){var e=this,t=$(this.element),n=this.options;this.holdText=t.attr(n.attr);if(!$.browser.msie)return;t.focus(function(r){var i=t.val();(i==""||i==e.holdText)&&t.val(""),t.removeClass(n.holdingClass)}).on("drop",function(n){var r=t.val();(r==""||r==e.holdText)&&t.val("")}).blur(function(r){var i=t.val();i==""||i==e.holdText?t.val(e.holdText).addClass(n.holdingClass):t.removeClass(n.holdingClass)}).blur()},val:function(){var e=this,t=$(this.element),n=this.options;return t.val()==this.holdText?"":t.val()}})}),define("rebuild/widget/userValidate",["rebuild/base/common"],function(e){$.widget("mxx.userValidate",{options:{input:null,target:null,permit:null},_create:function(){var e=this,t=$(this.element),n=this.options;t.click(function(){var t=n.input,r=t.val();if(!r)return $.alert("请填写用户名或邮箱！",{buttons:{"确定":function(){$(this).dialog("close"),t.focus().select()}}});$.ajax({type:"post",url:"/account/findUser.do",data:{username:r},dataType:"json",error:function(){$.alert("对不起，网络繁忙，请稍后再试。")},success:function(n){if(n.state=="correct")e.addUser($.extend(n,{accountType:"-100",icon:"rili365"}))||$.alert("该用户已在您的分享列表中！",{close:function(){t.val("").focus()}});else if(n.state=="currentUser")$.alert("您填写的是自己的用户名或邮箱！",{close:function(){t.val("").focus()}});else if(n.state=="noExist"){var i=/^([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;i.test(r)?$.confirm("该用户还不是365日历用户，确定邀请您的朋友加入吗？",{buttons:[{text:"马上邀请",click:function(){e.addUser($.extend(n,{accountType:"-300",userid:"-1",username:r,icon:"email_icon"}))||$.alert("该用户已在您的分享列表中！",{close:function(){t.val("").focus()}}),$(this).dialog("close")}}]}):n.state=="wrongpass"?$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}}):$.alert("该用户不存在，请输入您要邀请的的邮箱地址！",{close:function(){t.focus().select()}})}}})})},addUser:function(e){var t=this,n=$(this.element),r=this.options,i=r.target,s=r.input,o=' selected="selected"',u=e.accessType||r.permit.val();if(!i.find('tr[accountType="'+e.accountType+'"][accountId="'+e.userid+'"][accountName="'+e.username+'"]').size()){var a='<tr accountType="{accountType}" accountId="{userid}" accountName="{username}">						<td width="105" align="center">&nbsp;</td>						<td width="340" align="left">							<div class="mail_type {icon}">{username}</div>						</td>						<td width="110" align="center"><select id="dlt_user_right_{userid}"><option value="1"{readonly}>收藏者</option><option value="2"{edit}>管理员</option></select></td>						<td width="60" align="center"><a href="javascript:;" class="js_del_user" title="取消当前日历对{username}的共享">删除</a></td>						<td width="55">&nbsp;</td>					</tr>',f=$($.format(a,$.extend(e,{readonly:u=="1"?o:"",edit:u=="2"?o:"",admin:u=="3"?o:""}))).prependTo(i);return $("a.js_del_user",f).click(function(e){e.preventDefault(),$(this).blur().parents("tr[accountId]").remove()}),s.val("").focus(),!0}return!1}})}),define("rebuild/widget/ctrlEnter",["rebuild/base/common"],function(e){$.widget("mxx.ctrlEnter",{options:{action:null,noCtrl:!1},_create:function(){var e=this,t=$(this.element),n=this.options;t.keypress(function(e){(n.noCtrl&&!e.ctrlKey||e.ctrlKey)&&(e.which==13||e.which==10)&&($.isFunction(n.action)?n.action=$.proxy(n.action,this)():$(n.action).triggerHandler("click"))})}})}),define("rebuild/widget/importFromSina",["rebuild/base/common"],function(e){$.widget("mxx.importFromSina",{options:{target:null},_create:function(){var e=this,t=$(this.element),n=this.options;t.click(function(){e.users?e.showUsers(e.users):$.ajax({type:"post",url:"/weibo/friends-web.do",success:function(t){t.state=="no_weibo"?$.confirm("您的帐号还没有绑定新浪微博，是否现在绑定？",{buttons:[{text:"现在绑定",click:function(){$(this).dialog("close"),location="/account/manage.do?tab=account"}}]}):t.state=="ok"?e.showUsers(e.users=t.users):$.alert("发现未知错误："+t.state)},dataType:"json"})})},getAlreadyShared:function(){var e=this,t=$(this.element),n=this.options,r=$("#tb_share_user_list"),i=r.find('tr[accountType="-200"]'),s={};return i.each(function(e,t){var n=$(this),r=n.attr("accountId");s[r]=!0}),s},showUsers:function(e){var t=this,n=$(this.element),r=this.options,i=this.getAlreadyShared(),s='<li class="e_clear ui-corner-all" userid="{userId}" username="{screenName}"><div class="sina_avatar"><img src="{profileImageUrl.protocol}://{profileImageUrl.host}"/></div><div class="sina_name">{screenName}</div></li>',o=['<div title="请选择您的微博好友" class="sinafriend ui-corner-all ui-shadow none"><div class="sinafriend_list"><ul class="e_clear">',$.format(s,$.map(e,function(e){return i[e.userId]?undefined:e})),'</ul></div><div class="sinafriend_bottom ui-corner-bl ui-corner-br"><a href="javascript:;" class="sinafriend_btn js_invite">确认邀请</a><div class="search_sinafriend"><input type="text" class="enter js_filter" placeholder="输入名字搜索"/></div></div></div>'].join(""),u=$(o).dialog({width:836,resizable:!1}),a=u.find("li").click(function(e){$(this).toggleClass("on")});u.find("input.js_filter").placeholder().input({onInput:function(e){e?a.hide().filter("[username*="+e+"]").show():a.show()}}),u.find("a.js_invite").click(function(e){var t=a.filter(".on");if(t.size()){var n=[];t.map(function(){var e=$(this),t=e.attr("userid"),i=e.attr("username");r.target.userValidate("addUser",{accountType:"-200",userid:t,username:i,icon:"sina_weibo"})||n.push(i)}),u.dialog("close"),n.length&&$.alert('用户"'+n.slice(0,3).join('"、"')+(n.length>3?'"等':'"')+"已在您的分享列表中")}else $.confirm("您没有选择任何新浪微博好友！ <br/>您希望：",{buttons:[{text:"选择好友",click:function(){$(this).dialog("close")}},{text:"放弃选择",click:function(){$(this).dialog("close"),u.dialog("close")}}]})})}})}),define("rebuild/widget/loading",["rebuild/base/common"],function(){$.widget("mxx.loading",{options:{speed:500},_create:function(){var e=this,t=$(this.element),n=this.options;this.loadingTimer=null,this.oriText=t.text(),t.click(function(e){t.hasClass("loading")&&e.stopImmediatePropagation()})},start:function(){var e=this,t=$(this.element),n=this.options,r=0,i="...";t.addClass("loading"),this.loadingTimer=setInterval(function(){t.html(e.oriText+i.slice(0,r++%3+1))},n.speed)},end:function(){var e=this,t=$(this.element),n=this.options,r=1;t.removeClass("loading"),clearInterval(this.loadingTimer),t.html(e.oriText)},is:function(){var e=this,t=$(this.element),n=this.options;return t.hasClass("loading")}})}),define("rebuild/widget/calendarCreator",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/widget/placeholder","rebuild/widget/userValidate","rebuild/widget/ctrlEnter","rebuild/widget/importFromSina","rebuild/widget/loading"],function(e,t){$.widget("mxx.calendarCreator",{options:{usedColors:[],attrCldID:"cldID",attrCldName:"cldName",target:null},_create:function(){var e=this,t=$(this.element),n=this.options,r,i="创建新日历";n.target&&(r=n.target.attr(n.attrCldID))&&(i="编辑日历"),e.addForm||e._initForm(),e.addForm.dialog({title:i,width:684,modal:!0,open:function(t,n){e.addForm.find(".create_schedule_email").show(),r&&e.loadData(r)}})},_initForm:function(){var e=this,n=$(this.element),r=this.options,i=t.getUsedColors(),s=$.map("ce312d,df4176,9a409b,6629cf,30659b,2f63cf,12ab99,2c9360,009802,64ac00,aaab00,d7af00,f08800,df5500,a9706f,8d6c8d,617488,6f82a9,5a8d87,898a4e,b18c55".split(","),function(e,t){return{color:e,title:(t=i["#"+e])?t.title:""}}),o='<div class="create_schedule_layer ui-shadow none"><div class="create_schedule_content"><div class="create_schedule_box"><dl class="e_clear"><dt>名称：<input type="hidden" class="js_cldid"/></dt><dd><input type="text" class="schedule_name js_cldname" maxlength="20" placeholder="请输入日历名称"/></dd></dl><dl class="e_clear"><dt>描述：</dt><dd><input type="text" class="schedule_description js_clddescption" maxlength="200" placeholder="请输入日历描述"/></dd></dl><dl class="e_clear"><dt>选颜色：</dt><dd class="e_clear"><div class="selected_color"></div><ul class="selected_color_list e_clear">'+$.format('<li title="{title}" bcolor="#{color}" style="background-color:#{color};"></li>',s)+'</ul></dd></dl></div><div class="create_schedule_email"><table cellspacing="0" cellpadding="0" width="100%" ><tr><th width="105"></th><th width="340" align="left">用户</th><th width="110">权限设置</th><th width="60">删除</th><th width="55"></th></tr><tr class="operating"><td width="105" align="right">共享给：</td><td width="340" align="left"><input maxlength="" type="text" class="add_email_input js_inputname"><a href="javascript:;" class="add_email_btn js_adduser">添加</a><span class="sina_icon js_import none" title="从新浪微博导入"><img src="/images/sina.png" width="16" height="16"/></span><span class="qq_icon none" title="从腾讯微博导入"><img src="/images/qq.png" width="16" height="16"/></span></td><td width="110" align="center"><select id="dlt_user_right" class="js_permit"><option value="1">收藏者</option><option value="2">管理员</option></select></td><td width="60"></td><td width="55"></td></tr><tr><td><div class="add_friends"><table class="js_userlist" cellspacing="0" cellpadding="0" width="100%" ></table></div></td></tr></table></div></div><div class="create_schedule_bottom"><a href="javascript:;" class="giveup_schedule_btn">放弃</a><a href="javascript:;" class="create_schedule_btn">保存</a></div></div>';e.addForm=$(o),e.iptCldID=e.addForm.find("input.js_cldid"),e.iptCldName=e.addForm.find("input.js_cldname"),e.iptCldDesc=e.addForm.find("input.js_clddescption"),e.colorList=e.addForm.find("ul.selected_color_list"),e.colorDemo=e.colorList.prev(),e.userList=e.addForm.find("table.js_userlist"),e.iptShare=e.addForm.find("input.js_inputname"),e.lnkAdd=e.addForm.find("a.js_adduser"),e.spImport=e.addForm.find("span.js_import"),e.btnCancel=e.addForm.find("a.giveup_schedule_btn"),e.btnSave=e.addForm.find("a.create_schedule_btn"),e.permit=e.addForm.find("select.js_permit"),e.iptCldName.placeholder(),e.iptCldDesc.placeholder();var u=e.colorList.find("li").click(function(){var t=$(this).attr("bcolor");e.colorDemo.css("background-color",t).attr("bcolor",t)}),a=u.eq(Math.floor(Math.random()*u.size()));u=u.filter('[title=""]'),a=u.size()?u.first():a,a.click(),e.lnkAdd.userValidate({input:e.iptShare,target:e.userList,permit:e.permit}),e.iptShare.ctrlEnter({action:e.lnkAdd,noCtrl:!0}),e.spImport.importFromSina({target:e.lnkAdd}),e.btnCancel.click(function(t){e.addForm.dialog("close")}),e.btnSave.loading(),e.btnSave.click(function(t){if(t.isImmediatePropagationStopped()||e.btnSave.loading("is"))return!1;t.stopPropagation();var n=e.iptCldID.val(),r=!!n,i=e.iptCldName,s=$.trim(i.placeholder("val")),o=e.colorDemo.attr("bcolor"),u,a=$.trim(e.iptCldDesc.placeholder("val"));if(!s){$.alert("请给您的日历起个名吧！",{buttons:{"确定":function(){$(this).dialog("close"),i.focus().select()}}});return}u=e._getShareUsersData();if(r){u.name=s==e.iptCldName.attr("oriName")?"":s,u.color=o==e.colorDemo.attr("oriColor")?"":o,a!=e.iptCldDesc.attr("oriDesc")&&(u.publicSetting=JSON.stringify({desc:a}));if(!u.name&&!u.color&&!u.publicSetting&&u.addShare=="[]"&&u.updatePower=="[]"&&u.deleShare=="[]"){$.confirm("日历设置没有修改，不需要保存！<br/>您希望：",{buttons:[{text:"不改了",click:function(){e.addForm.dialog("close"),e.iptCldName.val(e.iptCldName.attr("oriName")),$(this).dialog("close")}},{text:"继续修改"}]});return}}else u=$.extend(u,{color:e.colorDemo.attr("bcolor"),name:s,publicSetting:JSON.stringify({desc:a})});e.btnSave.loading("start"),$.ajax({url:r?"/main/calendarManager/save.do":"/main/calendarManager/create.do",type:"post",dataType:"json",data:u,success:function(t){e.btnSave.loading("end");if(t.state=="wrongpass")$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}});else if(r&&t===!0||t.state=="ok")amplify.publish("calendarCreated",r?"":t.calendarId),e.addForm.dialog("close")},error:function(){e.btnSave.loading("end")}})})},_getShareUsersData:function(){var e=this,t=$(this.element),n=this.options,r=e.iptCldID.val(),i=!!r,s=e.userList.find("tr"),o=":";if(i){var u=[],a=[],f=[],l={},c={};return $.each(e.oriData.users,function(e,t){var n=[t.accountType,t.accountId,t.accountName];l[n.join(o)]=t}),s.each(function(){var e=$(this),t=e.attr("accountType"),n=e.attr("accountId"),r=e.attr("accountName"),i=e.find("select").val(),s=[t,n,r],a;(a=l[s.join(o)])?(delete l[s.join(o)],i!=a.accessType&&f.push($.extend({},a,{accessType:i}))):u.push({accountType:t,accountId:n,accountName:r,accessType:i})}),$.each(l,function(e,t){a.push({accountId:t.accountId,accountType:t.accountType,invitationId:t.invitationId})}),{calendarId:r,addShare:JSON.stringify(u),deleShare:JSON.stringify(a),updatePower:JSON.stringify(f)}}return{share:JSON.stringify(s.map(function(){var e=$(this),t={accountType:e.attr("accountType"),invitationId:e.attr("accountId"),accessType:e.find("select").val()};return t.accountType=="-100"||(t.accountName=e.attr("accountName")),t}).get())}},loadData:function(e){var t=this,n=$(this.element),r=this.options;$.ajax("/main/getCalendarInfo.do?id="+e,{dataType:"json",cache:!1,success:function(e){e.state=="ok"?(t.oriData=e,t.iptCldID.val(e.calendarId),t.iptCldName.val(e.calendarName).attr("oriName",e.calendarName),t.iptCldDesc.val(e.desc).attr("oriDesc",e.desc),t.colorDemo.css("background-color",e.calendarColor).attr("bcolor",e.calendarColor).attr("oriColor",e.calendarColor),e.isPrimary=="true"&&e.users.length==0&&t.addForm.find(".create_schedule_email").hide(),$.each(e.users,function(e,n){n=$.extend({},n),n.userid=n.accountId,n.username=n.accountName,n.icon=n.accountType=="-100"?"rili365":n.accountType=="-200"?"sina_weibo":"email_icon",t.lnkAdd.userValidate("addUser",n)})):e.state=="wrongpass"?amplify.publish("loginTimeout"):$.alert("数据异常")},error:function(){}})}})}),define("rebuild/widget/calendarPlugin",["rebuild/base/common"],function(){$.calendarPlugin={},$.widget("mxx.calendarPlugin",{options:{},_create:function(){var e=this,t=$(this.element),n=this.options,r=!1;t.click(function(){var e=$(this),t=e.attr("jspath"),n=e.attr("pluginname");r||(t!="loaded"?(r=!0,$.getScript(t,function(){e.attr("jspath","loaded"),r=!1,$.calendarPlugin[n].call(e)})):$.calendarPlugin[n].call(e))})}})}),define("rebuild/widget/plugin.todo",["rebuild/base/common","rebuild/widget/calendarPlugin"],function(e){function t(e,t){return e.nodeName&&(e=n($(e)),t=n($(t))),e.state-t.state||t.priority-e.priority||(e.deadline||Number.MAX_VALUE)-(t.deadline||Number.MAX_VALUE)||t.id-e.id}function n(e,t){return{state:e.hasClass("com"),priority:e.find("a.star").hasClass("staron"),deadline:(t=e.find("div.cut_off_date input").val().split("  ")[1])&&/^\d{4}-\d{2}-\d{2}$/.test(t)?+(new Date(t.split("-").join("/"))):0,id:+e.attr("noteid")}}$.calendarPlugin.todo=function(){function n(){var t=document.documentElement,n=t.clientHeight,r=t.clientWidth;e.height(n-20),e.find("div.todo_plug_list").height(n-30-e.find("div.todo_plug_title").outerHeight()),e.width(r-60>800?800:r-60),e.position({of:document.documentElement})}var e=$("#todo_plug");if(e.length==0){var t='<div class="todo_plug ui-corner-all none" id="todo_plug"><div class="todo_plug_title"><a hidefocus="true" href="javascript:;" class="close_plug"></a><h3>待办事项</h3><a hidefocus="true" href="javascript:;" title="添加待办" class="add_todo_btn"></a></div><div class="todo_plug_content"><div class="todo_plug_list"><ul></ul></div></div></div>';$('<div class="ui-widget-overlay cal_plugin_overlay" id="todo_plug_mask"></div>').appendTo("body"),e=$(t).appendTo("body"),$(window).on("resize",n)}e.show("fade"),$("#todo_plug_mask").show("fade"),n(),e.calendarPluginTodo()},$.widget("mxx.calendarPluginTodo",{options:{},_create:function(){var t=this,n=$(this.element),r=this.options;t.$ulList=n.find("ul"),t.editHtml='<li noteid="{id}" class="default e_clear{className}"><div class="cut_off_date"><input type="text" readonly="readonly" value="{deadline}"/></div><div class="todo_btn"><a hidefocus="true" href="javascript:;" class="todo_cancel_btn">取消</a><a hidefocus="true" href="javascript:;" class="todo_save_btn">保存</a></div><div class="todo_operating"><a hidefocus="true" href="javascript:;" class="todo_complete" title="{titlemark}"></a><a hidefocus="true" href="javascript:;" class="todo_del" title="删除"></a><a hidefocus="true" href="javascript:;" class="todo_edit" title="编辑"></a></div><a hidefocus="true" href="javascript:;" class="star{priority}"></a><div class="todo_text">{encodeTitle}</div><textarea class="edit_textarea" ori="{title}">{title}</textarea></li>',n.draggable({handle:"div.todo_plug_title",opacity:.65,cancel:"a",stop:function(e,t){(t.offset.left<0||t.offset.top<0)&&$(this).css({left:Math.max(0,t.offset.left),top:Math.max(0,t.offset.top)})}}),n.find("a.close_plug").click(function(e){e.preventDefault(),n.hide("fade"),$("body > div.cal_plugin_overlay").hide("fade")}),$("li",t.$ulList).live("click",function(){var e=$(this);!e.hasClass("todo_edit")&&!e.hasClass("todo_empty")&&e.toggleClass("click")}),$("input,a",t.$ulList).live("click",function(e){this.nodeName=="A"&&e.preventDefault(),e.stopPropagation()}),n.find("a.add_todo_btn").click(function(e){var n=t.$ulList.find("li.todo_edit");if(n.size())n.hasClass("create")?n.find("textarea").focus():$.alert("请先保存或者取消当前正在编辑的待办事项！",{buttons:{"确定":function(){$(this).dialog("close"),n.find("textarea").focus()}}});else{var r=$($.format(t.editHtml,{id:"",title:"",className:" click todo_edit create",deadline:"截止日期  不限",priority:"",titlemark:"标识为已完成"})).prependTo(t.$ulList);r.find("textarea").focus(),r.find("div.cut_off_date input").datepicker($.getDPOptions({minDate:0,onSelect:function(e,t){t.input.val("截止日期  "+e)}}))}});var i=!1;$("a.star",n).live("click",function(e){var n=$(this),r=n.parents("li"),s=r.attr("noteid");if(!r.hasClass("create")){if(!i){i=!0;var o=!n.hasClass("staron");n.toggleClass("staron"),t.post("/todo/updatePriority.do",{noteId:parseInt(s),priority:o},function(e){i=!1,t.sort()},"设置待办重要性")}}else n.toggleClass("staron")}),$("a.todo_cancel_btn",n).live("click",function(e){var t=$(this).parents("li");t.hasClass("create")?t.slideUp(function(){t.remove()}):t.removeClass("click todo_edit")});var s=!1;$("a.todo_save_btn",n).live("click",function(n){var r=$(this).parents("li"),i=r.find("textarea.edit_textarea"),s,o,u;o=$.trim(i.val());if(!o){$.alert("待办内容不能为空！",{buttons:{"确定":function(){$(this).dialog("close"),i.focus()}}});return}if(o.length>1e3){$.alert("待办内容最多1000个字，超出"+(o.length-1e3)+"个字！",{buttons:{"确定":function(){$(this).dialog("close"),i.focus()}}});return}r.hasClass("create")?(s=r.find("a.star").hasClass("staron"),deadline=r.find("div.cut_off_date input").val().split("  ")[1],deadline=/^\d{4}-\d{2}-\d{2}$/.test(deadline)?deadline:"NODEADLINE",t.post("/todo/createv2.do",{priority:s,content:o,deadlinestr:deadline},function(n){n>0&&(r.attr("noteid",n),r.removeClass("create"),i.attr("ori",o),r.find("div.todo_text").html(e.htmlEncode(o).replace(/\n/g,"<br/>")),$("a.todo_cancel_btn",r).click(),t.$ulList.find("li.todo_empty").remove(),t.sort())},"保存待办")):t.post("/todo/updateContent.do",{noteId:parseInt(r.attr("noteid")),content:o},function(e){if(e){r.removeClass("todo_edit"),i.attr("ori",o);var n=o.replace(/\n/g,"<br/>");r.find("div.todo_text").html(n),$("a.todo_cancel_btn",r).click(),t.sort()}},"保存待办")}),$("a.todo_edit",n).live("click",function(e){var t=$(this),n=t.parents("li"),r=n.attr("noteid");n.addClass("click todo_edit"),n.find("textarea.edit_textarea").focus().select();var i=n.find("textarea.edit_textarea").val();n.find("textarea.edit_textarea").val(i.replace(/<br\/>/g,"\n"))}),$("a.todo_del",n).live("click",function(e){var n=$(this),r=n.parents("li"),i=r.attr("noteid");$.confirm("确定要解除该条待办吗？",{buttons:[{click:function(){var e=this;t.post("/todo/delete.do",{noteId:parseInt(i)},function(n){n&&($(e).dialog("close"),r.slideUp(function(){r.remove(),t.$ulList.find("li").size()||t.todoEmpty()}))},"删除待办")}}]})});var o=!1;$("a.todo_complete",n).live("click",function(e){var n=$(this),r=n.parents("li"),i=r.attr("noteid");if(!o){o=!0;var s=!r.hasClass("com");r.toggleClass("com"),t.post("/todo/updateState.do",{noteId:parseInt(i),state:+s},function(e){o=!1,n.attr("title",s?"标识为未完成":"标识为已完成"),t.sort()},"更新待办状态")}}),t.loadTodoData()},loadTodoData:function(){var n=this,r=$(this.element),i=this.options;n.post("/todo/findAll.do",{},function(r){r.length?(n.$ulList.empty().html($.format(n.editHtml,$.map(r.sort(t),function(t){return t.encodeTitle=e.htmlEncode(t.title),t.className=t.state?" com":"",t.deadline="截止日期  "+(t.deadline?e.formatDate(new Date(t.deadline)):"不限"),t.priority=t.priority?" staron":"",t.titlemark=t.state?"标识为未完成":"标识为已完成",t}))),n.$ulList.find("div.cut_off_date input").datepicker($.getDPOptions({minDate:0,onSelect:function(e,t){t.input.val("截止日期  "+e),n.post("/todo/updateDeadline.do",{noteId:parseInt(t.input.parents("li").attr("noteid")),deadlinestr:e},function(e){n.sort()},"更新待办截止日期")}}))):n.todoEmpty()},"获取待办列表数据")},post:function(e,t,n,r){$.loading.is()||($.loading(),$.ajax({url:e,type:"post",dataType:"json",data:t,success:function(e){$.loading.close(),$.isFunction(n)&&n(e)},error:function(e,t,n){$.loading.close(),$.alert(r+"时出现错误:"+t+":"+n)}}))},sort:function(){this.$ulList.append(this.$ulList.find("li").toArray().sort(t))},todoEmpty:function(){this.$ulList.empty().html('<li class="todo_empty">好记性不如烂笔头，有什么待办的事，就记下来吧！</li>')}})}),$.widget("mxx.birthdaylunarPicker",{options:{yearStart:1901,yearEnd:lunar(new Date).lYear+1984,date:new Date,onChange:null},_create:function(){var e=this,t=$(this.element),n=this.options;this.dlts=t.find("select"),this.$year=this.dlts.eq(0),this.$month=this.dlts.eq(1),this.$date=this.dlts.eq(2),this.yearHtml=$.format('<option value="{value}">{text}</option>',$.map(new Array(n.yearEnd-n.yearStart+1),function(e,t){return{value:t+n.yearStart,text:t+n.yearStart+"年"}})),this.$date.change(function(){e._triggerChangeEvent()}),this.setDate(n.date)},_init:function(){var e=this,t=$(this.element),n=this.options;this.setDate(n.date)},init:function(){var e=this,t=$(this.element),n=this.options,r=this.lunarDate.sYear+1984;this.$year.empty(),this.$year.append(this.yearHtml.replace('"'+r+'"','"'+r+'"'+' selected="selected"')),this.$year.append("<option value='none'>无</option>"),this.$year.off("change").change(function(t){e._calYearData(),e._fillMonth(t),e._fillDate(t)}).change(),this.$month.off("change").change(function(t){e._fillDate(t)}).change(),this.$date.off("change").change(function(t){if(e.$year.find("option:selected").val()=="none"){$(".transform_solarlunar_txt").html("");return}var n=e.$date.find("option:selected").attr("date").split("-");$(".transform_solarlunar_txt").html("公历："+n[0]+"年"+n[1]+"月"+n[2]+"日")}).change()},_fillMonth:function(e){var t=this,n=$(this.element),r=this.options,i=e.isTrigger?(t.lunarDate.isLeap?"r":"")+(t.lunarDate.monthIndex+1):t.$month.val().slice(-(t.$month.val()-1));t.$month.empty().append($.format('<option idx="{INDEX}" value="{value}">{text}</option>',t.data).replace('value="'+i+'"','value="'+i+'"'+' selected="selected"')),t.$month.change()},_fillDate:function(e){var t=this,n=$(this.element),r=this.options,i=t.$month.find("option:selected").attr("idx"),s=e.isTrigger?t.lunarDate.dateIndex+1:t.$date.val();t.$date.empty().append($.format('<option date="{date}" value="{value}">{text}</option>',t.data[i].days).replace('value="'+s+'"','value="'+s+'"'+' selected="selected"')),t.$date.change()},_triggerChangeEvent:function(){var e=this,t=$(this.element),n=this.options,r=this.$date.find("option:selected");$.isFunction(n.onChange)&&n.onChange.apply(this,[r.attr("date"),this.$year.find("option:selected").text(),this.$month.find("option:selected").text(),r.text()])},_calYearData:function(){var e=this,t=$(this.element),n=this.options,r=lunar(new Date(e.$year.val(),2,1)).getMonthInfo(),s=r.solarSpringDay,o;e.data=[];var u=new Date,a=lunar(u);e.$year.val()!="none"&&n.noyear!=0?$.each(r,function(t,n){if(e.$year.val()==u.getFullYear()&&t>a.monthIndex)return;o=e.data[t]={value:(n.isLeap?"r":"")+((n.index-2)%12+1),text:n.name+"月",days:[]},$.each(new Array(n.days),function(n){if(e.$year.val()==u.getFullYear()&&t==a.monthIndex&&n>a.dateIndex)return;o.days.push({value:n+1,text:Lunar.DB.dateCn[n],date:[s.getFullYear(),s.getMonth()+1,s.getDate()].join("-")}),s.setDate(s.getDate()+1)})}):$.each(Lunar.DB.monthCn,function(t,n){i=(t+2)%12,o=e.data[t]={value:t+1,text:Lunar.DB.monthCn[i]+"月",days:[]},$.each(Lunar.DB.dateCn,function(e,t){if(e==30)return;o.days.push({value:e+1,text:t,date:""})})})},getDate:function(){var e=this,t=$(this.element),n=this.options;return new Date(this.$date.find("option:selected").attr("date").replace(/-/g,"/"))},getLunarInfo:function(){var e=this,t=$(this.element),n=this.options;return{year:this.$year.val(),month:this.$month.val(),date:this.$date.val(),cnYear:this.$year.find("option:selected").text(),cnMonth:this.$month.find("option:selected").text(),cnDate:this.$date.find("option:selected").text()}},setDate:function(e){this.date=e,this.lunarDate=lunar(this.date),this.init()},hideYear:function(){var e=this,t=$(this.element),n=this.options;e.$year.val("none")}}),define("rebuild/widget/birthday.lunarPicker",function(){}),$.widget("mxx.solarPicker",{options:{yearStart:1901,yearEnd:(new Date).getFullYear(),date:new Date,onChange:null},_create:function(){var e=this,t=$(this.element),n=this.options;this.dlts=t.find("select"),this.$year=this.dlts.eq(0),this.$month=this.dlts.eq(1),this.$date=this.dlts.eq(2),this.yearHtml=$.format('<option value="{value}">{text}</option>',$.map(new Array(n.yearEnd-n.yearStart+1),function(e,t){return{value:t+n.yearStart,text:t+n.yearStart+"年"}})),this.$date.change(function(){e._triggerChangeEvent()})},_init:function(){var e=this,t=$(this.element),n=this.options;this.setDate(n.date)},init:function(){var e=this,t=$(this.element),n=this.options,r=this.date.getFullYear();this.$year.empty(),this.$year.append(this.yearHtml.replace('"'+r+'"','"'+r+'"'+' selected="selected"')),this.$year.append("<option value='none'>无</option>"),this.$year.off("change").change(function(t){e._calYearData(),e._fillMonth(t),e._fillDate(t)}).change(),this.$month.off("change").change(function(t){e._fillDate(t)}).change(),this.$date.off("change").change(function(t){if(e.$year.find("option:selected").val()=="none"){$(".transform_solarlunar_txt").html("");return}var n=e.$date.find("option:selected").attr("date").split("-"),r=new Date;r.setFullYear(n[0]),r.setMonth(parseInt(n[1])-1),r.setDate(n[2]);var i=lunar(r),s=i.gzYear,o=i.lMonth,u=i.lDate;$(".transform_solarlunar_txt").html("农历："+s+"年"+o+"月"+u)}).change()},_fillMonth:function(e){var t=this,n=$(this.element),r=this.options,i=e.isTrigger?t.date.getMonth():t.$month.val().slice(-(t.$month.val()-1));t.$month.empty().append($.format('<option idx="{INDEX}" value="{value}">{text}</option>',t.data).replace('value="'+i+'"','value="'+i+'"'+' selected="selected"')),t.$month.change()},_fillDate:function(e){var t=this,n=$(this.element),r=this.options,i=t.$month.find("option:selected").attr("idx"),s=e.isTrigger?t.date.getDate():t.$date.val();t.$date.empty().append($.format('<option date="{date}" value="{value}">{text}</option>',t.data[i].days).replace('value="'+s+'"','value="'+s+'"'+' selected="selected"')),t.$date.change()},_triggerChangeEvent:function(){var e=this,t=$(this.element),n=this.options,r=this.$date.find("option:selected");$.isFunction(n.onChange)&&n.onChange.apply(this,[r.attr("date"),this.$year.find("option:selected").text(),this.$month.find("option:selected").text(),r.text()])},_calYearData:function(){var e=this,t=$(this.element),n=this.options,r=[0,1,2,3,4,5,6,7,8,9,10,11],i,s=this.$year.find("option:selected").text().slice(0,4),o=new Date;e.data=[],$.each(r,function(t,r){var u=e.getDays(s,t+1);if(e.$year.val()==o.getFullYear()&&n.noneyear!=0){if(t>o.getMonth())return;t==o.getMonth()&&(u=o.getDate())}i=e.data[t]={value:r,text:r+1+"月",days:[]};for(dayIndex=1;dayIndex<=u;dayIndex++)i.days.push({value:dayIndex,text:dayIndex,date:[s,t+1>9?t+1:"0"+(t+1),dayIndex>9?dayIndex:"0"+dayIndex].join("-")})})},getDate:function(){var e=this,t=$(this.element),n=this.options;return new Date(this.$date.find("option:selected").attr("date").replace(/-/g,"/"))},getLunarInfo:function(){var e=this,t=$(this.element),n=this.options;return{year:this.$year.val(),month:this.$month.val(),date:this.$date.val(),cnYear:this.$year.find("option:selected").text(),cnMonth:this.$month.find("option:selected").text(),cnDate:this.$date.find("option:selected").text()}},setDate:function(e){this.date=e,this.init()},hideYear:function(){var e=this,t=$(this.element),n=this.options;e.$year.val("none")},isRN:function(e){return e%4==0&&e%100!=0||e%400==0},getDays:function(e,t){var n=this,r=$(this.element),i=this.options;return t==2?n.isRN(e)?29:28:t<8?t%2==0?30:31:t%2==0?31:30}}),define("rebuild/widget/solarPicker",function(){}),define("rebuild/widget/plugin.birthday",["rebuild/base/common","rebuild/widget/calendarPlugin","rebuild/widget/birthday.lunarPicker","rebuild/widget/solarPicker"],function(e){$.calendarPlugin.birthday=function(){function n(){var t=document.documentElement,n=t.clientHeight,r=t.clientWidth;e.height(n-30),e.find("div.birthday_plug_content").height(n-30-e.find("div.birthday_plug_title").outerHeight()),e.find("div.birthday_plug_content_left").height(n-30-e.find("div.birthday_plug_title").outerHeight()-20),e.find("div.birthday_plug_content_right").height(n-30-e.find("div.birthday_plug_title").outerHeight()),e.width(r-60>800?800:r-60),e.position({of:document.documentElement})}var e=$("#birthday_plug");if(e.length==0){var t='<div class="birthday_plug ui-corner-all" id="birthday_plug"><div class="birthday_plug_title"><a class="close_plug" href="javascript:;" hidefocus="true"></a><h3>生日</h3><a class="add_birthday_btn" title="添加生日" href="javascript:;" hidefocus="true"></a></div><div class="birthday_plug_content e_clear"><div class="birthday_plug_content_left"><ul><li class="on" delta="0">全部</li><li delta="1">1月</li><li delta="2">2月</li>	<li delta="3">3月</li><li delta="4">4月</li><li delta="5">5月</li><li delta="6">6月</li><li delta="7">7月</li><li delta="8">8月</li><li delta="9">9月</li><li delta="10">10月</li><li delta="11">11月</li><li delta="12">12月</li></ul></div><div class="birthday_plug_content_right"><ul class="birthdayList"></ul></div></div></div>';$('<div class="ui-widget-overlay cal_plugin_overlay" id="birthday_plug_mask"></div>').appendTo("body"),e=$(t).appendTo("body"),$(window).on("resize",n)}e.show("fade"),$("#birthday_plug_mask").show("fade"),n(),e.calendarPluginBirthday()},$.widget("dd.calendarPluginBirthday",{options:{},_create:function(){var t=this,n=$(this.element),r=this.options;t.$ulList=n.find("ul.birthdayList"),t.editHtml='<li class="default {className}" noteid="{id}">                	<div class="birthday_list">						<div class="birthday_name e_clear">							<span class="sex_type {sex_type}">{sex}</span><span class="constellation {constellation_type}">{constellation}</span><span class="zodiac {zodiac_type}">{zodiac}</span>							<h3 class="h3_name">{name}</h3><span class="diffTime {difftime_style}" title=""></span>						</div>						<div class="birthday_time"><span class="birthday_solar {Sigonore}">公历：<span class="year_txt {is_igonore_year}">{Syear}年</span>{Smonth}月{Sday}日</span><span class="birthday_lunar {Ligonore}">农历：<span class="year_txt {is_igonore_year}">{Lyear}年</span>{Lmonth}月{Lday}</span></div>						<div class="difftime_txt"><span class="{difftime_day_color}">{difftime_day_text}</span><span class="{difftime_day_style}">天后</span> <span class="{difftime_year_style}">{difftime_year}岁</span>生日   {difftime_month}月{difftime_date}日({difftime_week})</div>					</div>					<div class="birthday_operating">						<a href="javascript:;" class="edit_birthady_btn"></a>						<a href="javascript:;" class="del_birthady_btn"></a>					</div>                    <div class="birthday_edit">                    	<div class="e_clear">	                        <div class="birthday_name">	                            <span>姓名：</span>	                            <input type="text" class="input_name">	                            </input>	                        </div>	                        <div class="birthday_gender">	                            <span>性别：</span>	                            <label class="on">	                                <span class="checkbox"></span><span class="checkbox_boy checkbox_sex">男</span>	                            </label>	                            <label>	                                <span class="checkbox"></span><span class="checkbox_gril checkbox_sex">女</span>	                            </label>	                        </div>						</div>                        <div class="birthday_date e_clear">                            <div class="add_birthday_date">                                <span>出生日期：</span>								<label class="e_clear" id="lunar_checkbox"><span class="checkbox"></span><span>农历</span></label>                            </div>                            <div class="transform_lunar none">                            	<select class="create_year">                                </select>								<span>年</span>								<select class="create_month"></select>								<span>月</span>								<select class="create_day"></select>								<span class="">日</span>                            </div>							<div class="transform_solar">                            	<select class="create_year">                                </select>								<span>年</span>								<select class="create_month">                                </select>								<span>月</span>								<select class="create_day">                                </select>								<span class="">日</span>                            </div>							<div class="transform_solarlunar_txt">农历：2012年十二月廿一日</div>                        </div>                        <div class="phone_remind">                            <span>手机提醒：</span>                            <label>                                <span class="checkbox"></span><span class="remind_txt" alarms="0">生日当天</span>                            </label>                            <label>                                <span class="checkbox"></span><span class="remind_txt" alarms="1440">提前1天</span>                            </label>                            <label>                                <span class="checkbox"></span><span class="remind_txt" alarms="4320">提前3天</span>                            </label>                            <label class="on">                                <span class="checkbox"></span><span class="remind_txt" alarms="10080">提前1周</span>                            </label>                        </div>                        <div class="birthday_btn">                            <a href="javascript:;" class="save_birthday_btn">保存</a>                            <a href="javascript:;" class="cancel_birthday_btn">取消</a>                        </div>                    </div>                </li>',n.draggable({handle:"div.birthday_plug_title",opacity:.65,cancel:"a",stop:function(e,t){(t.offset.left<0||t.offset.top<0)&&$(this).css({left:Math.max(0,t.offset.left),top:Math.max(0,t.offset.top)})}}),n.find("a.close_plug").click(function(e){e.preventDefault(),n.hide("fade"),$("body > div.cal_plugin_overlay").hide("fade")}),n.find(".birthday_plug_content_left ul li").click(function(){$(this).parent().find(".on").removeClass("on"),$(this).addClass("on");var e=$(this).attr("delta");if(e==0)n.find(".birthdayList li").show();else{var r=n.find(".birthdayList li");for(var i=0;i<r.length;i++){var s=r.eq(i);if(s.hasClass("birth_empty")||s.hasClass("create"))continue;var o=s.attr("noteid"),u=t.birthdayMap[o].month;u==e?s.show():s.hide()}}t.birthdayEmpty()}),$("li",t.$ulList).live("click",function(){var e=$(this);!e.hasClass("edit")&&!e.hasClass("birth_empty")&&e.toggleClass("click")}),$("input,a",t.$ulList).live("click",function(e){this.nodeName=="A"&&e.preventDefault(),e.stopPropagation()}),n.find("a.add_birthday_btn").click(function(e){var n=t.$ulList.find("li.edit");if(n.size())n.hasClass("create")?n.find("input.input_name").focus():$.alert("请先保存或者取消当前正在编辑的生日事项！",{buttons:{"确定":function(){$(this).dialog("close")}}});else{var r=$($.format(t.editHtml,{id:"",name:"",sex:"",className:"click edit create",birthday_type:"",is_igonore_year:"",alarms:"",year:"",month:"",day:""})).prependTo(t.$ulList);r.find("input.input_name").focus(),r.find(".transform_solar").solarPicker(),r.find(".transform_lunar").birthdaylunarPicker().hide()}}),$(".birthday_gender label",n).live("click",function(e){$(this).hasClass("on")?$(this).removeClass("on"):($(".birthday_gender label").hasClass("on")&&$(".birthday_gender label").removeClass("on"),$(this).addClass("on"))}),$(".phone_remind label",n).live("click",function(e){$(this).hasClass("on")?$(this).removeClass("on"):$(this).addClass("on")}),$(".add_birthday_date .checkbox").live("click",function(){var e=$(this).parent();e.toggleClass("on");if(e.attr("id")=="lunar_checkbox")if(e.hasClass("on")){var t=$(".transform_solar").find("select.create_day").find("option:selected").attr("date").split("-"),n=new Date;n.setFullYear(t[0]),n.setMonth(t[1]-1),n.setDate(t[2]),$(".transform_lunar").removeClass("none").birthdaylunarPicker({date:n,yearEnd:(new Date).getFullYear()}).show(),$(".transform_solar").addClass("none")}else{var r=$(".transform_lunar").find("select.create_day").find("option:selected").attr("date").split("-"),n=new Date;n.setFullYear(r[0]),n.setMonth(parseInt(r[1])-1),n.setDate(r[2]),$(".transform_solar").removeClass("none").solarPicker({date:n}),$(".transform_lunar").addClass("none")}}),$("a.cancel_birthday_btn",n).live("click",function(e){var t=$(this).parents("li");t.hasClass("create")?t.slideUp(function(){t.remove()}):t.removeClass("click edit")}),$("a.save_birthday_btn",n).live("click",function(e){var n=$(this).parents("li"),r=n.find("input.input_name"),i=$.trim(r.val());if(!i){$.alert("姓名不能为空！",{buttons:{"确定":function(){$(this).dialog("close"),r.focus()}}});return}if(n.hasClass("create")){var s=t._generateBirthdayObject(n,r);t.post("/birthday/create.do",{birth:JSON.stringify(s)},function(e){e.state=="ok"?(t.$ulList.find("li.birth_empty").hide(),t._renderNewBirth(n,s,e)):e.state=="wrongpass"?$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}}):$.alert("服务器繁忙，请稍后重试！")},"保存生日")}else{var o=n.attr("noteid"),u=t._generateBirthdayObject(n,r,o);t.post("/birthday/update.do",{birth:JSON.stringify(u)},function(e){e.state=="ok"?(e.id=o,t._renderNewBirth(n,u,e)):e.state=="wrongpass"?$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}}):$.alert("服务器繁忙，请稍后重试！")},"编辑生日")}}),$("a.edit_birthady_btn",n).live("click",function(n){var r=$(this),i=r.parents("li"),s=i.attr("noteid"),o=t.birthdayMap[s];i.addClass("edit"),i.find("input.input_name").val(e.htmlDecode(o.name)),o.sex=="男"?(i.find("label").removeClass("on"),i.find(".checkbox_boy").parents("label").addClass("on")):o.sex=="女"?(i.find("label").removeClass("on"),i.find(".checkbox_gril").parents("label").addClass("on")):i.find("label").removeClass("on");var u=o.Syear,a=parseInt(o.Smonth),f=parseInt(o.Sday),l,h=new Date;h.setFullYear(u),h.setMonth(a-1),h.setDate(f),o.year==0?(u=(new Date).getFullYear(),l=0,o.birthday_type=="L"?h=getSolarDate(u,o.month,o.day):(h=new Date,h.setFullYear(u),h.setMonth(a-1),h.setDate(f))):l=null,o.birthday_type=="S"?(i.find("div.add_birthday_date #lunar_checkbox").removeClass("on"),i.find(".transform_solar").hasClass("none")&&i.find(".transform_solar").removeClass("none"),i.find(".transform_solar").solarPicker({date:h,noneyear:l}),i.find(".transform_lunar").addClass("none"),o.year==0&&($(".transform_solarlunar_txt").html(""),i.find(".transform_solar").solarPicker("hideYear"))):(i.find("div.add_birthday_date #lunar_checkbox").addClass("on"),i.find(".transform_lunar").hasClass("none")&&i.find(".transform_lunar").removeClass("none"),i.find(".transform_lunar").birthdaylunarPicker({date:h,noyear:l}),i.find(".transform_solar").addClass("none"),o.year==0&&($(".transform_solarlunar_txt").html(""),i.find(".transform_lunar").birthdaylunarPicker("hideYear"))),$.each(o.alarms,function(e){var t=i.find(".phone_remind .remind_txt");t.each(function(){$(this).attr("alarms")==o.alarms[e].beforeMinutes&&$(this).parents("label").addClass("on")})})}),$("a.del_birthady_btn",n).live("click",function(e){var n=$(this),r=n.parents("li"),i=r.attr("noteid");$.confirm("确定要删除该条生日吗？",{buttons:[{click:function(){var e=this;t.post("/birthday/remove.do",{id:parseInt(i)},function(n){n.state=="ok"?($(e).dialog("close"),r.slideUp(function(){r.remove(),t.$ulList.find("li").size()||t.birthdayEmpty()})):n.state=="wrongpass"&&$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}})},"删除生日")}}]})})},_init:function(){var e=this,t=$(this.element),n=this.options;e.loadTodoData()},_generateBirthdayObject:function(t,n,r){var i=this,s=$(this.element),o=this.options,u,a,f,l,h=e.htmlDecode(n.val()),p=2;t.find("div.birthday_gender label.on").size()&&(t.find("div.birthday_gender label.on").find("span.checkbox_boy").size()?p=0:p=1);var d;t.find("div.add_birthday_date #lunar_checkbox").hasClass("on")?d="L":d="S";var v=$.map(t.find("div.phone_remind label.on .remind_txt"),function(e,t){return{beforeMinutes:$(e).attr("alarms")}});d=="L"?(a=t.find("div.transform_lunar .create_year").find("option:selected").val(),f=t.find("div.transform_lunar .create_month").find("option:selected").val(),l=t.find("div.transform_lunar .create_day").find("option:selected").val(),u=a=="none"?1:0):(a=t.find("div.transform_solar .create_year").find("option:selected").val(),f=t.find("div.transform_solar .create_month").find("option:selected").val(),l=t.find("div.transform_solar .create_day").find("option:selected").val(),u=a=="none"?1:0);var m=/[a-zA-Z]/g,g={name:h,sex:p,birthday_type:d,year:a=="none"?0:a,month:d=="S"?parseInt(f)+1:f.replace(m,""),day:l,alarms:v,is_igonore_year:u};return r&&(g.id=r),g},_renderNewBirth:function(e,t,n){var r=this,i=$(this.element),s=this.options,o='<div class="birthday_name e_clear">									<span class="sex_type {sex_type}">{sex}</span><span class="constellation {constellation_type}">{constellation}</span><span class="zodiac {zodiac_type}">{zodiac}</span>									<h3 class="h3_name">{name}</h3><span class="diffTime {difftime_style}" title=""></span>								</div>								<div class="birthday_time"><span class="birthday_solar {Sigonore}">公历：<span class="year_txt {is_igonore_year}">{Syear}年</span>{Smonth}月{Sday}日</span><span class="birthday_lunar {Ligonore}">农历：<span class="year_txt {is_igonore_year}">{Lyear}年</span>{Lmonth}月{Lday}</span></div>								<div class="difftime_txt"><span class="{difftime_day_color}">{difftime_day_text}</span><span class="{difftime_day_style}">天后</span>   <span class="{difftime_year_style}">{difftime_year}岁</span>生日   {difftime_month}月{difftime_date}日({difftime_week})</div>';e.removeClass("edit").removeClass("create"),e.find(".sex_type").html(t.sex);var u;e.find("div.add_birthday_date #lunar_checkbox").hasClass("on")?u="L":u="S",t.sex==0?(t.sex_type="boy",t.sex="男"):t.sex==1?(t.sex_type="girl",t.sex="女"):(t.sex="",t.sex_type="none");if(t.year==0)t.difftime_year_style="none",t.is_igonore_year="none",t.zodiac_type="none",u=="S"?(t.Sday=t.day,t.Smonth=t.month,t.constellation=r.constellation(parseInt(t.month),parseInt(t.day)),t.Ligonore="none"):(t.Lday=Lunar.DB.dateCn[t.day-1],t.Lmonth=Lunar.DB.monthCn[(parseInt(t.month)+1)%12],t.constellation_type="none",t.Sigonore="none");else{t.constellation_type="",t.zodiac_type="";if(t.birthday_type=="S"){t.Syear=t.year,t.Smonth=t.month,t.Sday=t.day;var a=new Date;a.setFullYear(t.year,t.month-1,t.day),t.Lyear=lunar(a).gzYear,t.Lmonth=lunar(a).lMonth,t.Lday=lunar(a).lDate,t.zodiac=lunar(a).animal,t.constellation=r.constellation(parseInt(t.month),parseInt(t.day)),t.Ligonore="none"}else{var f=getSolarDate(t.year,t.month,t.day);t.Syear=f.getFullYear(),t.Smonth=f.getMonth()+1,t.Sday=f.getDate(),t.Lyear=lunar(f).gzYear,t.Lmonth=lunar(f).lMonth,t.Lday=lunar(f).lDate,t.zodiac=lunar(f).animal,t.constellation=r.constellation(parseInt(t.Smonth),parseInt(t.Sday)),t.Sigonore="none"}}var l=r.difftimeDay(t.birthday_type,t.year,t.month,t.day);t.difftime_day=l.day,t.difftime_year=l.year==0?l.year+1:l.year,t.difftime_month=l.month,t.difftime_date=l.days,t.difftime_day_text=t.difftime_day,t.difftime_day<=30?(t.difftime_day_style="",t.difftime_day_color="",t.difftime_day==1?(t.difftime_day_text="明天",t.difftime_day_style="none",t.difftime_day_color="txt_tom"):t.difftime_day==2?(t.difftime_day_text="后天",t.difftime_day_style="none",t.difftime_day_color="txt_acq"):t.difftime_day_text=t.difftime_day,t.difftime_style="red"):t.difftime_day>30&&t.difftime_day<=90?(t.difftime_style="yellow",t.difftime_day_style=""):(t.difftime_style="blue",t.difftime_day_style=""),t.difftime_week=l.week,e.attr("noteid",n.id),t.name=r.html_encode(r.html_decode(t.name)),e.find(".birthday_list").html($.format(o,[t])),t.difftime_day==0&&e.find(".difftime_txt").addClass("txt_red").html("今天是"+t.name+"的生日"),typeof r.birthdayMap=="undefined"&&(r.birthdayMap={}),r.birthdayMap[n.id]=t,r._sortNewBirthday(e,t.difftime_day);var c=i.find(".birthday_plug_content_left ul .on").attr("delta");c!=0&&t.month!=c&&e.hide()},loadTodoData:function(){var e=this,t=$(this.element),n=this.options;t.find(".birthday_plug_content_left ul li:first").click(),e.post("/birthday/getList.do",{},function(n){n.length?(e.birthdayMap={},e.birthdayData=$.map(n,function(t){t.name=e.html_encode(e.html_decode(t.name)),t.birthday_type=t.birthday_type.toUpperCase(),t.sex==0?(t.sex="男",t.sex_type="boy"):t.sex==1?(t.sex="女",t.sex_type="girl"):(t.sex="",t.sex_type="none");if(t.is_igonore_year==1)t.difftime_year_style="none",t.is_igonore_year="none",t.zodiac_type="none",t.birthday_type=="L"?(t.constellation_type="none",t.Lday=Lunar.DB.dateCn[t.day-1],t.Lmonth=Lunar.DB.monthCn[(parseInt(t.month)+1)%12],t.Sigonore="none"):(t.constellation=e.constellation(parseInt(t.month),parseInt(t.day)),t.Smonth=t.month,t.Sday=t.day,t.Ligonore="none");else{t.constellation_type="",t.zodiac_type="";if(t.birthday_type=="S"){var n=new Date;n.setFullYear(t.year,t.month-1,t.day);var r=lunar(n);t.Syear=t.year,t.Smonth=t.month,t.Sday=t.day,t.Lyear=r.gzYear,t.Lmonth=r.lMonth,t.Lday=r.lDate,t.zodiac=r.animal,t.constellation=e.constellation(parseInt(t.month),parseInt(t.day)),t.Ligonore="none"}else{var i=getSolarDate(t.year,t.month,t.day),s=i.getMonth()+1,o=i.getDate(),r=lunar(i);t.constellation=e.constellation(parseInt(s),parseInt(o)),t.Syear=i.getFullYear(),t.Smonth=i.getMonth()+1,t.Sday=i.getDate(),t.Lyear=r.gzYear,t.Lmonth=r.lMonth,t.Lday=r.lDate,t.zodiac=r.animal,t.Sigonore="none"}}t.className="";var u=e.difftimeDay(t.birthday_type,parseInt(t.year),parseInt(t.month),parseInt(t.day));return t.difftime_day=u.day,t.difftime_year=u.year==0?u.year+1:u.year,t.difftime_month=u.month,t.difftime_date=u.days,t.difftime_day_text=t.difftime_day,t.difftime_day<=30?(t.difftime_day_style="",t.difftime_day_color="",t.difftime_day==1?(t.difftime_day_text="明天",t.difftime_day_style="none",t.difftime_day_color="txt_tom"):t.difftime_day==2?(t.difftime_day_text="后天",t.difftime_day_style="none",t.difftime_day_color="txt_acq"):t.difftime_day_text=t.difftime_day,t.difftime_style="red"):t.difftime_day>30&&t.difftime_day<=90?(t.difftime_style="yellow",t.difftime_day_text=t.difftime_day,t.difftime_day_style=""):(t.difftime_style="blue",t.difftime_day_text=t.difftime_day,t.difftime_day_style=""),t.difftime_week=u.week,e.birthdayMap[t.id]=t,t}),e.birthdayData=e.birthdayData.sort(function(e,t){return e.difftime_day-t.difftime_day}),e.$ulList.empty().html($.format(e.editHtml,e.birthdayData)),$.map(n,function(e){e.difftime_day==0&&t.find(".difftime_txt").each(function(){$(this).parent().parent().attr("noteid")==e.id&&$(this).addClass("txt_red").html("今天是"+e.name+"的生日")})})):e.birthdayEmpty()},"获取生日列表数据")},post:function(e,t,n,r){$.loading.is()||($.loading(),$.ajax({url:e,type:"post",dataType:"json",data:t,success:function(e){$.loading.close(),$.isFunction(n)&&n(e)},error:function(e,t,n){$.loading.close(),$.alert(r+"时出现错误:"+t+":"+n)}}))},_sortNewBirthday:function(e,t){var n=this,r=$(this.element),i=this.options;e.remove();var s=r.find(".birthdayList li"),o=!1;for(var u=0;u<s.length;u++){var a=s.eq(u);if(a.hasClass("birth_empty")||a.hasClass("create"))continue;var f=a.attr("noteid"),l=n.birthdayMap[f].difftime_day;if(t<=l){a.before(e),o=!0;break}}o||r.find(".birthdayList").append(e)},sort:function(){this.$ulList.append(this.$ulList.find("li").toArray().sort(sortOperator))},birthdayEmpty:function(){var e=this,t=$(this.element),n=this.options;e.$ulList.find(".birth_empty").length==0&&e.$ulList.append('<li class="birth_empty"></li>');var r=e.$ulList.find("li"),i=!1;for(var s=0;s<r.length;s++){var o=r.eq(s);if(o.is(":visible")&&!o.hasClass("birth_empty")){i=!0;break}}i?e.$ulList.find(".birth_empty").hide():e.$ulList.find(".birth_empty").show()},constellation:function(e,t){var n;switch(e){case 1:t<=19?n="摩羯":n="水瓶";break;case 2:t<=18?n="水瓶":n="双鱼";break;case 3:t<=20?n="双鱼":n="白羊";break;case 4:t<=20?n="白羊":n="金牛";break;case 5:t<=20?n="金牛":n="双子";break;case 6:t<=21?n="双子":n="巨蟹";break;case 7:t<=22?n="巨蟹":n="狮子";break;case 8:t<=22?n="狮子":n="处女";break;case 9:t<=22?n="处女":n="天秤";break;case 10:t<=23?n="天秤":n="天蝎";break;case 11:t<=21?n="天蝎":n="射手";break;case 12:t<=21?n="射手":n="摩羯"}return n},difftimeDay:function(e,t,n,r){var i=this.getNextBirthdays(e,t,n,r),s=new Date;if(!i)return{};e=="L"&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0));var o=i.getTime()-s.getTime(),u={};return u.day=parseInt(o/864e5),u.year=this.difftimeYear(e,t,n,r),u.month=i.getMonth()+1,u.days=i.getDate(),u.week=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"][i.getDay()],u},getNextBirthdays:function(e,t,n,r){var i,s=new Date,o=s.getFullYear(),u=s.getMonth(),a=s.getDate();s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0),t=t=="0"?o:t;if(e=="L")if(leapMonth(t)==n&&leapDays(t)>=r)for(var f=t;f<3051;f++){i=getSolarDate(f,n,r,0);if(i.getFullYear()>s.getFullYear()||i.getFullYear()>=s.getFullYear()&&i.getMonth()>=s.getMonth()||i.getFullYear()==s.getFullYear()&&i.getMonth()==s.getMonth()&&i.getDate()>=s.getDate())break}else{var l=getSolarDate(o-1,n,r,0),c=getSolarDate(o,n,r,0),h=l.getTime()-s.getTime(),p=c.getTime()-s.getTime();h>0?t=o-1:p>=0?t=o:t=o+1;var d=getSolarDate(t,n,r,0),v=d.getMonth(),m=d.getDate();i=d}else{i=new Date,i.setMonth(n-1,r),(i.getMonth()<s.getMonth()||i.getMonth()==s.getMonth()&&i.getDate()<s.getDate())&&i.setFullYear(i.getFullYear()+1);if(n==2&&r==29)for(var f=s.getFullYear();;f++)if(f%4==0&&f%100!=0||f%400==0){i.setFullYear(f),i.setMonth(1),i.setDate(29);break}}return i},difftimeYear:function(e,t,n,r){var i,s=e=="S"?new Date(t,n-1,r):getSolarDate(t,n,r,0),o=this.getNextBirthdays(e,t,n,r);return i=o.getFullYear()-s.getFullYear(),console.log(o),console.log(s),t==0&&(i=0),i},html_encode:function(e){var t="";return e.length==0?"":(t=e.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/ /g,"&nbsp;"),t=t.replace(/\'/g,"&#39;"),t=t.replace(/\"/g,"&quot;"),t)},html_decode:function(e){var t="";return e.length==0?"":(t=e.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&nbsp;/g," "),t=t.replace(/&#39;/g,"'"),t=t.replace(/&quot;/g,'"'),t)}})}),define("rebuild/module/calendarList",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/widget/rightBubbleMenu","rebuild/widget/calendarCreator","rebuild/widget/plugin.todo","rebuild/widget/plugin.birthday"],function(e,t){var n={},r={init:function(){r.initData(),r.initLogic(),r.loadCalendarListData()},initData:function(){n.usedColors={},n.oPermissions={},n.selectedClds=null,n.selectedCld=null,n.calendarList=null,n.calendarControlData={Edit:{text:"编辑群组",onclick:"calendarCreator"},Del:{text:"退出群组",onclick:r.deleteCalendar},Only:{text:"只显示此日历",onclick:r.showOnly},RevokeGroup:{text:"退出群组",onclick:r.unsubscribe},Revoke:{text:"取消订阅",onclick:r.unsubscribe},Message:{text:"发送消息",onclick:"msgCreator"},New:{text:"新建群组",onclick:"calendarCreator"},BindGoogle:{text:"绑定Google日历",onclick:r.bindGoogle},UnbindGoogle:{text:"解除绑定："+G.googleID,onclick:r.unbindGoogle},SyneGoogle:{text:"同步Google日历",onclick:r.syneGoogle}}},initLogic:function(){var e=$(".left_create_schedule_btn");$(".my_calendar_nav").on("mouseenter",function(){e.stop(!0,!0).fadeIn("fast")}).on("mouseleave",function(){(!e.data("bubbleMenu")||!e.data("bubbleMenu").filter(":visible").size())&&e.stop(!0,!0).fadeOut("fast")}),$(".my_calendar_nav, .group_calendar_nav, .palug_nav").on("click","dt",function(e){var t=$(this).next();t.find("li").size()&&t.stop(!0,!0).slideToggle("fast")}),$(".my_calendar_nav, .group_calendar_nav").on("click","li",r.changeCurrentList).on("mouseenter","li",function(){$("a.arrow",this).stop(!0,!0).fadeIn("fast")}).on("mouseleave","li",function(){var e=$("a.arrow",this);(!e.data("bubbleMenu")||!e.data("bubbleMenu").filter(":visible").size())&&e.stop(!0,!0).fadeOut("fast")}).on("click",".arrow",r.calendarControl),$("#lnk_left_switcher").on("click",function(){$("#div_calendar_list").toggleClass("my_calendar_leftnone"),$(this).toggleClass("hidden_bg"),$(".palug_nav dd").show()}),$("#js-calendarList").on("click",".calendar_ary_btn",r.calendarNavSet),$(".selectCtrl").on("click",r.selectCtrl),$(".schedule_set_layer").on("click",function(e){e.stopPropagation()}),$(".schedule_set_layer").on("click",".save_ary",function(e){var t=0,r=[];$(".schedule_set_layer input:checkbox").each(function(e,t){var i=$(this),s=i.attr("cid"),o=i.prop("checked");o&&r.push(s),$.each(n.calendarList,function(e,t){t.id==s&&(t.selectedInAry=o)})}),$(".schedule_set_layer").fadeOut("fast"),$.cookie("selectedClds"+G.currUser.id,JSON.stringify(r||[]),{expires:365}),amplify.publish("calendarListDataGeted",n.calendarList)}),$("body").on("click",function(e){var t=$(".schedule_set_layer");t&&t.is(":visible")&&t.fadeOut("fast")}),$(".left_create_schedule_btn").on("click",r.mainCalendarControl),$("#ul_plugin_list a").calendarPlugin()},setCalendarSelectedList:function(){if($.cookie("selectedClds"+G.currUser.id)!==null)return;var e=n.calendarList,t=[];for(var r=0,i=e.length;r<i;r++)t.push(e[r].id);$.cookie("selectedClds"+G.currUser.id,JSON.stringify(t||[]),{expires:365}),amplify.publish("calendarListDataGeted",n.calendarList)},selectCtrl:function(){var e=$(".selectCtrl").hasClass("selectedAll"),t=!e;$(".schedule_set_layer input").prop("checked",t),t?$(".selectCtrl").addClass("selectedAll").html("全不选"):$(".selectCtrl").removeClass("selectedAll").html("全选")},calendarNavSet:function(e){e&&(e.preventDefault(),e.stopPropagation());var t='					<li>						<label>							<span class="schedule_set_icon" style="background:{color}"></span>							<span class="schedule_set_title" title="{title}">{title}</span>							<input type="checkbox" {checked} cid="{id}">						</label>					</li>';$(".schedule_set_layer ul").html($.format(t,$.map(n.calendarList,function(e){return e.selectedInAry?e.checked='checked="checked"':e.checked="",e}))),$(".schedule_layer").hide("fade"),$(".add_schedule_layer").hide("fade"),amplify.publish("closeRightBubbleMenu"),$(".schedule_set_layer").show("fade");var r=$(window).height()-180;$(".schedule_set_layer ul").css("max-height",r);var i=$(".schedule_set_layer input:checked").length,s=$(".schedule_set_layer input");i===s.length?$(".selectCtrl").addClass("selectedAll").html("全不选"):$(".selectCtrl").removeClass("selectedAll").html("全选")},calendarControl:function(e){e.preventDefault(),e.stopPropagation();var t=$(this),r=t.attr("isprimary")=="true",i=t.attr("cldid"),s=t.attr("datadomain"),o=n.oPermissions[i],u=t.attr("ispublic")=="true",a=[];o!=1&&o!=2&&s!="google"&&(a.push(n.calendarControlData.Edit),r||a.push(n.calendarControlData.Del)),s!="google"&&!r&&!u&&o!=3&&a.push(n.calendarControlData.RevokeGroup),s!="google"&&!r&&u&&o!=3&&a.push(n.calendarControlData.Revoke),u&&o==3&&a.push(n.calendarControlData.Message),t.rightBubbleMenu({buttons:a})},mainCalendarControl:function(e){e.preventDefault(),e.stopPropagation();var t=n.calendarControlData,r=[n.calendarControlData.New];$(".add_schedule_layer").hide("fade"),$(".schedule_set_layer").hide("fade"),G.googleID?r.push(t.UnbindGoogle,t.SyneGoogle):r.push(t.BindGoogle),$(".left_create_schedule_btn").rightBubbleMenu({buttons:r})},unsubscribe:function(){var e=$(this).attr("cldID");$.confirm("确认取消订阅这个日历吗？",{buttons:[{text:"确定",click:function(){$(this).dialog("close"),$.ajax({type:"post",url:"/main/calendarManager/revoke.do",dataType:"json",data:{calendarId:e},success:function(e){if(e.state=="wrongpass")return amplify.publish("loginTimeout");amplify.publish("calendarUnsubscribed")}})}}]})},showOnly:function(){var e=$(this).attr("cldID");self.showOnly(e)},deleteCalendar:function(){var e=$(this).attr("cldID"),t=$(this).attr("cldName");$.confirm("确定要退出该群组吗？",{buttons:[{text:"退出",click:function(){$(this).dialog("close"),$.ajax({url:"/calendar/getUserList.do",type:"post",dataType:"json",data:{calendarID:e},success:function(t){if(t.state=="wrongpass")return amplify.publish("loginTimeout");var n=t.list;if(n.length>1){for(var r=0;r<n.length;r++)if(n[r]["user_id"]+""==G.currUser.id+""){n.splice(r,1);break}n.sort(function(e,t){return parseInt(t.access_type)-parseInt(e.access_type)});for(var r=0;r<n.length;r++)n[r].nameFull=n[r].name,n[r].name.length>10&&(n[r].name=n[r].name.substr(0,10)+"..."),parseInt(n[r].access_type)==2&&(n[r].name+="（管理员）");var i=[],s='<li><a href="###" data-uid="{user_id}" data-name="{nameFull}">选择</a>{name}</li>';i.push('<div class="group_MemberList">											<div class="group_title">您需要移交群主权限后<br />才可退出群组</div>											<ul class="group_list">'),i.push($.format(s,n)),i.push("</ul></div>");var n=$(i.join("")).appendTo("body"),o=n.height();n.css("margin-top",-o/2+"px");var u=$('<div class="group_mash"></div>').appendTo("body");u.css({height:$(window).height()+"px"}),u.on("click",function(){n.remove(),u.remove()}),$(".group_list a").on("click",function(){var t=$(this),r=t.data("uid"),i=t.data("name");$.confirm("确定要移交给成员 <strong>"+i+"</strong> 吗？",{buttons:[{text:"确定",click:function(){var t=this;$.ajax({url:"/calendar/transferGroupCalendarOwner.do",type:"post",dataType:"json",data:{calendarID:e,newOwnerID:r},success:function(r){if(r.state=="wrongpass")return amplify.publish("loginTimeout");if(r.state=="same_user")return alert("您不能把权限移交给自己");if(r.state=="not_exist_user")return alert("您移交的用户不存在");if(r.state=="not_group_calendar")return alert("该日历不是一个群组日历");if(r.state=="not_group_user")return alert("您移交的用户不是该群组的成员");if(r.state=="no-access")return alert("您没有权限");n.remove(),u.remove(),amplify.publish("calendarDeleted",e),$(t).dialog("close")}})}}]})})}else $.ajax({url:"/calendar/dismissGroupCalendar.do",type:"post",dataType:"json",data:{calendarID:e},success:function(t){if(t.state=="wrongpass")return amplify.publish("loginTimeout");if(!t)return $.alert("对不起，您没有删除该日历的权限！");amplify.publish("calendarDeleted",e)}})}})}},{text:"取消",click:function(){$(this).dialog("close")}}]})},bindGoogle:function(){var e=open("http://when.365rili.com/google-account-bind-web.do","bindGoogleAnd365","width=347,height=530"),t=setInterval(function(){e.closed&&(clearInterval(t),location.reload())},100)},unbindGoogle:function(){$.confirm("确定要解除与Google帐号的绑定吗？",{buttons:[{click:function(){var e=this;$.ajax({type:"post",url:"/removeGoogleBind-web.do",success:function(t){t.state=="ok"&&(location.reload(),$(e).dialog("close"))},dataType:"json"})}}]})},syneGoogle:function(){$.loading(),$.ajax({url:"/syncGoogle-web.do",type:"post",data:{},dataType:"json",success:function(e){e.state=="ok"?location.reload():($.loading.close(),$.alert("同步出错！"))}})},changeCurrentList:function(){var e,t=null,r=!1;if(arguments[0]==="calendarListReady"){e=n.selectedCld;var i=$("#js-calendarList li");for(var s=0,o=i.length;s<o;s++){t=$(i[s]);if(t.attr("cldid")==e){t.addClass("on");break}}s>=o&&(t=i.eq(n.selectedClds.length?0:1),e=t.attr("cldid"),t.addClass("on"))}else t=$(this),n.currentList=this,t.parent().find(".on").removeClass("on"),t.addClass("on"),e=t.attr("cldid")||"1";$.cookie("selectedCalendarId"+G.currUser.id,e,{expires:365}),amplify.publish("currentListChanged",e,"currentListChanged")},checkSelectedCalendars:function(){var e=arguments[0];e==-1&&!n.selectedClds.length&&$.confirm("您尚未设置集合日历，是否进入设置界面？",{buttons:[{text:"设置",click:function(e){r.calendarNavSet(e),$(this).dialog("close")}}]})},updateListData:function(){if(arguments[1]==="currentListChanged")n.selectedCld=arguments[0];else{n.calendarList=arguments[0];var t,r;for(var i=n.calendarList.length-1;i>=0;i--)r=n.calendarList[i],t=e.rgbToHsl(r.color),r.bgc=e.hslToRgb.call(null,t[0],t[1],.96),r.sbgc=e.hslToRgb.call(null,t[0],t[1],.8);n.selectedClds=$.parseJSON($.cookie("selectedClds"+G.currUser.id)||"[]"),n.selectedCld=$.cookie("selectedCalendarId"+G.currUser.id),amplify.publish("calendarListDataUpdated",n)}},loadCalendarListData:function(){$.ajax({url:"/calendar/getCalendarListByUser.do",type:"post",dataType:"json",success:function(e){if(e.state=="wrongpass")return amplify.publish("loginTimeout");e.sort(function(e,t){var n=parseInt(e.access_type),r=parseInt(t.access_type),i=parseInt(e.id),s=parseInt(t.id);return e.is_primary=="true"&&e.data_domain!="google"?-1:t.is_primary=="true"&&t.data_domain!="google"?1:e.data_domain=="google"&&t.data_domain!="google"?-1:t.data_domain=="google"&&e.data_domain!="google"?1:n!=r?r-n:i-s}),amplify.publish("calendarListDataGeted",e),amplify.publish("allCalendarListUpdated",e)}})},renderList:function(){var i=arguments[0]&&arguments[0].calendarList||n.calendarList||t.getCalendarList(),s='				<li title="{title}" class="e_clear" cldID="{id}">					<a href="javascript:;" class="arrow {calendar_purview_icon}  none" cldID="{id}" cldName="{title}" isprimary="{is_primary}"  ispublic="{is_public}" datadomain="{data_domain}"></a>					<div class="checkbox ui-corner-all-16 iepng" cldID="{id}" cldName="{title}" lightcolor="{lightcolor}" style="border-color:{color}; background-color:{bgcolor};"></div>					<span class="my_calendar_nav_txt">{title}</span>				</li>',o=0,u=$.format(s,$.map(i,function(t,r){var i=e.rgbToHsl(t.color),s=i[0],u=i[1];return t.title=e.htmlDecode(t.title),t.lightcolor=e.hslToRgb.call(null,s,u,.7),t.bgcolor=t.lightcolor,t.selectedInAry=$.inArray(t.id,n.selectedClds)>-1?!0:!1,t.selectedInAry&&o++,t.calendar_purview_icon=t.access_type=="3"?"my_calendar_nav_set":"my_calendar_nav_set1",t.data_domain=="google"&&(t.calendar_purview_icon=""),n.oPermissions[t.id]=t.access_type,n.usedColors[String(t.color).toLowerCase()]=t,t})),a='<li class="e_clear" cldID="-1"><a href="javascript:;" class="my_calendar_nav_set calendar_ary_btn"></a><span id="sp_multi_calendar" class="my_calendar_nav_txt">集合('+o+")</span></li>";$("dl.my_calendar_nav ul").html(a+u),r.setScroll(),amplify.publish("calendarListReady","calendarListReady"),r.setCalendarSelectedList()},setScroll:function(){var e=$("dl.my_calendar_nav > dd"),t=$(window).height()-190;if(e.data("jsp"))e.is(":visible")?(e.data("jsp").reinitialise(),e.data("jsp").getContentHeight()<=t&&e.data("jsp").destroy()):e.slideToggle(function(){e.data("jsp").reinitialise(),e.data("jsp").getContentHeight()<=t&&e.data("jsp").destroy()});else{e.css("height","");var n=e.height();n>t&&(e.height(t),e.jScrollPane())}}};amplify.subscribe("initApp",r.init),amplify.subscribe("calendarListDataUpdated",r.renderList),amplify.subscribe("calendarListDataGeted",r.updateListData),amplify.subscribe("currentListChanged",r.updateListData),amplify.subscribe("currentListChanged",r.checkSelectedCalendars),amplify.subscribe("calendarListReady",r.changeCurrentList),amplify.subscribe("calendarCreated",r.loadCalendarListData),amplify.subscribe("calendarDeleted",r.loadCalendarListData),amplify.subscribe("calendarUnsubscribed",r.loadCalendarListData)}),define("rebuild/module/timeClock",["rebuild/base/common","rebuild/base/calendar_Protocol"],function(e,t){_data={mar:0,date:null},_ex={init:function(){_ex.clock()},updateGCurrDate:function(){_ex.clock(),_data.date=new Date(+G.currDate),G.currDate.setSeconds(G.currDate.getSeconds()+1),G.currDate.getDate()!==_data.date.getDate()&&amplify.publish("AcrossTheDay")},clock:function(){clearTimeout(_data.mar),_data.mar=setTimeout(_ex.updateGCurrDate,1e3)}},amplify.subscribe("initApp",_ex.init)}),define("rebuild/widget/lunarPicker",["rebuild/base/common"],function(e){$.widget("mxx.lunarPicker",{options:{yearStart:1901,yearEnd:2099,date:new Date,onChange:null},_create:function(){var e=this,t=$(this.element),n=this.options;this.dlts=t.find("select"),this.$year=this.dlts.eq(0),this.$month=this.dlts.eq(1),this.$date=this.dlts.eq(2),this.yearHtml=$.format('<option value="{value}">{text}</option>',$.map(new Array(n.yearEnd-n.yearStart+1),function(e,t){return{value:t+n.yearStart,text:t+n.yearStart+"年"}})),this.$date.change(function(){e._triggerChangeEvent()}),this.setDate(n.date)},init:function(){var e=this,t=$(this.element),n=this.options,r=this.lunarDate.sYear+1984;this.$year.empty().append(this.yearHtml.replace('"'+r+'"','"'+r+'"'+' selected="selected"')),this.$year.off("change").change(function(t){e._calYearData(),e._fillMonth(t),e._fillDate(t)}).change(),this.$month.off("change").change(function(t){e._fillDate(t)}).change()},_fillMonth:function(e){var t=this,n=$(this.element),r=this.options,i=e.isTrigger?(t.lunarDate.isLeap?"r":"")+(t.lunarDate.monthIndex+1):t.$month.val().slice(-(t.$month.val()-1));t.$month.empty().append($.format('<option idx="{INDEX}" value="{value}">{text}</option>',t.data).replace('value="'+i+'"','value="'+i+'"'+' selected="selected"')),t.$month.change()},_fillDate:function(e){var t=this,n=$(this.element),r=this.options,i=t.$month.find("option:selected").attr("idx"),s=e.isTrigger?t.lunarDate.dateIndex+1:t.$date.val();t.$date.empty().append($.format('<option date="{date}" value="{value}">{text}</option>',t.data[i].days).replace('value="'+s+'"','value="'+s+'"'+' selected="selected"')),t.$date.change()},_triggerChangeEvent:function(){var e=this,t=$(this.element),n=this.options,r=this.$date.find("option:selected");$.isFunction(n.onChange)&&n.onChange.apply(this,[r.attr("date"),this.$year.find("option:selected").text(),this.$month.find("option:selected").text(),r.text()])},_calYearData:function(){var e=this,t=$(this.element),n=this.options,r=lunar(new Date(e.$year.val(),2,1)).getMonthInfo(),i=r.solarSpringDay,s;e.data=[],$.each(r,function(t,n){s=e.data[t]={value:(n.isLeap?"r":"")+((n.index-2)%12+1),text:n.name+"月",days:[]},$.each(new Array(n.days),function(e){s.days.push({value:e+1,text:Lunar.DB.dateCn[e],date:[i.getFullYear(),i.getMonth()+1,i.getDate()].join("-")}),i.setDate(i.getDate()+1)})})},getDate:function(){var e=this,t=$(this.element),n=this.options;return new Date(this.$date.find("option:selected").attr("date").replace(/-/g,"/"))},getLunarInfo:function(){var e=this,t=$(this.element),n=this.options;return{year:this.$year.val(),month:this.$month.val(),date:this.$date.val(),cnYear:this.$year.find("option:selected").text(),cnMonth:this.$month.find("option:selected").text(),cnDate:this.$date.find("option:selected").text()}},setDate:function(e){this.date=e,this.lunarDate=lunar(this.date),this.init()}})}),define("rebuild/widget/input",["rebuild/base/common"],function(e){$.widget("mxx.input",{options:{onInput:$.noop},_create:function(){var e=this,t=$(this.element),n=this.options,r=t.val(),i=function(e){var i=$.trim(t.val());r!=i&&(n.onInput.call(t,i),r=i)};t.keyup(i).change(i).on("dropend",i)}})}),define("rebuild/widget/imageCreator",["rebuild/base/common"],function(e){$.widget("mxx.imageUpload",{options:{},_create:function(){var e=this,t=$(this.element),n=this.options;e.type=n.type,e.shouldUploadFile=!1;if(n.type=="edit")t.append('<a href="javascript:;" class="del_photo"></a><img src="'+n.image+'"/>'),e.filename=n.filename;else{var r=n.iframeName,i='<form action="http://v0.api.upyun.com/" method="post" return_url="/upyun/callback.html" enctype="Multipart/form-data" class="upload_form" target="'+r+'">'+'<input type="hidden" name="policy"    value="" class="form_policy">'+'<input type="hidden" name="signature" value="" class="form_signature">'+'<input type="file"   name="file" class="upload_input" style="" />'+'<a href="javascript:;" class="upload_input_link"></a>'+"</form>"+'<iframe name="'+r+'" style="display:none;"></iframe>';t.append('<div class="image_block_none"><a href="javascript:;" class="del_photo"></a><img/></div>'),t.append(i);var s=t.find(".upload_input"),o=t.find(".upload_form");e.form=o,e.input=s,s.change(function(){if(!s[0].files){$.alert("您的浏览器不支持图片上传功能，建议您使用chrome,firefox或者双核浏览器的高速模式");return}var n=s[0].files[0].size;if(n>512e3)return $.alert("上传文件大小超过500k，请压缩后重新上传"),e.shouldUploadFile=!1,!1;var r=/image.*/;if($.support.filereader||!this.files.length)return;var i=this.files[0],o=new FileReader;if(!r.test(i.type))return $.alert("请上传图片类型的文件"),e.shouldUploadFile=!1,!1;o.onload=function(e){t.find("img").attr("src",e.target.result)},o.readAsDataURL(i),e.type="add",e.shouldUploadFile=!0,t.find(".image_block_none").show(),t.find(".upload_input").hide(),t.find(".upload_input_link").hide(),$("#image_upload_container").imageCreator("addImageBlock");return})}t.find(".del_photo").click(function(){e.type="delete",e.shouldUploadFile=!1,t.hide(),$("#image_upload_container").imageCreator("deleteImageBlock")})},_init:function(){var e=this,t=$(this.element),n=this.options},getShouldUpload:function(){var e=this,t=$(this.element),n=this.options;return e.shouldUploadFile},showFileDialog:function(){var e=this,t=$(this.element),n=this.options;e.input.trigger("click")},uploadImage:function(e){var t=this,n=$(this.element),r=this.options;t.form.attr("action","//v0.api.upyun.com/"+e.bucket),t.form.find(".form_policy").val(e.policy),t.form.find(".form_signature").val(e.signature),t.input[0].files[0].name=e.filename,t.form.submit(),t.shouldUploadFile=!1,t.filename=e.filename},getFilename:function(){var e=this,t=$(this.element),n=this.options;return{filename:e.filename,type:e.type,shouldUploadFile:e.shouldUploadFile}}}),$.widget("mxx.imageCreator",{options:{},_create:function(){var e=this,t=$(this.element),n=this.options,r='<a href="javascript:;" class="close_btn js_close"></a><h2>本地上传</h2><div class="add_photo_content"><p id="image_upload_tip">共0张，还能上传9张</p><ul id="image_upload_container_ul"></ul></div>';t.html(r),t.draggable({containment:"body",handle:"h2",cancel:"a",cursor:"move",opacity:.85}),t.find("a.js_close").click(function(){t.hide("fade")}),e.saveSchedule=n.saveSchedule},_init:function(){var e=this,t=$(this.element),n=this.options;e.newImageIndex=0,e.imageCount=0;var r=t.find("#image_upload_container_ul");r.empty();if(n.pics){for(var i in n.pics){var s=n.pics[i],o=$('<li class="image_block"></li>').appendTo(r);o.imageUpload({image:n.pic_url+s.pic,type:"edit",filename:s.pic})}e.imageCount=n.pics.length}e.addImageBlock(),t.hide()},addImageBlock:function(){var e=this,t=$(this.element),n=this.options,r=t.find("#image_upload_container");e.currentImage=$('<li class="image_block"></li>'),e.currentImage.imageUpload({type:"none",iframeName:"image_upload_form_"+e.newImageIndex}),e.newImageIndex++,e.imageCount++,t.find("#image_upload_container_ul").append(e.currentImage),e.imageCount==10&&e.currentImage.hide(),e._showCount()},deleteImageBlock:function(){var e=this,t=$(this.element),n=this.options;e.imageCount--,e.imageCount<10&&e.currentImage.show(),e._showCount()},_showCount:function(){var e=this,t=$(this.element),n=this.options,r=e.imageCount-1,i=10-e.imageCount;t.find("#image_upload_tip").html("共"+r+"张，还能上传"+i+"张")},show:function(e){var t=this,n=$(this.element),r=this.options;n.show().css({left:"650px",top:e+"px"})},shouldUploadImage:function(){var e=this,t=$(this.element),n=this.options,r=t.find(".image_block");for(var i=0;i<r.length;i++){var s=r.eq(i);if(s.imageUpload("getShouldUpload"))return!0}return!1},uploadImage:function(){var e=this,t=$(this.element),n=this.options,r=t.find(".image_block");e.shouldUploadBlocks=[],e.callbackCount=0;for(var i=0;i<r.length;i++){var s=r.eq(i);s.imageUpload("getShouldUpload")&&e.shouldUploadBlocks.push(s)}e.shouldUploadBlocks.length>0&&$.ajax({url:"/schedule/signatures.do",type:"post",data:{fileCount:e.shouldUploadBlocks.length},dataType:"json",success:function(t){for(var n in t.signatures)e.shouldUploadBlocks[n].imageUpload("uploadImage",t.signatures[n])}})},getImageList:function(){var e=this,t=$(this.element),n=this.options,r=t.find(".image_block"),i=[],s=1;for(var o=0;o<r.length;o++){var u=r.eq(o),a=u.imageUpload("getFilename");a.type!="delete"&&a.type!="none"&&!a.shouldUploadFile&&i.push({pic:a.filename,sequence:s++,source:"schedule_pics"})}return i},imageUploadCallback:function(){var e=this,t=$(this.element),n=this.options;e.callbackCount++,e.callbackCount==e.shouldUploadBlocks.length&&e.saveSchedule()}}),window.upyun_callback=function(e,t,n){e=="200"&&t=="ok"?$("#image_upload_container").imageCreator("imageUploadCallback"):$.alert("上传图片失败")}}),define("rebuild/widget/scheduleCreator",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/widget/lunarPicker","rebuild/widget/input","rebuild/widget/loading","rebuild/widget/imageCreator"],function(e,t){function r(){amplify.publish("scheduleClosed")}function i(e,t){e&&e!=""?amplify.publish("scheduleUpdated",t):amplify.publish("scheduleCreated",t)}function s(){amplify.publish("alarmChanged")}function u(){if(!o){var n='<div id="div_add_schedule" class="add_schedule_layer complete ui-shadow none"><!--complete simple--><a href="javascript:;" class="close_btn js_close"></a><h2></h2><div class="add_schedule_content e_clear"><form><input type="hidden" name="scheduleId" value=""/><div class="createInput"><dl class="e_clear"><dt>内容：</dt><dd><textarea name="schTitle" placeholder="这里填写你的日程内容"></textarea></dd></dl></div><div class="createRight"><dl class="e_clear"><dt style="margin-top:25px;">开始时间:</dt><dd><div class="timetype"><label><input type="checkbox" name="alldayEvent" checked="checked"/><span>全天</span></label><label><input type="checkbox" name="chk_lunar"/><span>农历</span></label></div><div class="data_box "><ul class="js_datepicker" style="float:left;"><li><input type="text" name="startTime"/></li><li class="none js_lunarPicker"><select name="dlt_from_year"></select><select name="dlt_from_month"></select><select name="dlt_from_date"></select></li></ul>&nbsp;<div class="hour js_time none"><select name="dlt_start_hour"><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09" selected="selected">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><span>时</span><select name="dlt_start_minute"><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select><span>分</span></div></div></dd></dl><dl class="e_clear"><dt>结束时间:</dt><dd class="end_time"><ul class="end_time_ul" style="float:left;"><li><input type="text" name="endTime"/></li><li class="endTime_lunarPicker none"><select name="dlt_from_year"></select><select name="dlt_from_month"></select><select name="dlt_from_date"></select></li></ul><div class="hour js_time"><select name="dlt_end_hour"><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09" selected="selected">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option></select><span>时</span><select name="dlt_end_minute"><option value="00">00</option><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option></select><span>分</span></div></dd></dl><div class="complete_time_calender"><dl class="e_clear"><dt>日历：</dt><dd><select name="calendarId"></select></dd></dl></div><div class="complete_content"><div class="complete_set s-no"><dl class="e_clear"><dt>添加图片：</dt><dd><a href="javascript:void(0)" class="upload_image_link">本地上传</a><ddd id="image_thumb"></ddd></dd></dl><dl class="e_clear"><dt>备注：</dt><dd><textarea name="schDescription" maxlength="3000"></textarea></dd></dl><dl class="st1 e_clear"><dt>重复类型：</dt><dd><select><option mode="s-no" value="0">不重复</option><option mode="s-dy" value="1">按天</option><option mode="s-w" value="7">按周</option><option mode="s-m" value="31">按月</option><option mode="s-dy" value="365">按年</option><option mode="s-dwd" value="5">法定工作日</option></select></dd></dl><dl class="st2 e_clear"><dt>重复类型：</dt><dd><select><option mode="l-no" value="0">不重复</option><option mode="l-my" value="29">农历每月</option><option mode="l-my" value="354">农历每年</option></select></dd></dl><dl class="st3 e_clear"><dt>重复频率：</dt><dd>每<select name="repeatFrequency"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option></select><span class="js_rp_unit">周</span></dd></dl><dl class="st4 e_clear"><dt>重复时间：</dt><dd class="repetition_time js_rp_month"><label><input type="radio" name="rdo_repeat" checked="checked" value="month"/><span>一个月的某一天</span></label><label><input type="radio" name="rdo_repeat" value="week"/><span>一周的某一天</span></label></dd></dl><dl class="st5 e_clear"><dt>重复时间：</dt><dd class="repetition_time js_rp_week"><label><input type="checkbox" name="chk_rp_week" day="一" value="MON"/><span>一</span></label><label><input type="checkbox" name="chk_rp_week" day="二" value="TUE"/><span>二</span></label><label><input type="checkbox" name="chk_rp_week" day="三" value="WED"/><span>三</span></label><label><input type="checkbox" name="chk_rp_week" day="四" value="THU"/><span>四</span></label><label><input type="checkbox" name="chk_rp_week" day="五" value="FRI"/><span>五</span></label><label><input type="checkbox" name="chk_rp_week" day="六" value="SAT"/><span>六</span></label><label><input type="checkbox" name="chk_rp_week" day="日" value="SUN"/><span>日</span></label>&nbsp;<a href="javascript:;" class="js-work-day" title="只选择工作日">工作日</a>&nbsp;<a href="javascript:;" class="js-rest-day" title="只选择双休日">双休日</a></dd></dl><dl class="st6 e_clear"><dt>结束条件：</dt><dd class="end_data"><ul><li><label><input type="radio" name="rdo_repeat_cond" value="never" checked="checked"/><span>从不</span></label></li><li><label><input type="radio" name="rdo_repeat_cond" value="times" id="rdo_repeat_cond_1"/><span>发生</span></label><input type="text" class="end_data_text1" name="repeatCount" value="20"/><label for="rdo_repeat_cond_1"><span>次后</span></label></li><li><label><input type="radio" name="rdo_repeat_cond" value="date"/><span>在</span></label><input type="text" name="repeatStopTime" class="end_data_text2"/></li></ul></dd></dl><dl class="st7 e_clear"><dt>摘要：</dt><dd class="summary"></dd></dl><dl class="remind e_clear"><dt>提醒设置：</dt><dd><label class="remind_0"><input type="checkbox" value="0"/><span>正点</span></label><label class="remind_5"><input type="checkbox" value="5"/><span>5分前</span></label><label class="remind_10"><input type="checkbox" value="10"/><span>10分前</span></label><label class="remind_30"><input type="checkbox" value="30"/><span>30分前</span></label><label class="remind_60"><input type="checkbox" value="60"/><span>1小时前</span></label><label class="remind_today"><input type="checkbox" value="0"/><span>当天</span></label><label class="remind_1440"><input type="checkbox" value="1440"/><span>1天前</span></label><label class="remind_4320"><input type="checkbox" value="4320"/><span>3天前</span></label></dd></dl><dl class="e_clear"><dt>关联URL：</dt><dd><input type="text" size="50" name="linked_url"/></dd></dl><dl class="e_clear"><dt>地址：</dt><dd><input type="text" size="50" name="location"/><a class="js_map_address" href="javascript:void(0)">在地图上标记</a></dd></dl></div></div></form></div></div><div class="add_schedule_bottom"><a href="javascript:;" class="giveup_schedule_btn js_close">放弃</a><a href="javascript:;" class="create_schedule_btn js_save">保存</a><a href="javascript:;" class="simple_more">详细设置</a><div class="layer_arrow"><em class="arrow_1 ui-shadow"></em><em class="arrow_2 ui-shadow"></em><em class="arrow_3 ui-shadow"></em><em class="arrow_4 ui-shadow"></em><em class="arrow_5 ui-shadow"></em><em class="arrow_6 ui-shadow"></em><em class="arrow_7 ui-shadow"></em><em class="arrow_8 ui-shadow"></em><em class="arrow_9 ui-shadow"></em><em class="arrow_10 ui-shadow"></em><em class="arrow_11 ui-shadow"></em><em class="arrow_12 ui-shadow"></em></div></div></div>';o=$(n).appendTo("body"),o.find(":input[name]").each(function(){var e=$(this),t=e.attr("name");o[t]=o[t]?o[t].add(e):e}),o.summary=o.find("dd.summary"),o.liLunarPicker=o.find("li.js_lunarPicker"),o.endTimeLunarPicker=o.find("li.endTime_lunarPicker"),o.complete_set=o.find("div.complete_set"),o.btnSave=o.find("a.js_save"),o.mapAddressBtn=o.find("a.js_map_address");var i="s-no s-dy s-m s-w l-no l-my s-t s-dwd";o.draggable({containment:"body",handle:"h2",cancel:"a",cursor:"move",opacity:.85,drag:function(){if(o.hasClass("simple")){var e=$("#div_calendar_panel table.calendar_table"),t=e.position(),n=o.find("div.layer_arrow em:last").offset();n.top-=t.top,n.left-=t.left;if(n.top>=0&&n.left>=0){var r=e.width(),i=e.height(),s=Math.floor(r/7),u=Math.floor(i/6),a=Math.floor(n.left/s),f=Math.floor(n.top/u),l=e.find("td").eq(f*7+a),c=l.attr("date");o.startTime.datepicker("setDate",c)}}}}),o.find("a.js_close").click(function(){o.hide("fade"),$("#image_upload_container").hide("fade"),o.removeData("fromTd"),r()}),$("#div_calendar_list").add("#div_today").click(function(e){e.target.id!==o.attr("id")&&!$.contains(o[0],e.target)&&o.is(":visible")&&(o.hide("fade"),$("#image_upload_container").hide("fade"),o.removeData("fromTd"),r())}),o.alldayEvent.click(function(e){o.find("div.js_time")[this.checked?"addClass":"removeClass"]("none"),o.find("dl.remind")[this.checked?"addClass":"removeClass"]("rToday"),this.checked?(o.dlt_start_hour.val("09"),o.dlt_start_minute.val("00"),o.dlt_end_hour.val("10"),o.dlt_end_minute.val("00"),o.find(".remind_5 input").attr("checked",!1),o.find(".remind_10 input").attr("checked",!1),o.find(".remind_30 input").attr("checked",!1),o.find(".remind_60 input").attr("checked",!1),o.find(".remind_0 input").attr("checked")=="checked"&&o.find(".remind_today input").attr("checked","checked")):o.find(".remind_today input").attr("checked")=="checked"&&o.find(".remind_0 input").attr("checked","checked"),a()}),o.find(".upload_image_link").click(function(){o.css("left","100px"),$("#image_upload_container").imageCreator("show",o.position().top)}),o.find(".complete_time_calender select").change(function(){var e=$(this).val(),n=t.getPublic(e);n=="true"?(o.find(".remind").addClass("none"),o.find(".remind_today input").attr("checked",!1)):(o.find(".remind").removeClass("none"),o.find(".remind_today input").attr("checked","checked"))}),o.chk_lunar.click(function(t){var n=o.find("ul.js_datepicker li").hide().eq(+this.checked).show(),r=o.find("ul.end_time_ul li").hide().eq(+this.checked).show();if(this.checked){var s=n.find("select"),u=e.formatDate(o.startTime.datepicker("getDate")),f=new Date(u.replace(/-/g,"/"));o.liLunarPicker.lunarPicker("setDate",f);var l=e.formatDate(o.endTime.datepicker("getDate")),c=new Date(l.replace(/-/g,"/"));o.endTimeLunarPicker.lunarPicker("setDate",c)}else o.startTime.datepicker("setDate",o.liLunarPicker.lunarPicker("getDate")),o.endTime.datepicker("setDate",o.endTimeLunarPicker.lunarPicker("getDate"));var h=o.complete_set.removeClass(i);h.find("dl select").eq(+this.checked).change(),a()}),o.complete_set.find("dl.st1 select, dl.st2 select").change(function(){var e=$("option:selected",this),t=e.attr("mode"),n=e.text();o.complete_set.removeClass(i).addClass(t),"年月周天".indexOf(n=n.charAt(n.length-1))>-1&&o.find("span.js_rp_unit").text(n),a()}),o.chk_rp_week.click(function(){a()}),o.rdo_repeat.click(function(){a()}),o.repeatFrequency.change(function(){a()}),o.liLunarPicker.lunarPicker({onChange:function(e,t,n,r){o.startTime.datepicker("setDate",e),a()}}),o.endTimeLunarPicker.lunarPicker({onChange:function(e,t,n,r){o.endTime.datepicker("setDate",e),a()}}),o.startTime.add(o.repeatStopTime).add(o.endTime).datepicker($.getDPOptions({onSelect:function(e,t){if(t.input[0].name=="startTime"){var n=o.startTime.datepicker("getDate"),r=o.endTime.datepicker("getDate"),i=r.getTime()-n.getTime();i<0&&o.endTime.datepicker("setDate",n)}a()}})),o.dlt_start_hour.change(function(){d()<0&&o.dlt_end_hour.val($(this).val())}),o.dlt_start_minute.change(function(){d()<0&&o.dlt_end_minute.val($(this).val())}),o.repeatCount.input({onInput:function(e){e=parseInt(e.replace(/\D/g,""))||0,e>999&&(e=999),e!==0?o.repeatCount.val(e):o.repeatCount.val(""),a()}}),o.repeatCount.blur(function(){var e=o.repeatCount.val();e===""&&(o.repeatCount.val(20),a())}),o.rdo_repeat_cond.click(function(){$(this).parents("li").find('input[type="text"]').focus().select(),a()}),o.find("a.simple_more").click(function(e){e.preventDefault(),o.removeClass("simple").addClass("complete").position({of:"body"}),o.schTitle.focus()}),o.find("a.js-work-day, a.js-rest-day").click(function(e){e.preventDefault(),o.chk_rp_week.attr("checked",!1),($(this).hasClass("js-work-day")?o.chk_rp_week.slice(0,5):o.chk_rp_week.slice(-2)).attr("checked",!0),a()}),o.btnSave.loading(),o.saving=!1,o.btnSave.click(function(e){if(e.isImmediatePropagationStopped()||o.saving)return!1;e.preventDefault(),f()})}window.setMapLocation=function(e,t,n){$("#baidu_map_div").remove(),o.location.val(e+"@"+t+","+n)},window.closeMapLocation=function(){$("#baidu_map_div").remove()},o.mapAddressBtn.click(function(){var e=$("#baidu_map_div");e[0]||(e=$("<div id='baidu_map_div'><iframe src='/baidumap.html'></iframe></div>").appendTo("body"));var t=$.trim(o.location.val());t==""?e.find("iframe").attr("src","/baidumap.html"):(t=t.split("@")[0],e.find("iframe").attr("src","/baidumap.html?address="+t)),e.show()}),o.calendarId.html($.map(t.getAllCalendarNames(!0),function(e){return'<option value="'+e.id+'">'+e.name+"</option>"}).join(""));var s=t.getCalendarListSelectedCld()[0],u=t.getPublic(s);return u=="true"?(o.find(".remind").addClass("none"),o.find(".remind_today input").attr("checked",!1)):(o.find(".remind").removeClass("none"),o.find(".remind_today input").attr("checked","checked")),o}function a(){var t=[],n=o.complete_set.find("dl select:visible").val()-0;if(n){var r=o.chk_lunar.get(0).checked;t.push(r?"农历":"公历");var i=o.repeatFrequency.val()-0,s={1:"天",7:"周",29:"月",31:"月",354:"年",365:"年",5:"法定工作日"}[n];n!=5?t.push((i==1?"每":"每隔"+i)+s):t.push(s);if(n==7){var u=o.chk_rp_week.filter(":checked").map(function(){return $(this).attr("day")}).get();u.length&&t.push("周"+u.join("、"))}else if(n==31){var a=o.rdo_repeat.filter(":checked").val(),f=o.startTime.datepicker("getDate"),l=e.formatDate(f);a=="month"?t.push("每月第"+f.getDate()+"天"):t.push("第"+Math.ceil(f.getDate()/7)+"个周"+"日一二三四五六".split("")[f.getDay()])}else if(n==365){var f=o.startTime.datepicker("getDate"),l=e.formatDate(f);t.push("在"+(f.getMonth()+1)+"月"+f.getDate()+"日")}else if(n==29){var c=o.liLunarPicker.lunarPicker("getLunarInfo");t.push(c.cnDate)}else if(n==354){var c=o.liLunarPicker.lunarPicker("getLunarInfo");t.push(c.cnMonth+c.cnDate)}var h=o.rdo_repeat_cond.filter(":checked"),p=h.val();p=="date"?t.push("直到"+o.repeatStopTime.val()+"结束"):p=="times"?t.push("重复"+o.repeatCount.val()+"次后结束"):t.push("永不结束"),o.summary.html($.map(t,function(e){return["<span>",e,"</span>"].join("")}).join(""))}}function f(){var n=o.hasClass("simple"),r={schTitle:$.trim(o.schTitle.val()),alldayEvent:o.alldayEvent.is(":checked"),calendarId:o.calendarId.val(),startTime:[o.chk_lunar.is(":checked")?e.formatDate(o.liLunarPicker.lunarPicker("getDate")):e.formatDate(o.startTime.datepicker("getDate"))," ",o.dlt_start_hour.val(),":",o.dlt_start_minute.val(),":00"].join(""),timeZone:-(new Date).getTimezoneOffset()/60,duration:d()};if(!r.schTitle){$.alert("请输入日程内容",{buttons:{"确定":function(){$(this).dialog("close"),o.schTitle.focus()}}});return}if(r.schTitle.length>1e3){$.alert("日程内容字数不能超过1000，超出"+(r.schTitle.length-1e3)+"字",{buttons:{"确定":function(){$(this).dialog("close"),o.schTitle.focus()}}});return}if(r.duration<0){$.alert("结束时间不能晚于开始时间",{buttons:{"确定":function(){$(this).dialog("close")}}});return}r.description=$.trim(o.schDescription.val());if(r.description.length>3e3){$.alert("日程备注字数不能超过3000，超出"+(r.description.length-3e3)+"字",{buttons:{"确定":function(){$(this).dialog("close"),o.schDescription.focus()}}});return}var u=[];o.find(".remind label").each(function(){var e=$(this),t=e.find("input"),n=e.find("input").val();if(!e.is(":visible"))return;t.attr("checked")&&u.push(n)});if(!n){var a=o.complete_set.find("dl select:visible").val()-0,f=t.getDateRange(),l={repeatType:a,calendarType:o.chk_lunar.is(":checked")?"L":"S",before_minutes:u.join(","),fromDate:f.from,toDate:f.to,repeatCount:"",repeatDay:"",repeatFrequency:"",repeatMonth:"",repeatMonthDay:"",repeatStopTime:"",scheduleId:o.scheduleId.val()};if(a!=0){l.repeatFrequency=o.repeatFrequency.val();var c=o.rdo_repeat_cond.filter(":checked"),h=c.val();if(h=="date"){var p=o.repeatStopTime.val();if(!p||!/^\d{4}-\d{2}-\d{2}$/.test(p)){o.repeatStopTime.val(""),$.alert("请选择结束日期",{buttons:{"确定":function(){$(this).dialog("close"),o.repeatStopTime.focus()}}});return}l.repeatStopTime=p+" 00:00:00"}else if(h=="times"){var p=parseInt(o.repeatCount.val());if(isNaN(p)){$.alert("请选择结束次数",{buttons:{"确定":function(){$(this).dialog("close"),o.repeatCount.val(20).focus().select()}}});return}l.repeatCount=p}}var v=$.trim(o.linked_url.val());if(!/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/.test(v)&&v!==""){$.alert("系统不支持您输入的url地址，请重新输入",{buttons:{"确定":function(){$(this).dialog("close"),o.linked_url.focus().select()}}});return}l.linked_url=v,l.location=$.trim(o.location.val());switch(a){case 7:l.repeatDay=o.chk_rp_week.filter(":checked").map(function(){return $(this).val()}).get().join(":");if(!l.repeatDay){$.alert("请选择重复时间",{buttons:{"确定":function(){$(this).dialog("close")}}});return}break;case 31:var m=o.rdo_repeat.filter(":checked").val(),g=o.startTime.datepicker("getDate");m=="month"?l.repeatMonthDay=g.getDate():l.repeatDay=Math.ceil(g.getDate()/7)+"SUN MON TUE WED THU FRI SAT".split(" ")[g.getDay()];break;case 365:var g=o.startTime.datepicker("getDate");l.repeatMonth=g.getMonth(),l.repeatMonthDay=g.getDate();break;case 29:l.repeatMonthDay=o.liLunarPicker.lunarPicker("getLunarInfo").date;break;case 354:var g=o.startTime.datepicker("getDate"),y=lunar(g);l.repeatMonth=y.monthIndex,l.repeatMonthDay=y.dateIndex+1;break;default:}r=$.extend(r,l)}else{var f=t.getDateRange();r=$.extend(r,{repeatType:0,calendarType:"S",before_minutes:"",fromDate:f.from,toDate:f.to,repeatCount:"",repeatDay:"",repeatFrequency:"",repeatMonth:"",repeatMonthDay:"",repeatStopTime:"",scheduleId:"",location:"",linked_url:""})}o.saving=!0,o.btnSave.loading("is")||o.btnSave.loading("start");if(!n){if($("#image_upload_container").imageCreator("shouldUploadImage")){$("#image_upload_container").imageCreator("uploadImage");return}var b=$("#image_upload_container").imageCreator("getImageList");b.length>0&&(r.pics=JSON.stringify(b))}r.updateV2Origin="13",$.ajax({url:"/schedule/updateV2.do",type:"post",dataType:"json",data:r,success:function(e){o.btnSave.loading("end"),o.find(":input").attr("disabled",!1);if(e.state=="ok"){o.hide("fade",function(){o.saving=!1}),$("#image_upload_container").hide("fade"),i(r.scheduleId,e),r.before_minutes&&r.before_minutes!=""&&s();var t=[];e.emailList&&t.push("发送邮件提醒给("+e.emailList+")"),e.weiboList&&t.push("发送微博提醒给("+e.weiboList+")"),t.length&&(t.unshift("您的一些小组日历成员还没有注册365日历，<br/>需要通过如下方式通知TA们这条日程吗？"),$.confirm(t.join("<br/>"),{width:400,buttons:[{text:"通知",click:function(){var t=this;$.ajax({type:"post",data:{cid:e.cid,scheduleId:e.schlist[0].id},url:"/schedule/sendNotice.do",success:function(e){e.state=="ok"?$.alert("发送提醒成功！",{buttons:{"确定":function(){$(t).dialog("close"),$(this).dialog("close")}}}):$.alert("发送提醒失败！")},dataType:"json"})}},{text:"取消",click:function(){$(this).dialog("close")}}]}));try{js365.runScriptDeskWnd('$("#div_calendar").webCalendar()')}catch(n){}}else e.state=="wrongpass"?$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}}):(o.btnSave.loading("end"),o.saving=!1)},error:function(e){o.btnSave.loading("end"),o.saving=!1}})}function l(e,t,r,i,s){amplify.publish("createSchedule"),$(".schedule_set_layer").hide("fade"),$(".schedule_list_layer").hide("fade"),amplify.publish("closeRightBubbleMenu"),$(".schedule_layer").removeData("lastTip").hide("fade"),n.$form=u(),$("#image_upload_container").length==0&&$("body").append('<div id="image_upload_container" class="add_photo_layer ui-shadow ui-draggable none"></div>'),$("#image_upload_container").imageCreator({saveSchedule:f,pics:[]}),o.find("#image_thumb").empty();if(t)n.$form.hasClass("simple")&&n.$form.removeClass("simple").addClass("complete"),n.$form.is(":visible")||n.$form.show().position(n.auto?{of:"body",my:"right",at:"left",offset:"-20"}:{of:"body"});else if(!r||r.size()>1){var a=h(r,s);if(!a)return $.alert("对不起，365日历暂不支持将您的选择创建为单个日程，请分别创建。");n.$form.hasClass("simple")&&n.$form.removeClass("simple").addClass("complete"),n.$form.is(":visible")||n.$form.show().position({of:"body"})}else{var l=r.prop("rowInex"),p=r.prop("cellIndex");n.$form.find("div.add_schedule_bottom")[p<2?"addClass":"removeClass"]("schedule_arrow_left"),n.$form.removeClass("complete").addClass("simple").show().position({collision:"fit",my:p<2?"left middle":"right middle",at:p<2?"right middle":"left middle",of:r}),n.$form.data("fromTd",r)}c(t,a,i,e)}function c(e,r,i,s){e?(n.$form.find("h2").html("编辑日程"),$.ajax({url:"/schedule/getRawScheduleByIdV2.do",type:"post",data:{scheduleId:e},success:function(e){if(!e){$.alert("对不起，该日程已被删除，请您刷新页面！",{buttons:{"确定":function(){window.location.reload()}}});return}if(e.state=="wrongpass")return amplify.publish("loginTimeout");p(e),$.ajax({url:"/schedule/getpics.do",type:"post",dataType:"json",data:{calendarID:e.calendarId,scheduleUUID:e.uuid},success:function(e){e.state=="ok"&&($("#image_upload_container").imageCreator({saveSchedule:f,pics:e.pics,pic_url:e.pic_url}),o.find("#image_thumb").html($.map(e.pics,function(t,n){return"<img src='"+e.pic_url+t.pic+"' style='width:32px;height:32px;margin-left:5px;'/>"}).join("")))}})},error:function(){},dataType:"json"})):(n.$form.find("h2").html("添加日程"),p($.extend({title:i?i:"",id:"",allDayEvent:!0,calendarType:"S",startTime:+(new Date(s.replace(/-/g,"/")+" 09:00:00")),before_minutes:"0",repeatType:0,calendarId:t.getCalendarListSelectedCld()[0]||n.$form.calendarId.find("option:first").attr("value"),scheduleId:""},r)))}function h(e,t){if(!e||e.size()==1)return{repeatType:0};var n=[];$.each(t,function(e,t){e=t.getDate(),e!=n[0]&&n.push(e)});if(n.length==1)return{repeatType:31,repeatFrequency:1,repeatCount:t.length};var r=$.map(t,function(e,t){return e.getDay()});if(/^(\d+?)\1+$/.test(r.join(""))){var i=RegExp.$1.split(""),s="SUN MON TUE WED THU FRI SAT".split(" ");i=$.map(i,function(e){return s[e]}),n=[];for(var o=0,u=i.length,a=t.length/u;o<a;o++)n.push(+t[o*u]);if($.isProgression(n))return{repeatType:7,repeatFrequency:(n[1]-n[0])/6048e5,repeatDay:i.join(":"),repeatCount:r.length}}return n=$.map(t,function(e,t){return+e}),$.isProgression(n)?{repeatType:1,repeatFrequency:(n[1]-n[0])/864e5,repeatCount:n.length}:null}function p(t){t.url&&(t.url=t.url);var r=n.$form,i=r.complete_set.find("dl select");if(t.id!==undefined){r.scheduleId.val(t.id),r.schTitle.val(e.htmlDecode(t.title)),r.alldayEvent.attr("checked",t.allDayEvent).triggerHandler("click");var s=new Date(t.startTime),o=new Date(t.startTime);r.startTime.datepicker("setDate",s),r.endTime.datepicker("setDate",o),r.chk_lunar.attr("checked",t.calendarType=="L").triggerHandler("click"),r.dlt_start_hour.val(("0"+s.getHours()).slice(-2)),r.dlt_start_minute.val(("0"+s.getMinutes()).slice(-2)),t.id!==""&&(r.dlt_end_hour.val(("0"+o.getHours()).slice(-2)),r.dlt_end_minute.val(("0"+o.getMinutes()).slice(-2))),t.calendarType=="L"?(r.liLunarPicker.lunarPicker("setDate",s),r.endTimeLunarPicker.lunarPicker("setDate",o),i=i.eq(1)):(r.startTime.datepicker("setDate",s),r.endTime.datepicker("setDate",o),i=i.eq(0)),i.val(t.repeatType),r.calendarId.val(t.calendarId),t.repeatType!=0&&(r.repeatFrequency.val(t.repeatFrequency),t.repeatStopTime?(r.rdo_repeat_cond.eq(2).attr("checked",!0),r.repeatStopTime.val(e.formatDate(new Date(t.repeatStopTime)))):t.repeatCount?(r.rdo_repeat_cond.eq(1).attr("checked",!0),r.repeatCount.val(t.repeatCount)):r.rdo_repeat_cond.eq(0).attr("checked",!0));if(t.duration>0){var o=new Date(s.getTime()+t.duration*1e3);r.endTime.datepicker("setDate",o),r.endTimeLunarPicker.lunarPicker("setDate",o),r.dlt_end_hour.val(("0"+o.getHours()).slice(-2)),r.dlt_end_minute.val(("0"+o.getMinutes()).slice(-2))}switch(t.repeatType){case 7:r.chk_rp_week.each(function(e,n){n=$(this),n.attr("checked",t.repeatDay.indexOf(n.val())>-1)});break;case 31:r.rdo_repeat.eq(!!t.repeatDay).attr("checked",!0).click();break;default:}r.linked_url.val(t.url||""),r.location.val(t.location||""),t.description!=null&&t.description!=""&&typeof t.description!="undefined"?r.schDescription.val(t.description):r.schDescription.val("")}r.find(".remind label input").attr("checked",!1);if(t.alarm!==undefined){if(t.alarm!=""){var u=t.alarm.split(",");for(var a=0;a<u.length;a++){var f=u[a];r.find(".remind_"+f+" input").attr("checked","checked"),f==0&&r.find(".remind_today input").attr("checked","checked")}}}else t.id==""&&(r.find(".remind_today input").attr("checked","checked"),r.find(".remind_0 input").attr("checked","checked"));r.schTitle.focus(),i.change(),this.auto&&(this.onBeforeSave.call(this,r),r.find(":input").attr("disabled",!0),r.btnSave.click(),this.auto=!1,this.onBeforeSave=$.noop)}function d(){var t=0,n=o.chk_lunar.is(":checked")?o.liLunarPicker.lunarPicker("getDate"):o.startTime.datepicker("getDate"),r=o.chk_lunar.is(":checked")?o.endTimeLunarPicker.lunarPicker("getDate"):o.endTime.datepicker("getDate");o.alldayEvent.is(":checked")?(n=e.formatDate(n)+" 09:00:00",r=e.formatDate(r)+" 09:00:00"):(n=[e.formatDate(n)," ",o.dlt_start_hour.val(),":",o.dlt_start_minute.val(),":00"].join(""),r=[e.formatDate(r)," ",o.dlt_end_hour.val(),":",o.dlt_end_minute.val(),":00"].join(""));var i=new Date(n.replace(/-/g,"/")),s=new Date(r.replace(/-/g,"/"));return t=(s.getTime()-i.getTime())/1e3,t}amplify.subscribe("openSchedule",function(){if(!o)return;o.hide("fade"),$("#image_upload_container").hide("fade"),o.removeData("fromTd"),r()});var n={},o;return n.showForm=l,n}),define("rebuild/widget/scheduleCopy",["rebuild/base/common","rebuild/base/calendar_Protocol"],function(e,t){function r(e){amplify.publish("scheduleCreated",e)}function i(){amplify.publish("alarmChanged")}var n={};return n.showForm=function(e){$(".schedule_set_layer").hide("fade"),$(".schedule_layer").removeData("lastTip").hide("fade"),$("#schedule_copy_container").length==0&&$("body").append('<div id="schedule_copy_container" class="copy_schedule_layer ui-shadow ui-draggable none"></div>'),$("#schedule_copy_container").scheduleCopy({sid:e})},$.widget("mxx.scheduleCopy",{options:{},_create:function(){var e=this,t=$(this.element),n=this.options,r='<a href="javascript:;" class="close_btn js_close"></a><h2>复制日程到</h2><div class="calendar_list_container e_clear"></div><div class="schedule_bottom"><a href="javascript:;" class="js_save" sid="{sid}">保存</a></div>';t.html(r).position({collision:"fit",of:"body",at:"left top",my:"center top"}),t.draggable({containment:"body",handle:"h2",cancel:"a",cursor:"move",opacity:.85}),t.find("a.js_close").click(function(){t.hide("fade")}),t.find("a.js_save").click(function(){if(t.find(".calendar_list_row input:checked").length==0){$.alert("您没有选择目标日历！");return}t.find(".calendar_list_row input").each(function(){$(this).prop("checked")&&e._copySchedule($(this).attr("cld"))})})},_init:function(){var n=this,r=$(this.element),i=this.options;$.ajax({url:"/schedule/getRawScheduleByIdV2.do",type:"post",data:{scheduleId:i.sid},success:function(i){if(i.state=="wrongpass")$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}});else{var s=t.getDateRange(),o=new Date(i.startTime),u=new Date(i.repeatStopTime),a={schTitle:e.htmlDecode(i.title),alldayEvent:i.allDayEvent,calendarId:0,startTime:[e.formatDate(o)," ",("0"+o.getHours()).slice(-2),":",("0"+o.getMinutes()).slice(-2),":00"].join(""),timeZone:-(new Date).getTimezoneOffset()/60,repeatType:i.repeatType,calendarType:i.calendarType,before_minutes:i.alarm,fromDate:s.from,toDate:s.to,duration:i.duration,repeatCount:i.repeatCount==0?"":i.repeatCount,repeatDay:i.repeatDay,repeatFrequency:i.repeatFrequency==0?"":i.repeatFrequency,repeatMonth:i.repeatMonth,repeatMonthDay:i.repeatMonthDay,repeatStopTime:[e.formatDate(u)," ",("0"+u.getHours()).slice(-2),":",("0"+u.getMinutes()).slice(-2),":00"].join(""),scheduleId:"",linked_url:i.url,location:i.location};i.description!==null&&i.description!==""&&Object.prototype.toString.call(i.description)!=="[object Undefined]"&&(a.description=i.description);for(var f in a)a[f]==null&&(a[f]="");n.postData=a;var l=t.getAllCalendarNames(!0);r.find(".calendar_list_container").html($.map(l,function(e,t){return e.id==i.calendarId?"":"<div class='calendar_list_row'><input type='checkbox' cld='"+e.id+"'/><span>"+e.name+"</span></div>"}).join("")),r.show(),$.ajax({url:"/schedule/getpics.do",type:"post",dataType:"json",data:{calendarID:i.calendarId,scheduleUUID:i.uuid},success:function(e){if(e.state=="ok"){var t=[];for(var r in e.pics){var i=e.pics[r];t.push({pic:i.pic,sequence:i.sequence,source:"schedule_pics"})}n.postData.pics=JSON.stringify(t)}}})}},error:function(){},dataType:"json"})},_copySchedule:function(e){var t=this,n=$(this.element),s=this.options;t.postData.calendarId=e,t.postData.updateV2Origin="12",$.ajax({url:"/schedule/updateV2.do",type:"post",dataType:"json",data:t.postData,success:function(e){e.state=="ok"?(n.hide(),t.postData.before_minutes&&t.postData.before_minutes!=""&&i(),r(e)):e.state=="wrongpass"&&$.alert("对不起，您的登录已经过期，请重新登录！",{buttons:{"确定":function(){location="/account/login.do"}}})},error:function(e){}})}}),n}),define("rebuild/widget/schedule",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/widget/scheduleCreator","rebuild/widget/scheduleCopy"],function(e,t,n,r){var i=null;$.widget("mxx.schedule",{options:{schedule:null},_create:function(){var e=this;i!==null&&(i.destroy(),i=null),e.template='					<div class="schedule_layer ui-shadow none {scheduleMode}">						<a href="javascript:;" class="close_btn"></a>						<h2>{calendarName}</h2>						<div class="schedule_content">							<div class="schedule_title">								<p>{datetime}</p>							</div>							<div class="schedule_content_txt">								{image}								<div class="txt_box">{content}</div>								<div class="followed"></div>							</div>							{url}							{location}							{editable}						</div>					</div>',e.editTemplate='							<div class="schedule_bottom">								<a href="javascript:;" class="js_copy">复制日程</a><i>|</i><a href="javascript:;" class="js_delete">删除</a><i>|</i><a href="javascript:;" class="js_detail">编辑日程</a>							</div>',e.deleteTemplate='							<div class="schedule_bottom">								<a href="javascript:;" class="js_delete">删除</a>							</div>',e._buildUI(),e._bindLogic(),e._getFollow(),i=e},destroy:function(){var e=this,t=e.$dom;try{t.off(".schedule"),$("body").off(".schedule"),t.fadeOut("fast",function(){t.remove()})}catch(n){}i=null,$.Widget.prototype.destroy.call(e),amplify.unsubscribe("createSchedule")},_buildUI:function(){var e=this,n=$(this.element),r=e.options.schedule,i=t.getCalendarById(r.cid),s=r.start_time.split(" ")[0],o={};o.calendarName=i.title,o.datetime=[s,r.time].join(" "),o.content=r.text.replace(/\n/g,"<br/>"),o.sid=r.id,o.date=s,o.scheduleMode="small_schedule_box",o.editable="",o.url="",o.location="",o.image="",r.text.length>500&&(o.scheduleMode="big_schedule_box");if(i.access_type==2||i.access_type==3)parseInt(r.index_type)==91||parseInt(r.index_type)==92||parseInt(r.index_type)==93||parseInt(r.index_type)==95?o.editable=$.format(e.deleteTemplate,r):o.editable=$.format(e.editTemplate,r);r.url&&(o.url='<div class="tip_url_div"><span>详细链接：</span><a href="{url}" target="_blank">{url}</a></div>'.replace(/\{url\}/g,r.url));var u,a,f,l=r.location;if(l){if(l.indexOf("@")!=-1){var u=l.split("@");a="http://api.map.baidu.com/marker?location={locationAry1}&title={locationAry0}&content={locationAry0}&output=html".replace(/\{locationAry0\}/g,u[0]).replace(/\{locationAry1\}/g,u[1]),u[0]?f=u[0]:f=l}else a="http://api.map.baidu.com/geocoder?address={location}&output=html&src=365rili".replace(/\{location\}/g,l),f=l;o.location='<div class="tip_location_div"><span>地址：</span><a href="{location_url}" target="_blank">{location_name}</a></div>'.replace(/\{location_url\}/g,a).replace(/\{location_name\}/g,f)}var c=r.pics,h=[];if(c)if(c.length===1)h.push('<div class="image_div one_pic">									<a href="http://cocoimg.365rili.com/schedule_pics/default/{pics}" rel="img"></a>									</div>'.replace(/\{pics\}/g,c[0].pic));else{h.push('<div class="image_div" style="padding: 0 15px;">');for(var p=0,d=c.length;p<d;p++)h.push('<a href="http://cocoimg.365rili.com/schedule_pics/default/{pics}" rel="img"><img src="http://cocoimg.365rili.com/schedule_pics/default/{pics}" class="image_item" style="width:50px;height:50px;"/></a>'.replace(/\{pics\}/g,c[p].pic));h.push("</div>")}o.image=h.join(""),r.completed=="iscompleted"&&(o.datetime+='<span style="color:#000;">【已完成】</span>');var v=e.$dom=$($.format(e.template,o)).appendTo("body"),m={collision:"fit"};n.parents("td").attr("cellindex")<2?(m.my="left top",m.at="right top"):(m.my="right top",m.at="left top"),m.offset="0 -28px",m.of=n,v.position(m).fadeIn("fast"),e._chechheight();if(c&&c.length===1){var g=new Image;g.onload=function(){g.className="image_item",v.find(".one_pic a").append(g),e._chechheight(),v.position(m),g=null},g.src="http://cocoimg.365rili.com/schedule_pics/default/"+c[0].pic}v.draggable({containment:"body",handle:"h2",cancel:"a",cursor:"move",opacity:.85})},_chechheight:function(){var e=this.$dom,t=$(window).height();e.height()>t&&e.find(".schedule_content_txt").height(t-150).jScrollPane()},_bindLogic:function(){var e=this,t=e.$dom,n=function(){e.destroy()};t.find(".image_div a").lightbox({fitToScreen:!0}),t.on("click.schedule","a.close_btn",n).on("click.schedule",function(e){e.stopPropagation()}).on("click.schedule",".js_delete",function(){e._deleteSchedule()}).on("click.schedule",".js_detail",function(){e._editSchedule()}).on("click.schedule",".js_copy",function(){e._copySchedule()}),$("body").on("click.schedule",n),amplify.publish("openSchedule"),amplify.subscribe("createSchedule",n)},_deleteSchedule:function(){var e=this,t=e.options.schedule,n=t.id,r=t.cid,i=t.date;$.confirm("确定要删除这个日程吗？",{buttons:[{text:"删除",click:function(e){var t=this;$.getJSON("/schedule/delete.do?scheduleId="+n,function(e){e==1?($(t).dialog("close"),amplify.publish("scheduleDeleted",{sid:n})):e.state=="wrongpass"&&amplify.publish("loginTimeout")})}},{text:"取消",click:function(e){$(this).dialog("close")}}]})},_editSchedule:function(){var e=this,t=e.options.schedule;n.showForm(undefined,t.id)},_copySchedule:function(){var e=this,t=e.options.schedule;r.showForm(t.id)},_getFollow:function(){var e=this,n=e.options.schedule;if(t.getCalendarById(n.cid)["is_primary"]!="true")return;if(parseInt(n.index_type)!=94&&parseInt(n.index_type)!=95)return;$.ajax({url:"/schedule/getFollowers.do",type:"post",dataType:"json",data:{cid:n.cid,uuid:n.uuid},success:function(t){if(t.state!="ok")return;var n=t.followers,r=[];for(var i=0;i<n.length;i++)r.push(n[i].n);console.log(t),n.length&&e.$dom.find(".followed").html(r.join("，")+" 参与该日程").show()}})}})}),define("rebuild/widget/allTask",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/widget/schedule"],function(e,t){var n=null;$.widget("mxx.allTask",{options:{schedules:[],date:new Date},_create:function(){var e=this;n!==null&&(n.destroy(),n=null),e.allTaskTemplate='<div class="schedule_list_layer ui-shadow none"><dl><dt><a href="javascript:;" class="close_btn"></a><span></span></dt></dl><dl style="max-height:400px;_height:400px;overflow:auto;"></dl></div>',e.template='<dd primary="{primary}" class="task jsc-{cid}" style="border-color:{color}; background-color:{bgc}"><div class="spheric ui-corner-all-16" style="border-color:{color}; background-color:{sbgc}"></div><p class="task_text {completed}" title="{time}&nbsp;{text}">{time}&nbsp;{text}</p></dd>',e._buildUI(),e._bindLogic(),n=e},destroy:function(){var e=this,t=e.$dom;try{t.off(".allTask"),$("body").off(".allTask"),t.fadeOut("fast",function(){t.remove()})}catch(r){}n=null,$.Widget.prototype.destroy.call(e)},_buildUI:function(){var e=this,t=$(e.element),n=e.options.schedules,r=e.options.date,i=e.$dom=$(e.allTaskTemplate).appendTo("body"),s=[];for(var o=0,u=n.length;o<u;o++)n[o].completed=n[o].completed?"iscompleted":"",s.push($.format(e.template,n[o]));i.find("dl:last").html(s),i.find("dt span").html([r.getFullYear(),"年",r.getMonth()+1,"月",r.getDate(),"日 星期",["日","一","二","三","四","五","六"][r.getDay()]].join("")),i.resizable({minWidth:165,minHeight:60,resize:function(e,t){var n=t.size.height;t.element.find("dl:last").height(n-t.element.find("dl:first").height())}}).position({of:t,my:"left top",at:"left top",collision:"fit"}).css({width:Math.max(i.width()*1.5,165),height:"auto"}).fadeIn("fast")},_bindLogic:function(){var e=this,t=e.$dom,n=function(){e.destroy()};t.on("click.allTask","a.close_btn",n).on("click.allTask",function(e){e.stopPropagation()}).on("click.allTask",".task",e._showSchedule),$("body").on("click.allTask",n)},_showSchedule:function(){var e=$(this),n=t.getScheduleByPrimary(e.attr("primary"));e.schedule({schedule:n})}})}),define("rebuild/class/Gird",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/widget/scheduleCreator","rebuild/widget/allTask","rebuild/widget/schedule"],function(e,t,n){function r(e,t){var n=this;n.dom=e,n.$dom=$(e),n.index=t,n.date=null,n.day=null,n.month=null,n.realMonth=null,n.lunar=null,n.festival=null,n.schedule=[],n.dateString=null,n.calendars=null,n.template='<dd primary="{primary}" class="task jsc-{cid}" style="border-color:{color}; background-color:{bgc}"><div class="spheric ui-corner-all-16" style="border-color:{color}; background-color:{sbgc}"></div><p class="task_text {completed}" title="{time}&nbsp;{text}">{time}&nbsp;{text}</p></dd>',n.moreTemplate='<dd class="task_more">还有{num}个日程</dd>',n.scheduleNum=0,n.shownScheduleNum=0,n.more=!1}return r.prototype.init=function(){var e=this;amplify.subscribe("dateUpdated",e,e.updateDate),amplify.subscribe("scheduleDataChanged",e,e.updateScheduleData),amplify.subscribe("panelResized",e,e.updateScheduleView),e.$dom.on("click.Gird_"+e.index,".task_more",function(t){t.stopPropagation(),e.showAllTask.call(e)}).on("click.Gird_"+e.index,".task",function(t){t.stopPropagation(),e.showschedule.call(this)}).on("click.Gird_"+e.index,function(t){t.stopPropagation(),e.createSchedule.call(e)}),e.updateScheduleNum()},r.prototype.createSchedule=function(){var e=this;n.showForm(e.dateString,undefined,e.$dom)},r.prototype.showschedule=function(){var e=$(this),n=t.getScheduleByPrimary(e.attr("primary"));e.schedule({schedule:n})},r.prototype.showAllTask=function(){var e=this;e.$dom.allTask({schedules:e.schedule,date:e.date})},r.prototype.destroy=function(){var e=this;amplify.unsubscribe("dateUpdated",e.updateDate),amplify.unsubscribe("scheduleDataChanged",e.updateScheduleData),amplify.unsubscribe("panelResized",e.updateScheduleView),e.$dom.off(".Gird_"+e.index)},r.prototype.updateScheduleNum=function(){var e=this;if(t.getCurrentPanel()==="week")e.scheduleNum=e.schedule.length,e.more=!1;else{var n=e.$dom.height()-e.$dom.find("dt").height(),r=n%22;e.scheduleNum=parseInt(n/22),e.scheduleNum<e.schedule.length?(r<18&&--e.scheduleNum<0&&++e.scheduleNum,e.more=!0):e.scheduleNum>=e.schedule.length&&(e.scheduleNum=e.schedule.length,e.more=!1)}},r.prototype.updateScheduleData=function(){var e=this;globalData=arguments[0].scheduleList||t.getScheduleList();if(!globalData)return;var n=globalData[e.dateString],r=e.calendars=arguments[1]||t.getCalendarListSelectedCld(),i=[],s,o;e.empty();if(!n)return amplify.publish("scheduleViewUpdated","noData",e.dateString,r);var u=[];for(var a=0,f=r.length;a<f;a++){s=n[r[a]],o=n[r[a]+"_cloned"];if(!s){u.push(r[a]);continue}i=i.concat(s),o&&(i=i.concat(o))}if(u.length!==0)return amplify.publish("scheduleViewUpdated","noData",e.dateString,u);i.sort(function(e,t){if(e.time==="全天"&&t.time!=="全天")return-1;if(e.time!=="全天"&&t.time==="全天")return 1;if(e.time==="全天"&&t.time==="全天")return e.cid-t.cid;var n=(new Date(e.start_time.replace(/-/g,"/"))).getTime(),r=(new Date(t.start_time.replace(/-/g,"/"))).getTime();return n!=r?n-r:e.cid-t.cid}),e.schedule=i,e.updateScheduleView()},r.prototype.updateScheduleView=function(){var e=this;e.updateScheduleNum();var t=e.schedule.length,n=e.scheduleNum-e.shownScheduleNum,r=[];if(e.schedule.length===0)e.empty();else if(n>=0){var i=null;for(var s=e.shownScheduleNum,o=e.scheduleNum;s<o;s++)i=e.schedule[s],i.completed=i.completed?"iscompleted":"",r.push($.format(e.template,i));e.withOutHandle(function(){$(r).appendTo(e.$dom.find("dl")),e.shownScheduleNum=e.$dom.find(".task").length,e.setMore()}),e.shownScheduleNum=e.scheduleNum}else if(n<0){var u=e.$dom.find(".task"),a=[];for(var s=e.shownScheduleNum,o=e.scheduleNum;s>=o;s--)a.push(u.eq(s));e.withOutHandle(function(){for(var t=0,n=a.length;t<n;t++)a[t].remove();e.shownScheduleNum=e.$dom.find(".task").length,e.setMore()}),e.shownScheduleNum=e.scheduleNum}amplify.publish("scheduleViewUpdated",e)},r.prototype.setMore=function(){var e=this;e.$dom.find(".task_more").remove(),e.more&&$(e.moreTemplate.replace("{num}",e.schedule.length-e.shownScheduleNum)).appendTo(e.$dom.find("dl"))},r.prototype.updateDate=function(){var t=this,n=arguments[0],r=n.fromDate,i=new Date(r);i.setDate(r.getDate()+t.index),t.date=i,t.day=i.getDate(),t.month=i.getMonth(),t.realMonth=t.month+1,t.year=i.getFullYear(),t.lunar=lunar(i),t.festival=t.lunar.festival()[0],t.dateString=e.formatDate(t.date),t.withOutHandle(function(){t.updateDateView(n)}),t.withOutHandle(function(){t.updateScheduleData(n)})},r.prototype.updateDateView=function(){var e=this,t=arguments[0],n=e.$dom,r=n.find(".solar-text");e.withOutHandle(function(){r.text(e.date.getDate())}),e.month<t.month?e.withOutHandle(function(){n.removeClass("month_befor month_after table-today weekend").addClass("month_befor")}):e.month>t.month?e.withOutHandle(function(){n.removeClass("month_befor month_after table-today weekend").addClass("month_after")}):e.withOutHandle(function(){n.removeClass("month_befor month_after table-today weekend")});var i=t.holidays[e.year];n.find(".vocationt-text, .work-text, .today-text").remove(),i&&(i.festival["m"+e.realMonth+"d"+e.day]?e.withOutHandle(function(){n.find("dt").append('<span class="vocationt-text">放假</span>')}):i.workday["m"+e.realMonth+"d"+e.day]&&e.withOutHandle(function(){n.find("dt").append('<span class="work-text">工作</span>')})),e.date.toDateString()===t.today.toDateString()&&e.withOutHandle(function(){n.addClass("table-today"),n.find("dt").append('<span class="today-text">今天</span>')});var s=n.find(".lunar-text");e.festival?e.withOutHandle(function(){s.text(e.festival.desc),s.css("color","#198500")}):e.lunar.term?e.withOutHandle(function(){s.text(e.lunar.term),s.css("color","#198500")}):e.lunar.dateIndex!==0?e.withOutHandle(function(){s.text(e.lunar.lDate)}):e.withOutHandle(function(){s.text(e.lunar.lMonth+"月"+(e.lunar.isBigMonth?"大":"小"))})},r.prototype.empty=function(){var e=this;e.withOutHandle(function(){e.$dom.find(".task").remove(),e.$dom.find(".task_more").remove()}),e.shownScheduleNum=0},r.prototype.withOutHandle=function(e){setTimeout(e,function(e,t){return Math.random()*(t-e)+e}(0,1))},r}),define("rebuild/module/getHolidays",[],function(){var e={2014:{festival:function(){var e="m1d1 m1d31 m2d1 m2d2 m2d3 m2d4 m2d5 m2d6 m4d5 m4d6 m4d7 m5d1 m5d2 m5d3 m5d31 m6d1 m6d2 m9d6 m9d7 m9d8 m10d1 m10d2 m10d3 m10d4 m10d5 m10d6 m10d7".split(" "),t={};for(var n=0,r=e.length;n<r;n++)t[e[n]]="rest";return t}(),workday:function(){var e="m1d26 m2d8 m5d4 m9d28 m10d11".split(" "),t={};for(var n=0,r=e.length;n<r;n++)t[e[n]]="work";return t}()},2015:{festival:function(){var e="m1d1 m1d2 m1d3 m2d18 m2d19 m2d20 m2d21 m2d22 m2d23 m2d24 m4d4 m4d5 m4d6 m5d1 m5d2 m5d3 m6d20 m6d21 m6d22 m9d26 m9d27 m9d3 m9d4 m9d5 m10d1 m10d2 m10d3 m10d4 m10d5 m10d6 m10d7".split(" "),t={};for(var n=0,r=e.length;n<r;n++)t[e[n]]="rest";return t}(),workday:function(){var e="m1d4 m2d15 m2d28 m9d6 m10d10".split(" "),t={};for(var n=0,r=e.length;n<r;n++)t[e[n]]="work";return t}()},2016:{festival:function(){var e="m1d1 m1d2 m1d3 m2d7 m2d8 m2d8 m2d9 m2d10 m2d11 m2d12 m2d13 m4d2 m4d3 m4d4 m4d30 m5d1 m5d2 m6d9 m6d10 m6d11 m9d15 m9d16 m9d17 m10d1 m10d2 m10d3 m10d4 m10d5 m10d6 m10d7".split(" "),t={};for(var n=0,r=e.length;n<r;n++)t[e[n]]="rest";return t}(),workday:function(){var e="m2d6 m2d14 m6d12 m9d18 m10d8 m10d9".split(" "),t={};for(var n=0,r=e.length;n<r;n++)t[e[n]]="work";return t}()}};return{getHolidays:function(){return e}}}),define("rebuild/module/scheduleData",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/module/getHolidays","rebuild/base/solarAndLunar"],function(e,t,n){var r={scheduleList:t.getScheduleList(),allSchedule:t.getAllSchedule()},i={getScheduleData:function(t){r.needGetScheduleRang=t;var n,i,s;n=e.formatDate(t.begin),i=new Date(t.end),i.setDate(i.getDate()+1),i=e.formatDate(i);var o={from:n,to:i},s=[];for(var u in t.calendars)s.push(u);if(s.length===0)return $.loading.close(),amplify.publish("sceduleDataGeted",[],o);var a={fromDate:n,toDate:i,timeZone:-t.begin.getTimezoneOffset()/60,calendarId:s.join(",")};$.ajax({url:"/schedule/list.do",type:"post",dataType:"json",beforeSend:function(){$.loading()},data:a,success:function(e){if(e.state=="wrongpass")return amplify.publish("loginTimeout");amplify.publish("sceduleDataGeted",e,o),$.loading.close()},error:function(){}})},removeSchedule:function(){var e=arguments[0].sid||arguments[0],n=null,i;for(var s in r.scheduleList){n=r.scheduleList[s];for(var o in n){i=n[o];for(var u=0,a=i.length;u<a;u++)i[u].id==e&&(i.splice(u,1),a--,u--)}}for(var f in r.allSchedule)r.allSchedule[f].id==e&&delete r.allSchedule[f];amplify.publish("scheduleDataChanged",r,t.getCalendarListSelectedCld())},removeScheduleBySid:function(e){i.removeSchedule(e)},removeScheduleByCalendar:function(){var e=arguments[0],n=e+"_cloned";for(var i in r.allSchedule)r.allSchedule[i].cid==e&&delete r.allSchedule[i];for(var s in r.allScheduleById)r.allScheduleById[s].cid==e&&delete r.allScheduleById[s];var o=null,u;for(var a in r.scheduleList){o=r.scheduleList[a];for(var f in o)f==e&&(delete o[e],delete o[n])}amplify.publish("scheduleDataChanged",r,t.getCalendarListSelectedCld())},updateSchedule:function(){var e=arguments[0],t=e.schlist[0].id;i.removeScheduleBySid(t),i.updateScheduleData([e])},addSchedule:function(){var e=arguments[0];i.updateScheduleData([e])},updateScheduleData:function(){var n=arguments[0]||[];r.scheduleList||(r.scheduleList={},r.allSchedule={},r.allScheduleById={});var s,o,u,a=r.scheduleList,f=r.allSchedule,l=r.allScheduleById,h,p,d=arguments[0]==-1?t.getCalendarList().selectedClds:[arguments[0]];if(!t.getInitedStatus()){var v=t.getAllCalendarList();if(v){var m=[];for(var g=0,y=v.length;g<y;g++)m.push(v[g].id);d=m}}if(arguments[1]==="currentListChanged")return amplify.publish("scheduleDataChanged",r,d);var b=r.calendarsColor=r.calendarsColor||{},w=t.getCalendarList().calendarList;for(var g=0,y=w.length;g<y;g++)b[w[g].id]={bgc:w[g].bgc,sbgc:w[g].sbgc,color:w[g].color};for(var g=0,y=n.length;g<y;g++){s=n[g],r.pic=s.piclist||{};if(!s)continue;for(var E=0,S=s.schlist.length;E<S;E++)s.schlist[E].pic_url=s.pic_url,i.insertData(s.schlist[E])}if(r.needGetScheduleRang){var x=r.needGetScheduleRang,T="";while(x.begin.getTime()<=x.end.getTime()){T=e.formatDate(x.begin),a[T]||(a[T]={});for(var o in x.calendars)a[T][o]||(a[T][o]=[]);x.begin.setDate(x.begin.getDate()+1),g++}}amplify.publish("scheduleDataChanged",r,t.getCalendarListSelectedCld())},insertData:function(e){scheduleList=r.scheduleList,allSchedule=r.allSchedule,allScheduleById=r.allScheduleById,typeof e.text=="string"?e.text=e.text.replace(/\&amp\;/g,"&"):e.text=JSON.stringify(e.text).replace(/\&amp\;/g,"&"),e.description&&(e.description=e.description.replace(/\&amp\;/g,"&")),day=e.start_time.split(" ")[0],cid=e.cloned?e.cid+"_cloned":e.cid,e.primary=[e.id,e.start_time,e.duration].join("_"),e.date=new Date(e.start_time),e.time=e.allday_event?"全天":e.start_time.slice(11,16);var t=r.calendarsColor;e.bgc=t[e.cid].bgc,e.sbgc=t[e.cid].sbgc,e.color=t[e.cid].color,e.pics=r.pic[e.uuid],e.url&&(e.url=e.url),scheduleList[day]||(scheduleList[day]={}),scheduleList[day][cid]||(scheduleList[day][cid]=[]);if(!allSchedule[e.primary])scheduleList[day][cid].push(e);else for(var n=0,i=scheduleList[day][cid].length;n<i;n++)scheduleList[day][cid][n].primary==e.primary&&(scheduleList[day][cid][n]=e);allSchedule[e.primary]=e,allScheduleById[e.id]=e}};amplify.subscribe("sceduleDataGeted",i.updateScheduleData),amplify.subscribe("currentListChanged",i.updateScheduleData),amplify.subscribe("scheduleDeleted",i.removeSchedule),amplify.subscribe("scheduleUpdated",i.updateSchedule),amplify.subscribe("scheduleCreated",i.addSchedule),amplify.subscribe("calendarDeleted",i.removeScheduleByCalendar),amplify.subscribe("scheduleDataNotEnough",i.getScheduleData)}),define("rebuild/module/weekPanel",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/class/Gird","rebuild/module/getHolidays","rebuild/module/scheduleData","rebuild/base/solarAndLunar"],function(e,t,n,r,i){var s=7,o={},u={modeName:"week",report:function(){amplify.publish("initPanelModule",u.modeName,'#ul_view_switcher li[tab="week"]')},checkPanel:function(){var e=arguments[0],n=t.getCurrentPanel();!n&&e===u.modeName&&u.init(),n&&(o.currentPanel=e);if(n===u.modeName&&e!==u.modeName){try{u.destroy()}catch(r){}return}},checkOtherPanelDestroy:function(){var e=arguments[0];e!==u.modeName&&o.currentPanel==u.modeName&&u.init()},destroy:function(){o.prevBtn.attr("title","前一个月"),o.nextBtn.attr("title","后一个月"),$(window).off(".weekPanel"),$(".today_calendar").off(".weekPanel"),$("#today_calendar_week").hide(),$("#lnk_today").hide(),u.destroyGird(),$("#div_calendar_panel").empty(),amplify.unsubscribe("scheduleViewUpdated",u.checkScheduleUpdated),amplify.unsubscribe("AcrossTheDay",u.acrossDate),amplify.publish("panelDestroied",u.modeName)},destroyGird:function(){for(var e=0,t=o.Girds.length;e<t;e++)o.Girds[e].destroy(),o.Girds[e]=null;o.Girds=[]},init:function(){u.buildData(),u.buildBaseUI(),u.buildLogic(),amplify.publish("calendarPanelChanged",u.modeName)},buildData:function(){o.html={head:'					<table cellspacing="0" cellpadding="0" width="100%" height="38" class="js_tb_head">						<tbody>							<tr class="calendar_th">								<th height="38">周一</th>								<th>周二</th>								<th>周三</th>								<th>周四</th>								<th>周五</th>								<th class="weekend">周六</th>								<th class="weekend">周日</th>							</tr>						</tbody>					</table>',headForSun:'					<table cellspacing="0" cellpadding="0" width="100%" height="38" class="js_tb_head">						<tbody>							<tr class="calendar_th">								<th height="38" class="weekend">周日</th>								<th>周一</th>								<th>周二</th>								<th>周三</th>								<th>周四</th>								<th>周五</th>								<th class="weekend">周六</th>							</tr>						</tbody>					</table>',day:'					<td class="ui-selectee ui-droppable" i="{i}" cellindex="{cell}" rowindex="{row}" valign="top">						<dl class="day_box">							<dt class="e_clear">								<span class="lunar-text"></span>								<span class="solar-text"></span>							</dt>						</dl>					</td>'},o.yearDom=$("#sp_year"),o.monthDom=$("#sp_month"),o.prevBtn=$("#lnk_prev"),o.nextBtn=$("#lnk_next"),o.Girds=[],o.today=new Date(+G.currDate),o.date=new Date(+G.currDate),o.month=o.date.getMonth(),o.calendar=new Calendar(o.date),o.isSundayFirst=t.getFirstDay()==="sunday",o.fromDate=u.getFromDate(),o.fromMonth=o.fromDate.getMonth(),o.holidays=r.getHolidays(),o.girdReady=0,o.needGetScheduleDayRang=null},buildBaseUI:function(){var e=o.html,t=[],n=row=0;for(var r=0;r<s;r++)r%7==0&&r!==0&&t.push("</tr><tr>"),n=r%7,row=parseInt(r/7),t.push($.format(e.day,{i:r,cell:n,row:row}));t.unshift('<table cellspacing="0" cellpadding="0" width="100%" class="calendar_table ui-selectable" id="div_wview" style="height: 373px;"><tbody><tr>'),t.unshift(o.isSundayFirst?e.headForSun:e.head),t.join("</tbody></table>"),$("#div_calendar_panel").html(t.join("")),o.prevBtn.attr("title","前一个周"),o.nextBtn.attr("title","后一个周"),u.resize()},buildLogic:function(){$(window).on("resize.weekPanel",u.resize),$(".today_calendar").on("click.weekPanel","#lnk_next",u.nextWeek).on("click.weekPanel","#lnk_prev",u.prevWeek).on("click.weekPanel","#lnk_today",u.toWeek),$("#today_calendar_week").show(),$("#lnk_today").show(),u.registGrid(),amplify.subscribe("scheduleViewUpdated",u.checkScheduleUpdated),amplify.subscribe("AcrossTheDay",u.acrossDate)},getFromDate:function(){return o.isSundayFirst?o.calendar.getWeekSundayFirstDate():o.calendar.getWeekFirstDate()},nextWeek:function(){var e=o.date;e.setDate(e.getDate()+7),u.updateDate()},prevWeek:function(){var e=o.date;e.setDate(e.getDate()-7),u.updateDate()},toWeek:function(){var e=o.date;e.setYear(o.today.getFullYear()),e.setMonth(o.today.getMonth()),e.setDate(o.today.getDate()),u.updateDate()},acrossDate:function(){o.date.getFullYear()===o.today.getFullYear()&&o.month===o.today.getMonth()&&o.date.getDate()===o.today.getDate()&&(o.date=new Date(+G.currDate)),o.today=new Date(+G.currDate),u.updateDate()},updateDate:function(){o.month=o.date.getMonth(),o.calendar=new Calendar(o.date),o.fromDate=u.getFromDate(),o.fromMonth=o.fromDate.getMonth();var e=o.date,t=e.getFullYear(),n=e.getMonth()+1,r=new Date(t,0,1),i=e.getDay();i==0&&(dayWeek=7);var s=r.getDay();s==0&&(s=7);var a=parseInt(((e.getTime()-r.getTime())/864e5+s-i)/7+1);$("#sp_week").html([t,"年第",a,"周     ",n,"月"].join("")),o.date.getFullYear()!==o.today.getFullYear()||o.month!==o.today.getMonth()||o.date.getDate()!==o.today.getDate()?$("#lnk_today").show():$("#lnk_today").hide(),amplify.publish("dateUpdated",o)},registGrid:function(){var e=o.gird=$(".calendar_table td"),t=null;for(var r=0,i=e.length;r<i;r++)t=new n(e[r],r),t.init(),o.Girds.push(t);u.toWeek()},checkScheduleUpdated:function(){o.girdReady===s&&(o.girdReady=0),o.girdReady++,arguments[0]==="noData"&&u.setNeedGetScheduleRang(arguments[1],arguments[2]);if(o.girdReady!==s)return;o.needGetScheduleRang?(amplify.publish("scheduleDataNotEnough",o.needGetScheduleRang),rang=o.needGetScheduleRang=null):(amplify.publish("calendarReady"),amplify.publish("calendarAndScheduleChanged","week"))},setNeedGetScheduleRang:function(e,t){var n=o.needGetScheduleRang,r=new Date(e.replace(/-/g,"/"));n?r<n.begin?n.begin=r:r>n.end&&(n.end=r):(n=o.needGetScheduleRang={},n.begin=n.end=r,n.calendars={});for(var i=0,s=t.length;i<s;i++)n.calendars[t[i]]||(n.calendars[t[i]]=1)},resize:function(){var t=$(".calendar_table"),n=$(window).height(),r=n-$("#div_today").height()-$(".js_tb_head").height();e.isPCVersion()||(r-=$(".calendar_header").height()),$(".calendar_table").height(r),amplify.publish("panelResized")}};amplify.subscribe("toChangeCalendarPanel",u.checkPanel),amplify.subscribe("panelReady",u.report),amplify.subscribe("panelDestroied",u.checkOtherPanelDestroy)}),define("rebuild/module/monthPanel",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/class/Gird","rebuild/module/getHolidays","rebuild/module/scheduleData","rebuild/widget/scheduleCreator","rebuild/base/solarAndLunar"],function(e,t,n,r,i,s){var o=42,u={},a={modeName:"month",report:function(){amplify.publish("initPanelModule",a.modeName,'#ul_view_switcher li[tab="month"]')},checkPanel:function(){var e=arguments[0],n=t.getCurrentPanel();!n&&e===a.modeName&&a.init(),n&&(u.currentPanel=e);if(n===a.modeName&&e!==a.modeName){try{a.destroy()}catch(r){}return}},checkOtherPanelDestroy:function(){var e=arguments[0];e!==a.modeName&&u.currentPanel==a.modeName&&a.init()},destroy:function(){$(window).off(".monthPanel"),$(".today_calendar").off(".monthPanel"),$("#today_calendar_year_month").hide(),$("#lnk_today").hide(),a.destroyGird(),$("#div_calendar_panel").empty(),amplify.unsubscribe("scheduleViewUpdated",a.checkScheduleUpdated),amplify.unsubscribe("AcrossTheDay",a.acrossDate),amplify.publish("panelDestroied",a.modeName)},destroyGird:function(){for(var e=0,t=u.Girds.length;e<t;e++)u.Girds[e].destroy(),u.Girds[e]=null;u.Girds=[]},init:function(){a.buildData(),a.buildBaseUI(),a.buildLogic(),amplify.publish("calendarPanelChanged",a.modeName)},buildData:function(){u.html={head:'					<table cellspacing="0" cellpadding="0" width="100%" height="38" class="js_tb_head">						<tbody>							<tr class="calendar_th">								<th height="38">周一</th>								<th>周二</th>								<th>周三</th>								<th>周四</th>								<th>周五</th>								<th class="weekend">周六</th>								<th class="weekend">周日</th>							</tr>						</tbody>					</table>',headForSun:'					<table cellspacing="0" cellpadding="0" width="100%" height="38" class="js_tb_head">						<tbody>							<tr class="calendar_th">								<th height="38" class="weekend">周日</th>								<th>周一</th>								<th>周二</th>								<th>周三</th>								<th>周四</th>								<th>周五</th>								<th class="weekend">周六</th>							</tr>						</tbody>					</table>',day:'					<td class="ui-selectee ui-droppable" i="{i}" cellindex="{cell}" rowindex="{row}" valign="top">						<dl class="day_box">							<dt class="e_clear">								<span class="lunar-text"></span>								<span class="solar-text"></span>							</dt>						</dl>					</td>'},u.yearDom=$("#sp_year"),u.monthDom=$("#sp_month"),u.prevBtn=$("#lnk_prev"),u.nextBtn=$("#lnk_next"),u.todayBtn=$("#lnk_today"),u.Girds=[],u.today=new Date(+G.currDate),u.date=new Date(+G.currDate),u.month=u.date.getMonth(),u.calendar=new Calendar(u.date),u.isSundayFirst=t.getFirstDay()==="sunday",u.fromDate=a.getFromDate(),u.fromMonth=u.fromDate.getMonth(),u.holidays=r.getHolidays(),u.girdReady=0,u.needGetScheduleDayRang=null},buildBaseUI:function(){var e=u.html,t=[],n=row=0;for(var r=0;r<o;r++)r%7==0&&r!==0&&t.push("</tr><tr>"),n=r%7,row=parseInt(r/7),t.push($.format(e.day,{i:r,cell:n,row:row}));t.unshift('<table cellspacing="0" cellpadding="0" width="100%" class="calendar_table ui-selectable" style="height: 373px;"><tbody><tr>'),t.unshift(u.isSundayFirst?e.headForSun:e.head),t.join("</tbody></table>"),$("#div_calendar_panel").html(t.join("")),a.selectable(),a.resize()},buildLogic:function(){$(window).on("resize.monthPanel",a.resize),$(".today_calendar").on("click.monthPanel","#lnk_next",a.nextMonth).on("click.monthPanel","#lnk_prev",a.prevMonth).on("click.monthPanel","#lnk_today",a.today),$("#lnk_today").show(),$("#today_calendar_year_month").show().on("mousewheel.monthPanel","#sp_year",a.wheelYear).on("mousewheel.monthPanel","#sp_month",a.wheelMonth),a.registGrid(),amplify.subscribe("scheduleViewUpdated",a.checkScheduleUpdated),amplify.subscribe("AcrossTheDay",a.acrossDate)},getFromDate:function(){return u.isSundayFirst?u.calendar.getCalendarSundayFirstDate():u.calendar.getCalendarFirstDate()},wheelYear:function(e,t){var n=$("#sp_year"),r=u.date.getFullYear();return r+=t>0?1:-1,u.date.setYear(r),n.text(r),clearTimeout(u.wheelMar),u.wheelMar=setTimeout(function(){clearTimeout(u.wheelMar),a.updateDate()},100),!1},wheelMonth:function(e,t){var n=$("#sp_year"),r=u.date.getFullYear(),i=$("#sp_month"),s=u.date.getMonth();return s+=t>0?1:-1,s=s>11?(++r,0):s<0?(--r,11):s,u.date.setYear(r),u.date.setMonth(s),i.text(s+1),n.text(r),clearTimeout(u.wheelMar),u.wheelMar=setTimeout(function(){clearTimeout(u.wheelMar),a.updateDate()},100),!1},nextMonth:function(){u.date.setMonth(u.date.getMonth()+1),a.updateDate()},prevMonth:function(){u.date.setMonth(u.date.getMonth()-1),a.updateDate()},today:function(){u.date.setYear(u.today.getFullYear()),u.date.setMonth(u.today.getMonth()),a.updateDate()},acrossDate:function(){u.date.getFullYear()===u.today.getFullYear()&&u.month===u.today.getMonth()&&(u.date=new Date(+G.currDate)),u.today=new Date(+G.currDate),a.updateDate()},updateDate:function(){u.month=u.date.getMonth(),u.calendar=new Calendar(u.date),u.fromDate=a.getFromDate(),u.fromMonth=u.fromDate.getMonth(),$("#sp_year").text(u.date.getFullYear()),$("#sp_month").text(u.date.getMonth()+1),u.date.getFullYear()!==u.today.getFullYear()||u.month!==u.today.getMonth()?$("#lnk_today").show():$("#lnk_today").hide(),amplify.publish("dateUpdated",u)},checkScheduleUpdated:function(){u.girdReady===o&&(u.girdReady=0),u.girdReady++,arguments[0]==="noData"&&a.setNeedGetScheduleRang(arguments[1],arguments[2]);if(u.girdReady!==o)return;u.needGetScheduleRang?(amplify.publish("scheduleDataNotEnough",u.needGetScheduleRang),rang=u.needGetScheduleRang=null):(amplify.publish("calendarReady"),amplify.publish("calendarAndScheduleChanged"))},setNeedGetScheduleRang:function(e,t){var n=u.needGetScheduleRang,r=new Date(e.replace(/-/g,"/"));n?r<n.begin?n.begin=r:r>n.end&&(n.end=r):(n=u.needGetScheduleRang={},n.begin=new Date(e.replace(/-/g,"/")),n.end=new Date(e.replace(/-/g,"/")),n.calendars={});for(var i=0,s=t.length;i<s;i++)n.calendars[t[i]]||(n.calendars[t[i]]=1)},registGrid:function(){var e=u.gird=$(".calendar_table td"),t=null;for(var r=0,i=e.length;r<i;r++)t=new n(e[r],r),t.init(),u.Girds.push(t);a.today()},resize:function(){var t=$(".calendar_table"),n=$(window).height(),r=n-$("#div_today").height()-$(".js_tb_head").height();e.isPCVersion()||(r-=$(".calendar_header").height()),$(".calendar_table").height(r),amplify.publish("panelResized")},selectable:function(){$("table.calendar_table").selectable({filter:"td",cancel:"dd",selecting:function(e,t){$(t.selecting).addClass("selected")},unselecting:function(e,t){$(t.unselecting).removeClass("selected")},stop:function(e,t){var n=$("table.calendar_table td.selected");if(n.size()){var r=u.Girds[n.first().attr("i")].dateString,i=n.map(function(){var e=u.Girds[$(this).attr("i")];return new Date(e.date)}).get();s.showForm(r,undefined,n,undefined,i)}}})},cancelSelect:function(){$("table.calendar_table td.selected").removeClass("selected")}};amplify.subscribe("toChangeCalendarPanel",a.checkPanel),amplify.subscribe("panelReady",a.report),amplify.subscribe("panelDestroied",a.checkOtherPanelDestroy),amplify.subscribe("scheduleClosed",a.cancelSelect),amplify.subscribe("scheduleCreated",a.cancelSelect)}),define("rebuild/class/GirdForList",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/widget/scheduleCreator","rebuild/widget/allTask","rebuild/widget/schedule"],function(e,t,n){function r(e,t){var n=this;n.dom=e,n.$dom=$(e),n.index=t,n.date=null,n.day=null,n.month=null,n.realMonth=null,n.lunar=null,n.festival=null,n.schedule=[],n.dateString=null,n.calendars=null,n.outOfDayNum=!1,n.template='					<dl primary="{primary}">						<dt><div class="spheric ui-corner-all-16 jsc-{cid}" style="border-color:{color}; background-color:{bgc}"></div>						<span class="month_view_schedule_time">{time}</span>						<a href="javascript:;" title="修改日程" class="month_view_edit_schedule none"></a><a href="javascript:;" title="删除日程" class="month_view_del_schedule none"></a></dt>						<dd class="listTaskText on {completed}">{text}</dd>					</dl>',n.noEditTemplate='					<dl primary="{primary}">						<dt><div class="spheric ui-corner-all-16 jsc-{cid}" style="border-color:{color}; background-color:{bgc}"></div>						<span class="month_view_schedule_time">{time}</span></dt>						<dd class="listTaskText on {completed}">{text}</dd>					</dl>',n.deleteTemplate='					<dl primary="{primary}">						<dt><div class="spheric ui-corner-all-16 jsc-{cid}" style="border-color:{color}; background-color:{bgc}"></div>						<span class="month_view_schedule_time">{time}</span>						<a href="javascript:;" title="删除日程" class="month_view_del_schedule none"></a></dt>						<dd class="listTaskText on {completed}">{text}</dd>					</dl>',n.more=!1}return r.prototype.init=function(){var e=this;amplify.subscribe("dateUpdated",e,e.updateDate),amplify.subscribe("scheduleDataChanged",e,e.updateScheduleData),amplify.subscribe("panelResized",e,e.updateScheduleView),amplify.subscribe("showOnly",e,e.toggleScheduleShow),e.$dom.on("mouseenter.Gird_"+e.index,function(t){e.showScheduleCreator.call(e)}).on("mouseleave.Gird_"+e.index,function(t){e.hideScheduleCreator.call(e)}).on("mouseenter.Gird_"+e.index,"dt",e.showTools).on("mouseleave.Gird_"+e.index,"dt",e.hideTools).on("click.Gird_"+e.index,".listTaskText",e.showSchedule).on("click.Gird_"+e.index,".month_view_add_schedule_btn",function(t){t.stopPropagation(),e.createSchedule(this)}).on("click.Gird_"+e.index,".month_view_del_schedule",function(t){t.stopPropagation(),e.deleteSchedule(this)}).on("click.Gird_"+e.index,".month_view_edit_schedule",function(t){t.stopPropagation(),e.editSchedule(this)})},r.prototype.toggleScheduleShow=function(){var e=this;if(e.schedule.length!==0){e.outOfDayNum||e.$dom.show();return}arguments[0]?e.$dom.stop(!0,!0).hide():e.outOfDayNum||e.$dom.stop(!0,!0).fadeIn("fast")},r.prototype.deleteSchedule=function(e){var n=t.getScheduleByPrimary($(e).parents("dl").attr("primary")),r=n.id,i=n.cid,s=n.date;$.confirm("确定要删除这个日程吗？",{buttons:[{text:"删除",click:function(e){var t=this;$.getJSON("/schedule/delete.do?scheduleId="+r,function(e){e==1?($(t).dialog("close"),amplify.publish("scheduleDeleted",{sid:r})):e.state=="wrongpass"&&amplify.publish("loginTimeout")})}},{text:"取消",click:function(e){$(this).dialog("close")}}]})},r.prototype.editSchedule=function(e){var r=t.getScheduleByPrimary($(e).parents("dl").attr("primary"));n.showForm(undefined,r.id)},r.prototype.showTools=function(){$(this).find(".month_view_edit_schedule, .month_view_del_schedule").stop(!0,!0).fadeIn("fast")},r.prototype.hideTools=function(){var e=this;$(this).find(".month_view_edit_schedule, .month_view_del_schedule").stop(!0,!0).fadeOut("fast")},r.prototype.showSchedule=function(){$(this).toggleClass("on")},r.prototype.createSchedule=function(){var e=this;n.showForm(e.dateString,undefined)},r.prototype.showScheduleCreator=function(){var e=this;e.$dom.find(".month_view_add_schedule_btn").css("display","block")},r.prototype.hideScheduleCreator=function(){var e=this;e.$dom.find(".month_view_add_schedule_btn").css("display","none")},r.prototype.showAllTask=function(){var e=this;e.$dom.allTask({schedules:e.schedule,date:e.date})},r.prototype.destroy=function(){var e=this;amplify.unsubscribe("dateUpdated",e.updateDate),amplify.unsubscribe("scheduleDataChanged",e.updateScheduleData),amplify.unsubscribe("panelResized",e.updateScheduleView),e.$dom.off(".Gird_"+e.index)},r.prototype.updateScheduleData=function(){var e=this;globalData=arguments[0].scheduleList||t.getScheduleList();if(!globalData)return;var n=globalData[e.dateString],r=e.calendars=arguments[1]||t.getCalendarListSelectedCld(),i=[],s,o;e.empty();if(!n)return amplify.publish("scheduleViewUpdated","noData",e.dateString,r);var u=[];for(var a=0,f=r.length;a<f;a++){s=n[r[a]],o=n[r[a]+"_cloned"];if(!s){u.push(r[a]);continue}i=i.concat(s),o&&(i=i.concat(o))}if(u.length!==0)return amplify.publish("scheduleViewUpdated","noData",e.dateString,u);i.sort(function(e,t){if(e.time==="全天"&&t.time!=="全天")return-1;if(e.time!=="全天"&&t.time==="全天")return 1;if(e.time==="全天"&&t.time==="全天")return e.cid-t.cid;var n=(new Date(e.start_time.replace(/-/g,"/"))).getTime(),r=(new Date(t.start_time.replace(/-/g,"/"))).getTime();return n!=r?n-r:e.cid-t.cid}),e.schedule=i,e.updateScheduleView()},r.prototype.updateScheduleView=function(){var e=this,n=e.schedule.length,r=[];e.schedule.length===0&&e.empty();var i=null,s=null;for(var o=0,u=n;o<u;o++)s=e.schedule[o],s.completed=s.completed?"iscompleted":"",i=t.getCalendarById(e.schedule[o].cid),i.access_type==2||i.access_type==3?parseInt(s.index_type)==91||parseInt(s.index_type)==92||parseInt(s.index_type)==93||parseInt(s.index_type)==95?r.push($.format(e.deleteTemplate,e.schedule[o])):r.push($.format(e.template,e.schedule[o])):r.push($.format(e.noEditTemplate,e.schedule[o]));e.withOutHandle(function(){e.$dom.find(".month_view_schedule").html(r.join(""))}),amplify.publish("scheduleViewUpdated",e)},r.prototype.updateDate=function(){var t=this,n=arguments[0],r=n.fromDate,i=new Date(r);i.setDate(r.getDate()+t.index),t.date=i,t.day=i.getDate(),t.month=i.getMonth(),t.realMonth=t.month+1,t.year=i.getFullYear(),t.lunar=lunar(i),t.festival=t.lunar.festival()[0],t.dateString=e.formatDate(t.date),t.withOutHandle(function(){t.updateDateView(n)}),t.withOutHandle(function(){t.updateScheduleData(n)})},r.prototype.updateDateView=function(){var t=this,n=arguments[0];$(".month_view_today").remove();if(t.index>=n.dayNum){t.$dom.hide(),t.outOfDayNum=!0,t.schedule=[];return}t.outOfDayNum=!1;var r=t.$dom;t.date.toDateString()===n.today.toDateString()&&(amplify.publish("today",t),t.withOutHandle(function(){$('<p class="month_view_today">今天</p>').insertBefore(t.$dom.find(".month_view_add_schedule_btn"))})),t.withOutHandle(function(){r.find(".month_view_ymd").text(e.formatDate(t.date))}),t.withOutHandle(function(){r.find(".month_view_week").text("周"+t.lunar.cnDay)});var i=r.find(".month_view_solar");t.withOutHandle(function(){t.festival?t.$dom.find(".month_view_festival").text(t.festival.desc):t.$dom.find(".month_view_festival").text("")}),t.withOutHandle(function(){i.text([t.lunar.lMonth,"月",t.lunar.lDate].join(""))})},r.prototype.empty=function(){var e=this;e.withOutHandle(function(){e.$dom.find(".month_view_schedule").empty()})},r.prototype.withOutHandle=function(e){setTimeout(e,function(e,t){return Math.random()*(t-e)+e}(0,1))},r}),define("rebuild/module/listPanel",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/class/GirdForList","rebuild/module/getHolidays","rebuild/module/scheduleData","rebuild/base/solarAndLunar"],function(e,t,n,r){var i=31,s={},o={modeName:"list",report:function(){amplify.publish("initPanelModule",o.modeName,'#ul_view_switcher li[tab="list"]')},checkPanel:function(){var e=arguments[0],n=t.getCurrentPanel();!n&&e===o.modeName&&o.init(),n&&(s.currentPanel=e);if(n===o.modeName&&e!==o.modeName){try{o.destroy()}catch(r){}return}},checkOtherPanelDestroy:function(){var e=arguments[0];e!==o.modeName&&s.currentPanel==o.modeName&&o.init()},destroy:function(){$(window).off(".listPanel"),o.destroyGird(),$(".today_calendar").off(".listPanel"),$("#p_only_hassch").off(".listPanel"),$(".month_view_title").hide(),$("#today_calendar_year_month").hide(),$("#lnk_today").hide(),$("#div_calendar_panel").empty(),amplify.unsubscribe("scheduleViewUpdated",o.checkScheduleUpdated),amplify.unsubscribe("calendarReady",o.position),amplify.unsubscribe("calendarReady",o.checkShowOnly),amplify.unsubscribe("today",o.setToday),amplify.unsubscribe("AcrossTheDay",o.acrossDate),amplify.publish("panelDestroied",o.modeName)},init:function(){o.buildData(),o.buildBaseUI(),o.buildLogic(),amplify.publish("calendarPanelChanged",o.modeName)},buildData:function(){s.html={day:'					<li i={i} class="{evenodd}">						<div class="month_view_date">							<h3><span class="month_view_week"></span><span class="month_view_ymd"></span></h3>							<p><span class="month_view_solar"></span><span class="month_view_festival"></span></p>							<a href="javascript:;" class="month_view_add_schedule_btn none">加日程</a>						</div>						<div class="month_view_schedule">						</div>					</li>'},s.yearDom=$("#sp_year"),s.monthDom=$("#sp_month"),s.prevBtn=$("#lnk_prev"),s.nextBtn=$("#lnk_next"),s.Girds=[],s.today=new Date(+G.currDate),s.date=new Date(+G.currDate),s.month=s.date.getMonth(),s.calendar=new Calendar(s.date),s.fromDate=new Date(s.today),s.fromMonth=s.fromDate.getMonth(),s.dayNum=0,s.holidays=r.getHolidays(),s.girdReady=0,s.needGetScheduleDayRang=null},buildBaseUI:function(){var e=s.html,t=[],n="even";for(var r=0;r<i;r++)n=n=="odd"?"even":"odd",t.push($.format(e.day,{i:r,evenodd:n}));t.unshift('<div id="div_lview" class="month_view_right"><ul id="ul_lview_schdulelist">'),t.unshift(e.head),t.join("</ul></div>"),$("#div_calendar_panel").html(t.join("")),o.resize()},buildLogic:function(){$(window).on("resize.listPanel",o.resize),$(".today_calendar").on("click.listPanel","#lnk_next",o.nextMonth).on("click.listPanel","#lnk_prev",o.prevMonth).on("click.listPanel","#lnk_today",o.today),$("#lnk_today").show(),$("#today_calendar_year_month").show().on("mousewheel.monthPanel","#sp_year",o.wheelYear).on("mousewheel.monthPanel","#sp_month",o.wheelMonth),$(".month_view_title").show(),$("#p_only_hassch").on("click.listPanel",function(e){e.stopPropagation();var t=$(this);t.toggleClass("on"),o.checkShowOnly()}),o.registGrid(),amplify.subscribe("scheduleViewUpdated",o.checkScheduleUpdated),amplify.subscribe("calendarReady",o.checkShowOnly),amplify.subscribe("today",o.setToday),amplify.subscribe("AcrossTheDay",o.acrossDate)},checkShowOnly:function(){amplify.publish("showOnly",$("#p_only_hassch").hasClass("on")),setTimeout(o.position,200)},setToday:function(){s.todayGird=arguments[0]},position:function(){if(t.getCurrentPanel()!=="list")return;try{if(!s.todayGird){$("#div_lview").scrollTop(0);return}var e=s.todayGird.$dom;$("#div_lview").scrollTop(e.offset().top+$("#div_lview").scrollTop()-$("#div_lview").offset().top)}catch(n){}},setDayNum:function(){var e=new Date(s.date);e.setMonth(e.getMonth()+1),e.setDate(0),s.dayNum=e.getDate()},registGrid:function(){var e=s.gird=$("#ul_lview_schdulelist li"),t=null;for(var r=0,i=e.length;r<i;r++)t=new n(e[r],r),t.init(),s.Girds.push(t);o.today()},destroyGird:function(){for(var e=0,t=s.Girds.length;e<t;e++)s.Girds[e].destroy(),s.Girds[e]=null;s.Girds=[]},nextMonth:function(){s.date.setMonth(s.date.getMonth()+1),s.date.setDate(1),o.updateDate()},prevMonth:function(){s.date.setMonth(s.date.getMonth()-1),s.date.setDate(1),o.updateDate()},today:function(){s.date.setYear(s.today.getFullYear()),s.date.setMonth(s.today.getMonth()),s.date.setDate(1),o.updateDate()},acrossDate:function(){s.date.getFullYear()===s.today.getFullYear()&&s.month===s.today.getMonth()&&(s.date=new Date(+G.currDate),s.date.setDate(1)),s.today=new Date(+G.currDate),o.updateDate()},updateDate:function(){s.month=s.date.getMonth(),s.calendar=new Calendar(s.date),s.fromDate=s.date,s.fromMonth=s.fromDate.getMonth(),s.todayGird=null,o.setDayNum(),s.date.getFullYear()!==s.today.getFullYear()||s.month!==s.today.getMonth()?$("#lnk_today").show():$("#lnk_today").hide(),$("#sp_year").text(s.date.getFullYear()),$("#sp_month").text(s.date.getMonth()+1),amplify.publish("dateUpdated",s)},checkScheduleUpdated:function(){s.girdReady===i&&(s.girdReady=0),s.girdReady++,arguments[0]==="noData"&&o.setNeedGetScheduleRang(arguments[1],arguments[2]);if(s.girdReady!==i)return;s.needGetScheduleRang?(amplify.publish("scheduleDataNotEnough",s.needGetScheduleRang),rang=s.needGetScheduleRang=null):(amplify.publish("calendarReady"),amplify.publish("calendarAndScheduleChanged","list"))},setNeedGetScheduleRang:function(e,t){var n=s.needGetScheduleRang,r=new Date(e.replace(/-/g,"/"));n?r<n.begin?n.begin=r:r>n.end&&(n.end=r):(n=s.needGetScheduleRang={},n.begin=n.end=r,n.calendars={});for(var i=0,o=t.length;i<o;i++)n.calendars[t[i]]||(n.calendars[t[i]]=1)},resize:function(){var t=$(".calendar_table"),n=$(window).height(),r=n-$("#div_today").height()-$(".month_view_title").height();e.isPCVersion()||(r-=$(".calendar_header").height()),$("#div_calendar_panel").height(r),amplify.publish("panelResized")}};amplify.subscribe("toChangeCalendarPanel",o.checkPanel),amplify.subscribe("panelReady",o.report),amplify.subscribe("panelDestroied",o.checkOtherPanelDestroy)}),define("rebuild/module/calendarPanel",["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/module/timeClock","rebuild/module/weekPanel","rebuild/module/monthPanel","rebuild/module/listPanel"],function(e,t){var n={},r={init:function(){r.initData()},initData:function(){n.module=t.getNormalPanel(),n.moduleHash={}},setModules:function(){var e=arguments[0],t=arguments[1];n.moduleHash[e]=t,t&&$(t).on("click",function(){r.changeModule(e)}),e===n.module&&r.changeModule(e)},changeModule:function(e){n.module=e;var t=n.moduleHash[e];if(t){var r=$(t);r.parent().find("li").removeClass("on"),r.addClass("on")}amplify.publish("toChangeCalendarPanel",e)}};amplify.subscribe("initApp",r.init),amplify.subscribe("initPanelModule",r.setModules),amplify.publish("panelReady")}),define("rebuild/module/notification",["rebuild/base/common"],function(e){var t=!1,n={timeoutTickets:[],init:function(){if(!("Notification"in window))return;if($.cookie("notification_setting")==="false")return;Notification.permission==="default"?$.alert("您是否需要打开浏览器的提醒功能",{buttons:{"确定":function(){n.requestPermission(function(){n.loadAlarmData()}),$(this).dialog("close")},"取消":function(){$.cookie("notification_setting","false",{expires:365,path:"/"}),$(this).dialog("close")}}}):Notification.permission==="granted"&&n.loadAlarmData()},refresh:function(){if(!("Notification"in window))return;if($.cookie("notification_setting")==="false")return;if(Notification.permission!=="granted")return;t&&console.log("refresh notification timeout");for(var e in n.timeoutTickets){var r=n.timeoutTickets[e];clearTimeout(r)}n.timeoutTickets=[],n.loadAlarmData()},loadAlarmData:function(){$.get("/schedule/getAlarms.do").success(function(e){n.alarmData=e,$.each(e,function(e,t){$.each(t.schlist,function(e,t){t.alarm!==""&&n.setNotification(t)})})})},showNotification:function(e,r,i,s){if(!("Notification"in window))return;var o=setTimeout(function(){if(Notification.permission==="granted"){var t=new Notification(e,{body:r,icon:"/images/logo_72x72.png"});t.onclick=function(){amplify.publish("showSchedule",s)}}},i);n.timeoutTickets.push(o),t&&console.log("setTimeout("+i+","+o+"):"+e+" "+r)},requestPermission:function(e){if(!("Notification"in window))return;Notification.permission!=="granted"&&Notification.requestPermission(function(t){"permission"in Notification||(Notification.permission=t),t==="granted"&&typeof e=="function"&&e()})},setNotification:function(e){var t=e.alarm.split(","),r=new Date,i=new Date(e.start_time.replace(/-/g,"/"));for(var s in t){var o=parseInt(t[s]),u=new Date(i.getTime()-o*6e4),a=u.getTime()-r.getTime();a>0&&n.showNotification(e.start_time,e.text,a,e.id)}}},r={init:function(){js365.downAlarms()}};e.isPCVersion()?(amplify.subscribe("initApp",r.init),amplify.subscribe("alarmChanged",r.init),amplify.subscribe("scheduleDeleted",r.init)):(amplify.subscribe("initApp",n.init),amplify.subscribe("alarmChanged",n.refresh),amplify.subscribe("scheduleDeleted",n.refresh),amplify.subscribe("calendarDeleted",n.refresh),amplify.subscribe("calendarUnsubscribed",n.refresh))}),define("rebuild/module/sync_pc",["rebuild/base/common","rebuild/base/calendar_Protocol"],function(e,t){function n(){if(typeof js365!="undefined"){var e=t.getCalendarListSelectedCld().join(","),n=JSON.stringify(t.getRealCalendarList());if(arguments.length==0){var r=JSON.stringify(t.getScheduleDataForListWidget()),i=JSON.stringify(t.getScheduleDataForCalendarWidget());r=encodeURI(r),i=encodeURI(i),js365.runScriptDeskWnd('$("#div_calendar").webCalendar({"cldIDs":"'+e+'", "calendarList":'+n+', "scheduleList":"'+i+'"});'),js365.runScriptWnd(5,'$(".new_list").widgetList({"cldIDs":"'+e+'", "calendarList":'+n+', "scheduleList":"'+r+'"});')}else js365.runScriptDeskWnd('$("#div_calendar").webCalendar({"cldIDs":"'+e+'", "calendarList":'+n+', "updateBySelf": true});'),js365.runScriptWnd(5,'$(".new_list").widgetList({"cldIDs":"'+e+'", "calendarList":'+n+', "updateBySelf": true});')}}function r(){typeof js365!="undefined"&&js365.runScriptWnd(5,'$(".todo_list_content").calendarPluginTodo();')}if(!e.isPCVersion())return;amplify.subscribe("calendarAndScheduleChanged",n,11),amplify.subscribe("scheduleCreated",n,11),amplify.subscribe("scheduleUpdated",n,11),amplify.subscribe("scheduleDeleted",n,11),amplify.subscribe("initApp",function(){js365.runScriptMainBackgroundWnd('Cmd.calendar("'+G.currUser.username+'");'),r(),e.disableSelectAndRightClick()},11)}),require.config({baseUrl:"/js/"}),require(["rebuild/base/common","rebuild/base/calendar_Protocol","rebuild/module/user","rebuild/module/calendarList","rebuild/module/calendarPanel","rebuild/module/notification","rebuild/module/sync_pc"],function(e){amplify.publish("initApp")}),define("rebuild/base/calendar_bootstrap",function(){});