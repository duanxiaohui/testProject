(function(){var b,c;$.route=function(f,e){f=f||{};var d;(b||(b=/([\d\w_]+)/g)).lastIndex=0;while((d=b.exec(e))!==null){f=f[d[0]];if(f==undefined){break;}}return f;};$.format=function(){var e=$.makeArray(arguments),g=String(e.shift()||""),d=[],f=e[0];e=$.isArray(f)?f:typeof(f)=="object"?e:[e];$.each(e,function(h,j){d.push(g.replace(c||(c=/\{([\d\w\.]+)\}/g),function(i,l,k){k=l==="INDEX"?h:l.indexOf(".")<0?j[l]:$.route(j,l);return k===undefined?i:($.isFunction(k)?k.call(j,l):k);}));});return d.join("");};var a;$.padWithZero=function(d){return d.replace((a||(a=/(^|\D)(\d)(?=$|\D)/g)),"$10$2");};})();function Calendar(a){this.date=a?new Date(+a):(G.currDate||new Date);}Calendar.prototype={getMonthFirstDate:function(){var a=new Date(+this.date);a.setDate(1);return a;},getCalendarFirstDate:function(c){var b=this.getMonthFirstDate(),a=b.getDay();b.setDate(b.getDate()-(c?a:a==0?6:(a-1)));return b;}};$.widget("meixx.webCalendar",{options:{onselect:$.noop},_create:function(){var b=this,a=$(this.element),d=this.options;var c=this.today=new Date(),e=c.getFullYear(),f=c.getMonth()+1;this.panel=a.find("ul#calendar_list");this.tmplDate='<li class="{monthClass}" date="{date}"><div class="calendar_date_box"><div class="rest_txt">休</div><div class="work_txt">班</div><div class="solar_date">{solar}</div><div class="lunar_date" title="{lunar}">{lunar}</div></div></li>';this.initCalendar(e,f);d.onselect.call(b,c,lunar(c));b.selectedDate=c;this.handleClick();this.initDatePicker();},_showCurrentTime:function(){var b=this,a=$(this.element),c=this.options;this.timeContainer=a.find("div.time");setInterval(function(){var e=new Date();b.timeContainer.html($.padWithZero($.format("{getHours}:{getMinutes}:{getSeconds}",e)));},1000);},initCalendar:function(n,k,i){var q=this,e=$(this.element),b=this.options;var l=new Date(n,k-1,1),m=new Calendar(l),a=m.getCalendarFirstDate(true),p=this.today;this.year=l.getFullYear();this.month=l.getMonth()+1;var o=[31,28,31,30,31,30,31,31,30,31,30,31];var g=35;if(l.getDay()==6&&o[l.getMonth()]>=30){g=42;}else{if(l.getDay()==5&&o[l.getMonth()>=31]){g=42;}}var j=new Date(a),f=$.map(new Array(g),function(C,u){var z=j.getFullYear(),c=j.getMonth(),x=j.getDate(),A=j.getDay(),r=lunar(j);var s=[],B="m"+(c+1)+"d"+x;c!=k-1&&s.push("nextbefor");i==x&&c==k-1&&s.push("on");x==p.getDate()&&c==p.getMonth()&&z==p.getFullYear()&&s.push("today");(A==0||A==6)&&s.push("weekend");var v=r.festival();r.term?s.push("solar"):v.length?s.push("isolar"):"";if(worktime[z]){worktime[z]["festival"][B]&&s.push(worktime[z]["festival"][B],"vacation");worktime[z]["workday"][B]&&s.push(worktime[z]["workday"][B]);if(c!=k-1){worktime[z]["festival"][B]&&s.push("before_rest");worktime[z]["workday"][B]&&s.push("before_work");}}j.setDate(j.getDate()+1);var t=v[0]&&v[0].desc.length<7&&v[0].desc||r.term||r.dateIndex==0&&(r.lMonth+"月"+(r.isBigMonth?"大":"小"))||r.lDate;return $.format(q.tmplDate,{monthClass:s.join(" "),solar:x,lunar:t,date:[z,c+1,x].join("/")});});this.panel.html(f);i&&q.festivalClick(this.panel.find("li.on"));if(g==35){this.panel.removeClass("calendar_list").addClass("grid_five");}else{this.panel.removeClass("grid_five").addClass("calendar_list");}var h=n+("0"+k).slice(-2);if(festivalRestData[h]){$(".vacation_txt").html(festivalRestData[h]);}else{$(".vacation_txt").html('数据来源：<a href="http://www.365rili.com" target="_blank">365日历</a>');}},setCalendarDate:function(c){var b=this,a=$(this.element),e=this.options;var g=c.getFullYear();var h=c.getMonth()+1;var i=c.getDate();b.initCalendar(g,h);var f=[g,h,i].join("/");b.panel.find('li[date="'+f+'"]').click();b.dltYear.fakeSelect("setValue",g);b.dltMonth.fakeSelect("setValue",h);b.dltFestival.fakeSelect("setValue",g+("0"+h).slice(-2));},handleClick:function(){var b=this,a=$(this.element),c=this.options;$("li",b.panel).live("click",function(){b.panel.find("li.on").removeClass("on");var i=$(this),f=i.attr("date"),h=new Date(f),e=h.getFullYear(),g=h.getMonth()+1;if(!i.hasClass("today")){i.addClass("on");}b.selectedDate=h;if(g!=b.month||e!=b.year&&b.dltYear.fakeSelect("hasValue",e)){b.dltYear.fakeSelect("setValue",e);b.dltMonth.fakeSelect("setValue",g);b.dltMonth.fakeSelect("triggerChange");b.panel.find('li[date="'+f+'"]').click();}else{c.onselect.call(b,h,lunar(h));}});},festivalClick:function(g){var b=this,a=$(this.element),c=this.options;var e=g.attr("date"),f=new Date(e);c.onselect.call(b,f,lunar(f));},initDatePicker:function(){var c=this,b=$(this.element),e=this.options;var d=function(j){var h,i;if(this.name=="year"){h=j;i=c.dltMonth.fakeSelect("getValue");j+=("0"+i).slice(-2);}else{h=c.dltYear.fakeSelect("getValue");i=j;j=h+("0"+i).slice(-2);}c.initCalendar(h,i);var g=[h,i,c.selectedDate.getDate()].join("/");c.panel.find('li[date="'+g+'"]').click();c.dltFestival.fakeSelect("setValue",j);};var a=function(j){var g=j.slice(0,4)-0,i=j.slice(4,6)-0,h=j.slice(-2)-0;c.initCalendar(g,i,h);c.dltYear.fakeSelect("setValue",g);c.dltMonth.fakeSelect("setValue",i);};this.dltYear=b.find("div.y_select").fakeSelect({name:"year",value:this.today.getFullYear(),onchange:d,data:$.map(new Array(2100-1900),function(g,h){var j=1901+h;return{value:j,text:j+"年"};})});this.dltMonth=b.find("div.m_select").fakeSelect({name:"month",value:this.today.getMonth()+1,onchange:d,circle:true,data:$.map(new Array(12),function(g,h){var j=h+1;return{value:j,text:j+"月"};})});function f(g){g=g.split("_");g[1]=g[1]<10?"0"+g[1]:g[1];g[2]=g[2]<10?"0"+g[2]:g[2];return g.join("");}this.dltFestival=b.find("div.vacation_btn").fakeSelect({name:"festival",onchange:a,title:"假日",data:[{value:f(festivalData.yuandan),text:"元旦"},{value:f(festivalData.chunjie),text:"春节"},{value:f(festivalData.qingmingjie),text:"清明节"},{value:f(festivalData.laodong),text:"劳动节"},{value:f(festivalData.duanwu),text:"端午节"},{value:f(festivalData.zhongqiu),text:"中秋节"},{value:f(festivalData.guoqing),text:"国庆节"}]});this.btnToday=b.find("a.today_btn").click(function(g){g.preventDefault();c.dltYear.fakeSelect("setValue",c.today.getFullYear());c.dltMonth.fakeSelect("setValue",c.today.getMonth()+1);c.dltMonth.fakeSelect("triggerChange");c.panel.find("li.today").click();});b.find(".next").click(function(g){var i=parseInt(c.dltYear.fakeSelect("getValue"));var j=parseInt(c.dltMonth.fakeSelect("getValue"));j++;if(j>12){i++;j=1;}c.initCalendar(i,j);c.dltYear.fakeSelect("setValue",i);c.dltMonth.fakeSelect("setValue",j);var h=i+("0"+j).slice(-2);c.dltFestival.fakeSelect("setValue",h);});b.find(".prve").click(function(g){var i=parseInt(c.dltYear.fakeSelect("getValue"));var j=parseInt(c.dltMonth.fakeSelect("getValue"));j--;if(j<1){i--;j=12;}c.initCalendar(i,j);c.dltYear.fakeSelect("setValue",i);c.dltMonth.fakeSelect("setValue",j);var h=i+("0"+j).slice(-2);c.dltFestival.fakeSelect("setValue",h);});}});(function(){$.widget("meixx.fakeSelect",{options:{data:[],onchange:$.noop,value:"",circle:false},_create:function(){var b=this,a=$(this.element),d=this.options;this.name=d.name;this.prev=a.find("a.left_arrow");this.next=a.find("a.right_arrow");this.cont=a.find("div.dropselectbox");this.header=a.find("h4");this.list=this.cont.find("ul");this.list.html($.format('<li val="{value}">{text}</li>',d.data));this.opts=this.list.find("li");this.header.click(function(){b.list.toggle();if(b.list.is(":visible")){var f=b.header.attr("val")||"",e=b.opts.removeClass("on").filter('[val="'+f+'"]').addClass("on");e.size()&&b.list.scrollTop(e.prop("offsetTop")-51);}});this.opts.mouseenter(function(){b.opts.removeClass("on");$(this).addClass("on");}).click(function(e){b.list.hide();var i=$(this).addClass("on"),h=i.attr("val"),g=i.text(),f=b.header.attr("val");if(f!=h){b.header.html(g).attr("val",h);h&&d.onchange.call(b,h,f);}});this.header.mousedown(function(){$(this).addClass("active");});this.header.mouseup(function(){$(this).removeClass("active");});this.header.mousedown(function(){b.opts.removeClass("active");$(this).addClass("active");});if(this.prev.size()){this.prev.add(this.next).click(function(f){f.preventDefault();var e=$(this),h=b.header.attr("val")||"",g=b.opts.filter('[val="'+h+'"]');if(g.size()){g=g[e.attr("method")]();if(g.size()){g.triggerHandler("click");}}});}var c=b.opts.filter('[val="'+d.value+'"]');b.header.html(c.text()).attr("val",c.attr("val"));if(d.title){b.header.html(d.title);}$("body").click(function(e){if(!b.cont.find(e.target).size()){b.list.hide();b.cont.find(".scroll_box").hide();}});},hasValue:function(e){var b=this,a=$(this.element),d=this.options;var c=b.opts.filter('[val="'+e+'"]');return c.size()?c:null;},setValue:function(e){var b=this,a=$(this.element),d=this.options;var c=this.hasValue(e);if(c){this.header.attr("val",e).text(c.text());}else{}},getValue:function(){return this.header.attr("val");},triggerChange:function(){this.options.onchange.call(this,this.header.attr("val"),"");}});})();$.widget("meixx.dayDetail",{options:{},_create:function(){var b=this,a=$(this.element),c=this.options;this.tmpl='<div class="almanac_solar_info">{year}年{padmonth}月{paddate}日 {week}</div><div class="alm_content{nofestival}">{istoday}		<div class="almanac_date">{date}</div><div class="almanac_lunar_info"><p>{gzyear}年 【{animal}年】 {lmonth}月{ldate}</p><p class="attribution">{gzmonth}月 {gzdate}日</p></div>		<div class="almanac_txt"><p class="yi almanac_p"></p><p class="ji almanac_p"></p>		<div class="almanc_layer"><h3>{year}年{padmonth}月{paddate}日<span>{lmonth}月{ldate}</span></h3>			<div class="almanc_layer_content">			<div class="almanc_layer_yi e_clear">			<div class="yi_icon">宜</div>			<div class="yi_txt"></div></div>			<div class="almanc_layer_ji e_clear">			<div class="ji_icon">忌</div>			<div class="ji_txt"></div>		</div></div></div></div></div>';},init:function(f,h){var k=this,e=$(this.element),c=this.options;var j=f.getFullYear(),g=f.getMonth()+1,i=f.getDate(),b=new Date(),a=h.festival();e.html($.format(this.tmpl,{year:j,padmonth:("0"+g).slice(-2),paddate:("0"+i).slice(-2),date:i,week:"星期"+h.cnDay,animal:h.animal,istoday:b.getDate()==i&&b.getMonth()==f.getMonth()&&b.getFullYear()==j?'<div class="today_icon"></div>':"",lmonth:h.lMonth,ldate:h.lDate,nofestival:a.length||h.term?"":" nofestival",festival:a.length&&$.trim($.format("{desc} ",a))||h.term||"",gzyear:h.gzYear,gzmonth:h.gzMonth,gzdate:h.gzDate}));this.loadLuckyData(j,g,i);e.find(".almanac_p").mouseover(function(){e.find(".almanc_layer").show();}).mouseout(function(){e.find(".almanc_layer").hide();});},loadLuckyData:function(h,a,g){var c=this,b=$(this.element),e=this.options;var f="d"+("0"+a).slice(-2)+("0"+g).slice(-2);if(window.HuangLi&&HuangLi["y"+h]){this.fillLuckyData(HuangLi["y"+h][f]);}else{if(h>2007&&h<2021){$.getScript("/js/huangli/hl"+h+".js",function(){c.fillLuckyData(HuangLi["y"+h][f]);});}else{this.fillLuckyData({y:"",j:"",});}}},fillLuckyData:function(e){var b=this,a=$(this.element),d=this.options;var f=e.y.replace(/^\.|\.$/g,"").split("."),c=e.j.replace(/^\.|\.$/g,"").split(".");a.find("p.yi").html("宜： "+dealString(f,true));a.find("p.ji").html("忌： "+dealString(c,true));a.find(".yi_txt").html(dealString(f,false));a.find(".ji_txt").html(dealString(c,false));if(f==""){$(".yi_icon").hide();$(".yi").hide();}else{if(c==""){$(".ji_icon").hide();$(".ji").hide();}}}});function dealString(a,c){a=a.sort(function(e,d){return e.length-d.length;});var b=[];$.each(a,function(d,e){b.push("<span>"+e+"</span>");});if(c){return b.slice(0,4).join("");}else{return b.join("");}}var festivalRestData={};festivalRestData[globalData.targetYear+"01"]=fangjiaData.yuandan;festivalRestData[globalData.targetYear+"02"]=fangjiaData.chunjie;festivalRestData[globalData.targetYear+"04"]=fangjiaData.qingmingjie;festivalRestData[globalData.targetYear+"05"]=fangjiaData.laodong;festivalRestData[globalData.targetYear+"06"]=fangjiaData.duanwu;festivalRestData[globalData.targetYear+"09"]=fangjiaData.zhongqiu;festivalRestData[globalData.targetYear+"10"]=fangjiaData.guoqing;$(function(){var a=$("#calendar_almanac");a.dayDetail();$("#calendar_container").webCalendar({onselect:function(c,b){a.dayDetail("init",c,b);}});triggerFestival();});function triggerFestival(){var e=getURLParameter("so_param");if(e){if(e=="yuandan"){$("#festival_select li[val='20140101']").click();}else{if(e=="chunjie"){$("#festival_select li[val='20140201']").click();}else{if(e=="qingming"){$("#festival_select li[val='20140405']").click();}else{if(e=="laodong"){$("#festival_select li[val='20140501']").click();}else{if(e=="duanwu"){$("#festival_select li[val='20140602']").click();}else{if(e=="zhongqiu"){$("#festival_select li[val='20140908']").click();}else{if(e=="guoqing"){$("#festival_select li[val='20141001']").click();}else{if(e=="rili_2012"){var g=new Date();g.setFullYear(2012);g.setMonth(0);g.setDate(1);$("#calendar_container").webCalendar("setCalendarDate",g);}else{if(e=="rili_2014"){var g=new Date();g.setFullYear(2014);g.setMonth(0);g.setDate(1);$("#calendar_container").webCalendar("setCalendarDate",g);}else{var c=e.split("-");var b=c[0],f=c[1],a=c[2];if(f[0]==0){f=parseInt(f[1]);}else{f=parseInt(f);}if(a[0]==0){a=parseInt(a[1]);}else{a=parseInt(a);}var g=new Date();g.setFullYear(b);g.setMonth(f-1);g.setDate(a);$("#calendar_container").webCalendar("setCalendarDate",g);}}}}}}}}}}else{return;}}function getURLParameter(a){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null;}