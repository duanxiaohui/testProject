var JSON=function(){var a={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b={"boolean":function(a){return String(a)},number:function(a){return isFinite(a)?String(a):"null"},string:function(c){/["\\\x00-\x1f]/.test(c)&&(c=c.replace(/([\x00-\x1f\\"])/g,function(c,b){var f=a[b];if(f)return f;f=b.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)}));return'"'+c+'"'},object:function(a){if(a){var d=[],e,f,g,i,h;if(a instanceof Array){d[0]=
"[";i=a.length;for(g=0;g<i;g+=1)if(h=a[g],f=b[typeof h])h=f(h),typeof h=="string"&&(e&&(d[d.length]=","),d[d.length]=h,e=true);d[d.length]="]"}else if(a instanceof Object){d[0]="{";for(g in a)if(h=a[g],f=b[typeof h])h=f(h),typeof h=="string"&&(e&&(d[d.length]=","),d.push(b.string(g),":",h),e=true);d[d.length]="}"}else return;return d.join("")}return"null"}};return{copyright:"(c)2005 JSON.org",license:"http://www.crockford.com/JSON/license.html",stringify:function(a){var d=b[typeof a];return d&&(a=
d(a),typeof a=="string")?a:null},parse:function(a){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+a+")")}catch(b){return false}}}}(),lunarInfo=[19416,19168,42352,21717,53856,55632,21844,22191,39632,21970,19168,42422,42192,53840,53909,46415,54944,44450,38320,18807,18815,42160,46261,27216,27968,43860,11119,38256,21234,18800,25958,54432,59984,27285,23263,11104,34531,37615,51415,51551,54432,55462,46431,22176,42420,9695,37584,53938,43344,46423,27808,46416,
21333,19887,42416,17779,21183,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,38310,38335,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,20854,21183,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,
53430,53855,54560,56645,46496,22224,21938,18864,42359,42160,43600,45653,27951,44448,19299,37759,18936,18800,25776,26790,59999,27424,42692,43759,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,19285,19311,42352,21732,53856,59752,54560,55968,27302,22239,19168,43476,42192,53584,62034,54560],solarMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Gan="\u7532,\u4e59,\u4e19,\u4e01,\u620a,\u5df1,\u5e9a,\u8f9b,\u58ec,\u7678".split(","),
Zhi="\u5b50,\u4e11,\u5bc5,\u536f,\u8fb0,\u5df3,\u5348,\u672a,\u7533,\u9149,\u620c,\u4ea5".split(","),Animals="\u9f20,\u725b,\u864e,\u5154,\u9f99,\u86c7,\u9a6c,\u7f8a,\u7334,\u9e21,\u72d7,\u732a".split(","),solarTerm="\u5c0f\u5bd2,\u5927\u5bd2,\u7acb\u6625,\u96e8\u6c34,\u60ca\u86f0,\u6625\u5206,\u6e05\u660e,\u8c37\u96e8,\u7acb\u590f,\u5c0f\u6ee1,\u8292\u79cd,\u590f\u81f3,\u5c0f\u6691,\u5927\u6691,\u7acb\u79cb,\u5904\u6691,\u767d\u9732,\u79cb\u5206,\u5bd2\u9732,\u971c\u964d,\u7acb\u51ac,\u5c0f\u96ea,\u5927\u96ea,\u51ac\u81f3".split(","),
sTermInfo=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758],nStr1="\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d,\u4e03,\u516b,\u4e5d,\u5341".split(","),nStr2=["\u521d","\u5341","\u5eff","\u5345","\u25a1"],monthName="JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC".split(","),cmonthName="\u6b63,\u4e8c,\u4e09,\u56db,\u4e94,\u516d,\u4e03,\u516b,\u4e5d,\u5341,\u5341\u4e00,\u814a".split(","),
sFtv="0101*\u5143\u65e6,0214 \u60c5\u4eba\u8282,0308 \u5987\u5973\u8282,0312 \u690d\u6811\u8282,0401 \u611a\u4eba\u8282,0422 \u5730\u7403\u65e5,0501 \u52b3\u52a8\u8282,0504 \u9752\u5e74\u8282,0531 \u65e0\u70df\u65e5,0601 \u513f\u7ae5\u8282,0606 \u7231\u773c\u65e5,0701 \u5efa\u515a\u65e5,0707 \u6297\u6218\u7eaa\u5ff5\u65e5,0801 \u5efa\u519b\u8282,0910 \u6559\u5e08\u8282,0918 \u4e5d\u00b7\u4e00\u516b\u4e8b\u53d8\u7eaa\u5ff5\u65e5,1001*\u56fd\u5e86\u8282,1031 \u4e07\u5723\u8282,1111 \u5149\u68cd\u8282,1201 \u827e\u6ecb\u75c5\u65e5,1213 \u5357\u4eac\u5927\u5c60\u6740\u7eaa\u5ff5\u65e5,1224 \u5e73\u5b89\u591c,1225 \u5723\u8bde\u8282".split(","),
wFtv=["0520 \u6bcd\u4eb2\u8282","0630 \u7236\u4eb2\u8282","1144 \u611f\u6069\u8282"],lFtv="0101*\u6625\u8282,0115 \u5143\u5bb5\u8282,0202 \u9f99\u62ac\u5934,0505 \u7aef\u5348\u8282,0707 \u4e03\u5915,0715 \u4e2d\u5143\u8282,0815 \u4e2d\u79cb\u8282,0909 \u91cd\u9633\u8282,1208 \u814a\u516b\u8282,1223 \u5c0f\u5e74,0100*\u9664\u5915".split(",");function lYearDays(a){var b,c=348;for(b=32768;b>8;b>>=1)c+=lunarInfo[a-1900]&b?1:0;return c+leapDays(a)}
function leapDays(a){return leapMonth(a)?(lunarInfo[a-1899]&15)==15?30:29:0}function leapMonth(a){a=lunarInfo[a-1900]&15;return a==15?0:a}function monthDays(a,b){return lunarInfo[a-1900]&65536>>b?30:29}
function Lunar(a){for(var b=0,c=0,d=(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(1900,0,31))/864E5,a=1900;a<2100&&d>0;a++)c=lYearDays(a),d-=c;d<0&&(d+=c,a--);this.year=a;b=leapMonth(a);this.isLeap=false;for(a=1;a<13&&d>0;a++){b>0&&a==b+1&&this.isLeap==false?(--a,this.isLeap=true,c=leapDays(this.year)):c=monthDays(this.year,a);if(this.isLeap==true&&a==b+1)this.isLeap=false;d-=c}if(d==0&&b>0&&a==b+1)this.isLeap?this.isLeap=false:(this.isLeap=true,--a);d<0&&(d+=c,--a);this.month=a;this.day=
d+1}function getSolarDate(a,b,c,d){for(var e=0,f=1900;f<a;f++)e+=lYearDays(f);for(f=1;f<b;f++)f==leapMonth(a)&&(e+=leapDays(a)),e+=monthDays(a,f);d&&(e+=monthDays(a,f));e+=parseInt(c)-1;return new Date((new Date(1900,0,31)).valueOf()+e*864E5)}function solarDays(a,b){return b==1?a%4==0&&a%100!=0||a%400==0?29:28:solarMonth[b]}function cyclical(a){return Gan[a%10]+Zhi[a%12]}
function calElement(a,b,c,d,e,f,g,i,h,k,l){this.isToday=false;this.sYear=a;this.sMonth=b;this.sDay=c;this.week=d;this.lYear=e;this.lMonth=f;this.lDay=g;this.isLeap=i;this.cYear=h;this.cMonth=k;this.cDay=l;this.solarTerms=this.solarFestival=this.lunarFestival=this.color=""}function sTerm(a,b){return(new Date(3.15569259747E10*(a-1900)+sTermInfo[b]*6E4+Date.UTC(1900,0,6,2,5))).getUTCDate()}
function calendar(a,b){var c,d,e,f,g=1,i=0,h,k,l=Array(3),m=0,o=0;c=new Date(a,b,1,0,0,0,0);this.length=solarDays(a,b);this.firstWeek=c.getDay();h=b<2?cyclical(a-1900+36-1):cyclical(a-1900+36);var p=sTerm(a,2),q=sTerm(a,b*2);k=cyclical((a-1900)*12+b+12);for(var n=Date.UTC(a,b,1,0,0,0,0)/864E5+25577,j=0;j<this.length;j++){if(g>i)c=new Date(a,b,j+1),d=new Lunar(c),e=d.year,f=d.month,g=d.day,i=(d=d.isLeap)?leapDays(e):monthDays(e,f),m==0&&(o=f),l[m++]=j-g+1;b==1&&j+1==p&&(h=cyclical(a-1900+36));j+1==
q&&(k=cyclical((a-1900)*12+b+13));c=cyclical(n+j);this[j]=new calElement(a,b+1,j+1,nStr1[(j+this.firstWeek)%7],e,f,g++,d,h,k,c)}e=sTerm(a,b*2)-1;f=sTerm(a,b*2+1)-1;this[e].solarTerms=solarTerm[b*2];this[f].solarTerms=solarTerm[b*2+1];for(j in sFtv)if(sFtv[j].match(/^(\d{2})(\d{2})([\s\*])(.+)$/)&&Number(RegExp.$1)==b+1&&(this[Number(RegExp.$2)-1].solarFestival+=RegExp.$4+" ",RegExp.$3=="*"))this[Number(RegExp.$2)-1].color="red";for(j in wFtv)wFtv[j].match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/)&&Number(RegExp.$1)==
b+1&&(e=Number(RegExp.$2),f=Number(RegExp.$3),e<5?this[(this.firstWeek>f?7:0)+7*(e-1)+f-this.firstWeek].solarFestival+=RegExp.$5+" ":(e-=5,g=(this.firstWeek+this.length-1)%7,this[this.length-g-7*e+f-(f>g?7:0)-1].solarFestival+=RegExp.$5+" "));for(j in lFtv)if(lFtv[j].match(/^(\d{2})(.{2})([\s\*])(.+)$/)&&(e=Number(RegExp.$1)-o,e==-11&&(e=1),e>=0&&e<m&&(f=l[e]+Number(RegExp.$2)-1,f>=0&&f<this.length&&this[f].isLeap!=true&&(this[f].lunarFestival+=RegExp.$4+" ",RegExp.$3=="*"))))this[f].color="red"}
function easter(a){var b=sTerm(a,5),b=new Date(Date.UTC(a,2,b,0,0,0,0)),c=new Lunar(b),a=c.day<15?15-c.day:(c.isLeap?leapDays(a):monthDays(a,c.month))-c.day+15,a=new Date(b.getTime()+864E5*a),a=new Date(a.getTime()+864E5*(7-a.getUTCDay()));this.m=a.getUTCMonth();this.d=a.getUTCDate()}function cDay(a){var b;switch(a){case 10:b="\u521d\u5341";break;case 20:b="\u4e8c\u5341";break;case 30:b="\u4e09\u5341";break;default:b=nStr2[Math.floor(a/10)],b+=nStr1[a%10]}return b}var worktime={};worktime.y2011=JSON.parse('{"d0402":{"w":"\u4e0a\u73ed"},"d0403":{"w":"\u653e\u5047"},"d0404":{"w":"\u653e\u5047"},"d0405":{"w":"\u653e\u5047"},"d0430":{"w":"\u653e\u5047"},"d0501":{"w":"\u653e\u5047"},"d0502":{"w":"\u653e\u5047"},"d0604":{"w":"\u653e\u5047"},"d0605":{"w":"\u653e\u5047"},"d0606":{"w":"\u653e\u5047"},"d0910":{"w":"\u653e\u5047"},"d0911":{"w":"\u653e\u5047"},"d0912":{"w":"\u653e\u5047"},"d1001":{"w":"\u653e\u5047"},"d1002":{"w":"\u653e\u5047"},"d1003":{"w":"\u653e\u5047"},"d1004":{"w":"\u653e\u5047"},"d1005":{"w":"\u653e\u5047"},"d1006":{"w":"\u653e\u5047"},"d1007":{"w":"\u653e\u5047"},"d1008":{"w":"\u4e0a\u73ed"},"d1009":{"w":"\u4e0a\u73ed"},"d1231":{"w":"\u4e0a\u73ed"}}');
worktime.y2012=JSON.parse('{"d0101":{"w":"\u653e\u5047"},"d0102":{"w":"\u653e\u5047"},"d0103":{"w":"\u653e\u5047"},"d0121":{"w":"\u4e0a\u73ed"},"d0122":{"w":"\u653e\u5047"},"d0123":{"w":"\u653e\u5047"},"d0124":{"w":"\u653e\u5047"},"d0125":{"w":"\u653e\u5047"},"d0126":{"w":"\u653e\u5047"},"d0127":{"w":"\u653e\u5047"},"d0128":{"w":"\u653e\u5047"},"d0129":{"w":"\u4e0a\u73ed"},"d0331":{"w":"\u4e0a\u73ed"},"d0401":{"w":"\u4e0a\u73ed"},"d0402":{"w":"\u653e\u5047"},"d0403":{"w":"\u653e\u5047"},"d0404":{"w":"\u653e\u5047"},"d0428":{"w":"\u4e0a\u73ed"},"d0429":{"w":"\u653e\u5047"},"d0430":{"w":"\u653e\u5047"},"d0501":{"w":"\u653e\u5047"},"d0622":{"w":"\u653e\u5047"},"d0623":{"w":"\u653e\u5047"},"d0624":{"w":"\u653e\u5047"},"d0929":{"w":"\u4e0a\u73ed"},"d0930":{"w":"\u653e\u5047"},"d1001":{"w":"\u653e\u5047"},"d1002":{"w":"\u653e\u5047"},"d1003":{"w":"\u653e\u5047"},"d1004":{"w":"\u653e\u5047"},"d1005":{"w":"\u653e\u5047"},"d1006":{"w":"\u653e\u5047"},"d1007":{"w":"\u653e\u5047"}}');
var festival_main={"2012_01_01":"\u5143\u65e6","2012_01_23":"\u6625\u8282","2012_04_04":"\u6e05\u660e\u8282","2012_05_01":"\u52b3\u52a8\u8282","2012_06_23":"\u7aef\u5348\u8282","2012_09_30":"\u4e2d\u79cb\u8282","2012_10_01":"\u56fd\u5e86\u8282"};$.dom=function(a){return document.getElementById(a)};function StringBuffer(){this._strings=[]}StringBuffer.prototype.append=function(a){this._strings.push(a);return this};
StringBuffer.prototype.toString=function(){return this._strings.join(arguments.length==0?"":arguments[0])};String.prototype.leftpad=function(a,b){b||(b="0");for(var c="",d=0;d<a-this.length;d++)c+=b;return c+this};String.prototype.htmlspecialchars=function(){return this};function getMonthKey(a,b){return a.toString()+(b+1).toString().leftpad(2)}function getDateKey(a){return a.getFullYear().toString()+"-"+(a.getMonth()+1).toString().leftpad(2)+"-"+a.getDate().toString().leftpad(2)}
function is_leap_year(a){return a%400==0||a%100!=0&&a%4==0?1:0}function getDaysByMonth(a){return[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]][is_leap_year(a.getFullYear())][a.getMonth()]}function dateDiff(a,b){var c=dateDiffDays(a,b);return c==0?"\u4eca\u5929":c<0?0-c+"\u5929\u524d":c+"\u5929\u540e"}function dateDiffDays(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate()),d=new Date(b.getFullYear(),b.getMonth(),b.getDate());return parseInt((d-c)/864E5)}
var utils={getEvent:function(a){return window.event?window.event:a?a:null},getMousePosition:function(a){a=this.getEvent(a);return a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.documentElement.scrollLeft-document.documentElement.clientLeft,y:a.clientY+document.documentElement.scrollTop-document.documentElement.clientTop}},getClientWidth:function(){return $.browser.msie?ieBody.clientWidth:window.innerWidth},getClientHeight:function(){return $.browser.msie?ieBody.clientHeight:window.innerHeight},
getRandomColor:function(){var a=Math.round(Math.random()*(colors.length-1));return{index:a,value:colors[a]}},getOffsetXY:function(a,b){var c={};if(b)return c=$(a).position(),{x:c.left,y:c.top};c=$(a).offset();return{x:c.left,y:c.top}},hideDialog:function(a){for(var b=0;b<a.length;b++)$("#"+a[b]).hide(),$(document).unbind("mousedown."+a[b])},mousedown_hide_ele:function(a,b,c){$(document).bind("mousedown."+a,function(d){for(var d=d.target,e=document.getElementById(a);;)if(d==e)return true;else try{if(d.id==
b)return $(document).unbind("mousedown."+a),$("#"+a).hide(),false;else{if(d.id==c)break;d=$(d).parent()[0]}}catch(f){return false}})}},cacheMgr={cldCache:{},getCld:function(a,b){var c=getMonthKey(a,b),d=this.cldCache[c];typeof d=="undefined"&&(d=new calendar(a,b),this.cldCache[c]=d);return d}},cal365={date:{date_part:function(a){a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},month_day:function(a){return(a||new Date).getDate()},time_part:function(a){return(a.valueOf()/
1E3-a.getTimezoneOffset()*60)%86400},week_start:function(a,b){var c=a.getDay();b&&(c==0?c=6:c--);return this.date_part(this.add(a,-1*c,"day"))},month_start:function(a){a.setDate(1);return this.date_part(a)},month_view_start:function(a,b){return this.week_start(this.month_start(a),b)},year_start:function(a){a.setMonth(0);return this.month_start(a)},day_start:function(a){return this.date_part(a)},add:function(a,b,c){var d=new Date(a.valueOf());switch(c){case "day":d.setDate(d.getDate()+b);break;case "week":d.setDate(d.getDate()+
7*b);break;case "month":d.setMonth(d.getMonth()+b);break;case "year":d.setYear(d.getFullYear()+b);break;case "hour":d.setHours(d.getHours()+b);break;case "minute":d.setMinutes(d.getMinutes()+b);break;default:return defaults.date["add_"+c](a,b,c)}return d},to_fixed:function(a){return a<10?"0"+a:a},copy:function(a){return new Date(a.valueOf())},getChinaNum:function(a){var b;switch(a){case 1:b="\u4e00";break;case 2:b="\u4e8c";break;case 3:b="\u4e09";break;case 4:b="\u56db";break;case 5:b="\u4e94";break;
case 6:b="\u516d";break;case 7:b="\u4e03";break;case 8:b="\u516b";break;case 9:b="\u4e5d";break;case 10:b="\u5341";break;case 11:b="\u5341\u4e00";break;case 12:b="\u814a"}return b},getDayNameBrief:function(a){return"SUN,MON,TUE,WED,THU,FRI,SAT".split(",")[a]},daynameToIndex:function(a){return{SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6}[a]},getWeekOfMonth:function(a,b){var c=this.copy(a);return Math.floor((this.date_part(c).getTime()-this.month_view_start(c,b).getTime())/6048E5)+1},lunar_year:function(a){return a.getFullYear()+
"\u5e74"+(a.getMonth()+1)+"\u6708 "+cyclical(a.getFullYear()-1900+36)+"\u5e74\u3010"+Animals[(a.getFullYear()-4)%12]+"\u5e74\u3011"},lunar_Info:function(a){var b=cacheMgr.getCld(a.getFullYear(),a.getMonth()),a=a.getDate(),b=b[a-1],a={l_day:"",l_month:"",l_day_full:""};a.l_day=cDay(b.lDay);a.l_month=b.lMonth;a.color="";var c,d;c=b.lunarFestival;if(c.length>0)c.length>6&&(d=c.toString(),c=c.substr(0,4)+"..."),a.color="#32CD32";else if(c=b.solarTerms,d=c.toString(),c.length>0&&(a.color="#32CD32",c==
"\u6e05\u660e"||c=="\u8292\u79cd"||c=="\u590f\u81f3"||c=="\u51ac\u81f3"))a.color="#32CD32",c=="\u6e05\u660e"&&(c="\u6e05\u660e\u8282");a.l_day_y=cDay(b.lDay);if(c.length>0)a.l_day=c,a.l_day_full=d;return a},date_to_str:function(a,b){a=a.replace(/%[a-zA-Z]/g,function(a){switch(a){case "%d":return'"+cal365.date.to_fixed(date.getDate())+"';case "%m":return'"+cal365.date.to_fixed((date.getMonth()+1))+"';case "%j":return'"+date.getDate()+"';case "%n":return'"+(date.getMonth()+1)+"';case "%y":return'"+cal365.date.to_fixed(date.getYear()%100)+"';
case "%Y":return'"+date.getFullYear()+"';case "%D":return'"+cal365.locale.date.day_short[date.getDay()]+"';case "%l":return'"+cal365.locale.date.day_full[date.getDay()]+"';case "%M":return'"+cal365.locale.date.month_short[date.getMonth()]+"';case "%F":return'"+cal365.locale.date.month_full[date.getMonth()]+"';case "%h":return'"+cal365.date.to_fixed((date.getHours()+11)%12+1)+"';case "%H":return'"+cal365.date.to_fixed(date.getHours())+"';case "%i":return'"+cal365.date.to_fixed(date.getMinutes())+"';
case "%a":return'"+(date.getHours()>11?"pm":"am")+"';case "%A":return'"+(date.getHours()>11?"PM":"AM")+"';case "%s":return'"+cal365.date.to_fixed(date.getSeconds())+"';default:return a}});b&&(a=a.replace(/date\.get/g,"date.getUTC"));return new Function("date",'return "'+a+'";')},numToWeek:function(a){switch(a){case 1:return"\u4e00";case 2:return"\u4e8c";case 3:return"\u4e09";case 4:return"\u56db";case 5:return"\u4e94";case 6:return"\u516d";case 0:return"\u65e5"}},str_to_date:function(a,b){for(var c=
"var temp=date.split(/[^0-9a-zA-Z]+/g);",d=a.match(/%[a-zA-Z]/g),e=0;e<d.length;e++)switch(d[e]){case "%j":case "%d":c+="set[2]=temp["+e+"]||0;";break;case "%n":case "%m":c+="set[1]=(temp["+e+"]||1)-1;";break;case "%y":c+="set[0]=temp["+e+"]*1+(temp["+e+"]>50?1900:2000);";break;case "%h":case "%H":c+="set[3]=temp["+e+"]||0;";break;case "%i":c+="set[4]=temp["+e+"]||0;";break;case "%Y":c+="set[0]=temp["+e+"]||0;";break;case "%a":case "%A":c+="set[3]=set[3]%12+((temp["+e+"]||'').toLowerCase()=='am'?0:12);";
break;case "%s":c+="set[5]=temp["+e+"]||0;"}d="set[0],set[1],set[2],set[3],set[4],set[5]";b&&(d=" Date.UTC("+d+")");return new Function("date","var set=[0,0,0,0,0,0]; "+c+" return new Date("+d+");")}},templates:{},config:{default_date:"%Y-%m-%d %H:%i",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%Y/%m/%d %H:%i",api_date:"%Y-%m-%d %H:%i",server_utc:false}};
cal365.init_templates=function(){var a=cal365.date.date_to_str,b=cal365.config;(function(a,b){for(var e in b)a[e]||(a[e]=b[e])})(cal365.templates,{day_date:a(b.default_date),month_date:a(b.month_date),week_date:function(a,b){return cal365.templates.day_date(a)+" &ndash; "+cal365.templates.day_date(cal365.date.add(b,-1,"day"))},day_scale_date:a(b.default_date),month_scale_date:a(b.week_date),week_scale_date:a(b.day_date),hour_scale:a(b.hour_date),time_picker:a(b.hour_date),event_date:a(b.hour_date),
month_day:a(b.month_day),xml_date:cal365.date.str_to_date(b.xml_date,b.server_utc),load_format:a(b.load_date,b.server_utc),xml_format:a(b.xml_date,b.server_utc),api_date:cal365.date.str_to_date(b.api_date),event_header:function(a,b){return cal365.templates.event_date(a)+" - "+cal365.templates.event_date(b)},event_text:function(a,b,e){return e.text},event_class:function(){return""},month_date_class:function(){return""},week_date_class:function(){return""},event_bar_date:function(a){return cal365.templates.event_date(a)+
" "},event_bar_text:function(a,b,e){return e.text}})};
cal365.locale={date:{month_full:"\u4e00\u6708,\u4e8c\u6708,\u4e09\u6708,\u56db\u6708,\u4e94\u6708,\u516d\u6708,\u4e03\u6708,\u516b\u6708,\u4e5d\u6708,\u5341\u6708,\u5341\u4e00\u6708,\u5341\u4e8c\u6708".split(","),month_short:"1\u6708,2\u6708,3\u6708,4\u6708,5\u6708,6\u6708,7\u6708,8\u6708,9\u6708,10\u6708,11\u6708,12\u6708".split(","),day_full:"\u661f\u671f\u65e5,\u661f\u671f\u4e00,\u661f\u671f\u4e8c,\u661f\u671f\u4e09,\u661f\u671f\u56db,\u661f\u671f\u4e94,\u661f\u671f\u516d".split(","),day_short:"\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(",")}};
var tplMgr={tplMap:{},getInstance:function(a){var b=this.tplMap[a];b||(b=new jCT($.dom(a).value),b.Build(),this.tplMap[a]=b);return b},getTemplate:function(a){var a=$.dom(a),b=a.value;if(b==null)b=a.innerHTML;return b=b.replace(/&lt;/g,"<").replace(/&gt;/g,">")},loadTemplate:function(a,b,c){$("textarea[id="+a+"]").length>0?c&&c():$.get(b,{t:Math.ceil(Math.random()*100)},function(b){$('<textarea id="'+a+'" style="display:none"></textarea>').appendTo("body").val(b);c&&c()})}},dialogMgr={dialog:null,
option:null,moving:false,pos:null,show:function(a,b){var c={width:428,title:"",draggable:true},b=b||{},d;for(d in b)c[d]=b[d];this.dialog&&this.hide();this.option=c;this.dialog=$.dom(a);c=this.option.width;d=utils.getClientWidth();var e=0;d>c&&(e=(d-c)/2);this.dialog.style.left=e+"px";this.dialog.style.top=30+(document.body.scrollTop||document.documentElement.scrollTop)+"px"},hide:function(){if(this.dialog){$(this.dialog).hide();if(this.option.hideCallback)try{this.option.hideCallback()}catch(a){}this.dialog=
this.option=null;this.moving=false;this.pos=null}}},CalUtil={monthViewInfo:function(a,b){var c=cal365.date,d={},e=c.copy(a),e=c.month_view_start(e,b);d.start=c.copy(c.week_start(e,b));var f=c.copy(a);f.setMonth(a.getMonth()+1);f.setDate(1);d.row=Math.ceil((f.valueOf()-e.valueOf())/6048E5);d.end=c.add(d.start,7*d.row,"day");return d}};
jQuery.cookie=function(a,b,c){if(typeof b!="undefined"){c=c||{};if(b===null)b="",c.expires=-1;var d="";if(c.expires&&(typeof c.expires=="number"||c.expires.toUTCString))typeof c.expires=="number"?(d=new Date,d.setTime(d.getTime()+c.expires*864E5)):d=c.expires,d="; expires="+d.toUTCString();var e=c.path?"; path="+c.path:"",f=c.domain?"; domain="+c.domain:"",c=c.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),d,e,f,c].join("")}else{b=null;if(document.cookie&&document.cookie!=""){c=
document.cookie.split(";");for(d=0;d<c.length;d++)if(e=jQuery.trim(c[d]),e.substring(0,a.length+1)==a+"="){b=decodeURIComponent(e.substring(a.length+1));break}}return b}};
var colors="#CC3333,#DD4477,#994499,#6633CC,#336699,#3366CC,#22AA99,#329262,#109618,#66AA00,#AAAA11,#D6AE00,#EE8800,#DD5511,#A87070,#8C6D8C,#627487,#7083A8,#5C8D87,#898951,#B08B59".split(","),DataHandler={cachedData:{from:new Date,to:new Date},loadCld:{},getLoadCld:function(a,b,c){for(var d=[],a=getDateKey(a)+"-"+getDateKey(b),b=0;b<c.length;b++){var e=a+"-"+c[b];typeof DataHandler.loadCld[e]=="undefined"&&(d.push(c[b]),DataHandler.loadCld[e]={})}return d.length>0?d.join(","):false},resultData:{},
resultDataById:{},getSchByPeriod:function(a,b,c){var d=a,e=b;if(a>=this.cachedData.from)d=this.cachedData.to;if(b<=this.cachedData.to)e=this.cachedData.from;var f=calendarHandler.getSelectedArray();(f=DataHandler.getLoadCld(a,b,f))?$.ajax({url:"/schedule/list.do",async:true,type:"post",dataType:"json",data:{fromDate:cal365.templates.load_format(a),toDate:cal365.templates.load_format(b),timeZone:-(new Date).getTimezoneOffset()/60,calendarId:f},success:function(a){for(var b=0;b<a.length;b++)DataHandler.formatSchData(a[b].schlist,
e);if(DataHandler.cachedData.from>d)DataHandler.cachedData.from=d;if(DataHandler.cachedData.to<e)DataHandler.cachedData.to=e;c&&c()}}):c&&c()},getSchByMonth:function(a,b,c){var d=cal365.date.month_view_start(a,c),a=cal365.date.add(d,CalUtil.monthViewInfo(a,c).row*7,"day");this.getSchByPeriod(d,a,b)},getSchedulesByRange:function(a,b,c,d){var e={},f=c||DataHandler.resultData;typeof a=="string"&&(a=cal365.templates.api_date(a));typeof b=="string"&&(b=cal365.templates.api_date(b));a=cal365.date.date_part(a);
for(b=cal365.date.date_part(b);a<=b;){c="d"+getDateKey(a);e[c]={schList:[],num:0};if(f[c]){for(var g=[],i=0;i<f[c].schList.length;i++)for(var h=f[c].schList[i],k=0;k<d.length;k++)if(h.cid==d[k]){g.push(h);break}e[c].schList=g;e[c].num=g.length}a=cal365.date.add(a,1,"day")}var a=0,l;for(l in e)if(c=e[l],c.num>a)a=c.num;e.maxNum=a;return JSON.parse(JSON.stringify(e))},formatSchData:function(a,b){for(var c={},d=0;d<a.length;d++){var e=a[d];if(""==e.text)e.text="(\u65e0\u6807\u9898)";var f=cal365.templates.api_date(e.start_time),
g=new Date(f.valueOf()+e.duration*1E3),i=cal365.date.copy(f),i=cal365.date.add(cal365.date.date_part(i),1,"day");e.isDisplay=0;if(i>=g)g="d"+getDateKey(f),c[g]||(c[g]={schList:[]}),c[g].schList.push(e);else for(var h=cal365.date.copy(f);h<g&&h<b;)f="d"+getDateKey(h),i=DataHandler.copySch(e),i.cross_st=cal365.templates.day_date(h)+":00",h=cal365.date.add(cal365.date.date_part(h),1,"day"),i.cross_et=h<=g?cal365.templates.day_date(h)+":00":cal365.templates.day_date(g)+":00",c[f]||(c[f]={schList:[]}),
c[f].schList.push(i)}DataHandler.mergeData(DataHandler.resultData,c);DataHandler.formatSchDataById(a)},formatSchDataById:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].id]=a[c];$.extend(true,DataHandler.resultDataById,b)},mergeData:function(a,b){for(var c in b){if(a[c])for(var d=b[c].schList,e=a[c].schList,f=0;f<d.length;++f){for(var g=false,i=0;i<e.length;++i)if(e[i].id==d[f].id){e[i]=d[f];g=true;break}g||e.push(d[f])}else a[c]=b[c];a[c].schList.sort(function(a,b){if(a.allday_event)return-1;
if(b.allday_event)return 1;var c=cal365.templates.api_date(a.start_time).getTime(),d=cal365.templates.api_date(b.start_time).getTime();return c-d})}},delSchById:function(a){for(var b in DataHandler.resultData)for(var c=DataHandler.resultData[b].schList,d=0;d<c.length;++d)c[d].id==a&&(c.splice(d,1),--d);delete DataHandler.resultDataById[a]},updateSch:function(a,b){DataHandler.delSchById(a[0].id);DataHandler.formatSchData(a,b)},copySch:function(a){var b=function(){};b.prototype=a;return new b}};
(function(a){var b=/^d(\d{4})-(\d{2})-(\d{2})/,c=/^0/,d=null,e=null,f=null,g=null,i=null,h=function(a){e&&DataHandler.getSchByMonth(e,function(){var b=CalUtil.monthViewInfo(e,true),c=b.start,b=b.end,f=[];f.push(d);i=DataHandler.getSchedulesByRange(c,b,DataHandler.resultData,f);a&&a()},true)},k=function(a,d,e,g,n){var j={};j.schTitle=a;(j.alldayEvent=d)?j.startTime=getDateKey(f)+" 09:00:00":(e+="",g+="",j.startTime=getDateKey(f)+" "+e.leftpad(2)+":"+g.leftpad(2)+":00");j.timeZone=-(new Date).getTimezoneOffset()/
60;var k=cal365.date.add(cal365.templates.api_date(j.startTime),1,"day");$.ajax({type:"post",data:j,url:"/schedule/update.do",success:function(a){for(var d=0;d<a.length;d++)DataHandler.formatSchData(a[d].schlist,k);h(function(){for(var a in i)if(a!="maxNum"){var d=i[a].num,e=a.replace(b,function(a,b,d,e){return b+"-"+d.replace(c,"")+"-"+e.replace(c,"")});d>0&&n(cal365.templates.api_date(e))}})},dataType:"json"})},l={drawSch:function(a){$("#taskList").children().remove();var b=[];if(a.length>0)for(var c=
0;c<3&&c<a.length;c++){var d;a:{d=a[c].text;for(var e=0,f=void 0,f=0;f<d.length;f++){var g=d.charCodeAt(f);g>=1&&g<=126||65376<=g&&g<=65439?e++:e+=2;if(e>=10){d=d.substring(0,f+1);break a}}}d.length<a[c].text.length&&(d+="...");e="&nbsp;";a[c].allday_event||(e=a[c].start_time.split(" ")[1].split(":"),e.splice(2),e=e.join(":")+"&nbsp;");b.push("<div class='workitem'>");b.push("<div class='tastWorkDot'></div>");a[c].allday_event?b.push("<div style='margin-left:11px;'>"+d+"</div>"):(b.push("<div class='taskWorkTime'>"+
e+"</div>"),b.push("<div style='margin-left:5px;'>"+d+"</div>"));b.push("</div>")}$("#taskList").html(b.join(""))}};if(a.calendarHandler)a._calendarHandler=a.calendarHandler;a.calendarHandler={init:function(a){typeof a=="number"?d=a:typeof a=="string"&&(d=parseInt(a));e=f=new Date;cal365.init_templates()},isLogin:function(){return!!d},getSelectedArray:function(){var a=[];a.push(d);return a},prepareData4:function(a,d,f){var g=new Date;g.setYear(a);g.setMonth(d-1);g.setDate(1);e=g instanceof Date?g:
null;h(function(){for(var a in i)if(a!="maxNum"){var d=i[a].num,e=a.replace(b,function(a,b,d,e){return b+"-"+d.replace(c,"")+"-"+e.replace(c,"")});d>0&&f(cal365.templates.api_date(e))}})},getSelectedDate:function(){return f},setSelectedDate:function(a){typeof a=="string"?f=cal365.templates.api_date(a):a instanceof Date&&(f=a)},getSch:function(){return i["d"+getDateKey(g)]},addSch:function(a,b,c,d,e){k(a,b,c,d,e)},drawSch:function(){this.isLogin()&&l.drawSch(this.getSch().schList)},setHoverDate:function(a){typeof a==
"string"?g=cal365.templates.api_date(a):a instanceof Date&&(g=a)}}})(window);
