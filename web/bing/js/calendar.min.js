var containers=new Array("cal_container","single_container","jieqi_container","festival_container");var jieqiData=[];function getJieQiData(a){if(jieqiData.length>0){a();}else{$.ajax({type:"GET",url:"data/jieqi.json?v=2014",dataType:"json",success:function(b){jieqiData=b;a();}});}}var showContainers=function(a){for(i=0;i<containers.length;i++){if(containers[i]!=a){$("#"+containers[i]).hide();}else{$("#"+a).show();}}};var festiArr=globalData.data[globalData.targetYear].festiArr;var nameTable={"元旦":"yuandan","春节":"chunjie","清明节":"qingmingjie","劳动节":"laodong","端午节":"duanwu","中秋节":"zhongqiu","国庆节":"guoqing"};for(var i=0;i<festiArr.length;i++){var py=nameTable[festiArr[i].name];$('.jieriTd[jieri="'+py+'"] .jieriDate').html(festiArr[i].time);}var lunarInfo=new Array(19416,19168,42352,21717,53856,55632,21844,22191,39632,21970,19168,42422,42192,53840,53909,46415,54944,44450,38320,18807,18815,42160,46261,27216,27968,43860,11119,38256,21234,18800,25958,54432,59984,27285,23263,11104,34531,37615,51415,51551,54432,55462,46431,22176,42420,9695,37584,53938,43344,46423,27808,46416,21333,19887,42416,17779,21183,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,38310,38335,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,20854,21183,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,53430,53855,54560,56645,46496,22224,21938,18864,42359,42160,43600,45653,27951,44448,19299,37759,18936,18800,25776,26790,59999,27424,42692,43759,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,19285,19311,42352,21732,53856,59752,54560,55968,27302,22239,19168,43476,42192,53584,62034,54560);var solarMonth=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var Gan=new Array("甲","乙","丙","丁","戊","己","庚","辛","壬","癸");var Zhi=new Array("子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥");var Animals=new Array("鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪");var solarTerm=new Array("小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至");var sTermInfo=new Array(0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758);var nStr1=new Array("日","一","二","三","四","五","六","七","八","九","十");var nStr2=new Array("初","十","廿","卅","□");var monthName=new Array("JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC");var cmonthName=new Array("正","二","三","四","五","六","七","八","九","十","十一","腊");var sFtv=new Array("0101*元旦","0214 情人节","0308 妇女节","0312 植树节","0401 愚人节","0422 地球日","0501 劳动节","0504 青年节","0531 无烟日","0601 儿童节","0606 爱眼日","0701 建党日","0707 抗战纪念日","0801 建军节","0910 教师节","0918 九·一八事变纪念日","1001*国庆节","1031 万圣节","1111 光棍节","1201 艾滋病日","1213 南京大屠杀纪念日","1224 平安夜","1225 圣诞节");var wFtv=new Array("0520 母亲节","0630 父亲节","1144 感恩节");var lFtv=new Array("0101*春节","0115 元宵节","0202 龙抬头","0505 端午节","0707 七夕","0715 中元节","0815 中秋节","0909 重阳节","1208 腊八节","1223 小年","0100*除夕");function lYearDays(c){var a,b=348;for(a=32768;a>8;a>>=1){b+=(lunarInfo[c-1900]&a)?1:0;}return(b+leapDays(c));}function leapDays(a){if(leapMonth(a)){return((lunarInfo[a-1899]&15)==15?30:29);}else{return(0);}}function leapMonth(b){var a=lunarInfo[b-1900]&15;return(a==15?0:a);}function monthDays(b,a){return((lunarInfo[b-1900]&(65536>>a))?30:29);}function Lunar(e){var c,b=0,a=0;var f=(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())-Date.UTC(1900,0,31))/86400000;for(c=1900;c<2100&&f>0;c++){a=lYearDays(c);f-=a;}if(f<0){f+=a;c--;}this.year=c;b=leapMonth(c);this.isLeap=false;for(c=1;c<13&&f>0;c++){if(b>0&&c==(b+1)&&this.isLeap==false){--c;this.isLeap=true;a=leapDays(this.year);}else{a=monthDays(this.year,c);}if(this.isLeap==true&&c==(b+1)){this.isLeap=false;}f-=a;}if(f==0&&b>0&&c==b+1){if(this.isLeap){this.isLeap=false;}else{this.isLeap=true;--c;}}if(f<0){f+=a;--c;}this.month=c;this.day=f+1;}function getSolarDate(f,a,h,b){var j=0;for(var e=1900;e<f;e++){j+=lYearDays(e);}for(var e=1;e<a;e++){if(e==leapMonth(f)){j+=leapDays(f);}j+=monthDays(f,e);}if(b){j+=monthDays(f,e);}j+=parseInt(h)-1;var g=new Date(1900,0,31);var c=new Date(g.valueOf()+j*86400000);return c;}function solarDays(b,a){if(a==1){return(((b%4==0)&&(b%100!=0)||(b%400==0))?29:28);}else{return(solarMonth[a]);}}function cyclical(a){return(Gan[a%10]+Zhi[a%12]);}function calElement(a,h,l,b,g,e,f,j,c,k,m){this.isToday=false;this.sYear=a;this.sMonth=h;this.sDay=l;this.week=b;this.lYear=g;this.lMonth=e;this.lDay=f;this.isLeap=j;this.cYear=c;this.cMonth=k;this.cDay=m;this.color="";this.lunarFestival="";this.solarFestival="";this.solarTerms="";}function sTerm(c,b){var a=new Date((31556925974.7*(c-1900)+sTermInfo[b]*60000)+Date.UTC(1900,0,6,2,5));return(a.getUTCDate());}function calendar(j,s){var z,k,x,b,h=1,f,A=0,q,o,l;var w,a,g;var e=new Array(3);var r=0;var c=0;z=new Date(j,s,1,0,0,0,0);this.length=solarDays(j,s);this.firstWeek=z.getDay();if(s<2){w=cyclical(j-1900+36-1);}else{w=cyclical(j-1900+36);}var u=sTerm(j,2);var t=sTerm(j,s*2);a=cyclical((j-1900)*12+s+12);var p=Date.UTC(j,s,1,0,0,0,0)/86400000+25567+10;for(var v=0;v<this.length;v++){if(h>A){z=new Date(j,s,v+1);k=new Lunar(z);x=k.year;b=k.month;h=k.day;f=k.isLeap;A=f?leapDays(x):monthDays(x,b);if(r==0){c=b;}e[r++]=v-h+1;}if(s==1&&(v+1)==u){w=cyclical(j-1900+36);}if((v+1)==t){a=cyclical((j-1900)*12+s+13);}g=cyclical(p+v);this[v]=new calElement(j,s+1,v+1,nStr1[(v+this.firstWeek)%7],x,b,h++,f,w,a,g);}q=sTerm(j,s*2)-1;o=sTerm(j,s*2+1)-1;this[q].solarTerms=solarTerm[s*2];this[o].solarTerms=solarTerm[s*2+1];for(v in sFtv){if(sFtv[v].match(/^(\d{2})(\d{2})([\s\*])(.+)$/)){if(Number(RegExp.$1)==(s+1)){this[Number(RegExp.$2)-1].solarFestival+=RegExp.$4+" ";if(RegExp.$3=="*"){this[Number(RegExp.$2)-1].color="red";}}}}for(v in wFtv){if(wFtv[v].match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/)){if(Number(RegExp.$1)==(s+1)){q=Number(RegExp.$2);o=Number(RegExp.$3);if(q<5){this[((this.firstWeek>o)?7:0)+7*(q-1)+o-this.firstWeek].solarFestival+=RegExp.$5+" ";}else{q-=5;l=(this.firstWeek+this.length-1)%7;this[this.length-l-7*q+o-(o>l?7:0)-1].solarFestival+=RegExp.$5+" ";}}}}for(v in lFtv){if(lFtv[v].match(/^(\d{2})(.{2})([\s\*])(.+)$/)){q=Number(RegExp.$1)-c;if(q==-11){q=1;}if(q>=0&&q<r){o=e[q]+Number(RegExp.$2)-1;if(o>=0&&o<this.length&&this[o].isLeap!=true){this[o].lunarFestival+=RegExp.$4+" ";if(RegExp.$3=="*"){this[o].color="red";}}}}}}function easter(h){var b=sTerm(h,5);var e=new Date(Date.UTC(h,2,b,0,0,0,0));var a=new Lunar(e);if(a.day<15){var g=15-a.day;}else{var g=(a.isLeap?leapDays(h):monthDays(h,a.month))-a.day+15;}var f=new Date(e.getTime()+86400000*g);var c=new Date(f.getTime()+86400000*(7-f.getUTCDay()));this.m=c.getUTCMonth();this.d=c.getUTCDate();}function cDay(b){var a;switch(b){case 10:a="初十";break;case 20:a="二十";break;break;case 30:a="三十";break;break;default:a=nStr2[Math.floor(b/10)];a+=nStr1[b%10];}return(a);}$.dom=function(a){return document.getElementById(a);};function StringBuffer(){this._strings=new Array();}StringBuffer.prototype.append=function(a){this._strings.push(a);return this;};StringBuffer.prototype.toString=function(){var a=arguments.length==0?"":arguments[0];return this._strings.join(a);};String.prototype.leftpad=function(a,e){if(!e){e="0";}var c="";for(var b=0;b<a-this.length;b++){c+=e;}return c+this;};String.prototype.htmlspecialchars=function(){return this;};function getMonthKey(a,b){return a.toString()+(b+1).toString().leftpad(2);}function getDateKey(a){return a.getFullYear().toString()+"-"+(a.getMonth()+1).toString().leftpad(2)+"-"+a.getDate().toString().leftpad(2);}function is_leap_year(a){if(a%400==0||(a%100!=0&&a%4==0)){return 1;}return 0;}function getDaysByMonth(a){var b=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];return b[is_leap_year(a.getFullYear())][a.getMonth()];}function dateDiff(b,a){var c=dateDiffDays(b,a);if(c==0){return"今天";}else{if(c<0){return(0-c)+"天前";}else{return c+"天后";}}}function dateDiffDays(b,a){var f=new Date(b.getFullYear(),b.getMonth(),b.getDate());var e=new Date(a.getFullYear(),a.getMonth(),a.getDate());var c=parseInt((e-f)/(24*60*60*1000));return c;}var cacheMgr={cldCache:{},getCld:function(c,e){var a=getMonthKey(c,e);var b=this.cldCache[a];if(typeof b=="undefined"){b=new calendar(c,e);this.cldCache[a]=b;}return b;}};var HuangLi={};var calData=new Array();var currentDate=new Date();var rows;var showingToday=true;var taskHover_inblock=false;var taskHover_inhover=false;var madeRiliDate=new Date();var record={elem_id:"",nav_date:new Date()};var timeSelf=0;var timeBeijing;function clock(a){timeSelf=(new Date()).getTime();timeBeijing=a*1000;}var calander={init:function(){makeCal.pareData(new Date());makeCal.showCal(new Date());makeCal.initAction();makeCal.makeHuangli(currentDate);},pareData:function(g){g=makeCal.setTimeZero(g);madeRiliDate=new Date(g);var e=makeCal.getMonthFirst(g);var f=makeCal.getWeekFirst(e);var h=makeCal.addTime(e,1,"month");var b=makeCal.addTime(h,-1,"day");rows=6;var a=new Date(f);var c=makeCal.setTimeZero(new Date());makeCal.fillCalData(a,e,b,c);},fillCalData:function(b,g,h,l){calData=[];for(var e=0;e<rows;e++){var a=[];for(var c=0;c<7;c++){var f=makeCal.createDay();f.year=b.getFullYear();f.month=b.getMonth();f.date=b.getDate();if(b.getTime()<g.getTime()){f.before=true;}else{if(b.getTime()>h.getTime()){f.after=true;}}if(b.getTime()==l.getTime()){f.today=true;}if(c==5||c==6){f.weekend=true;}f.rows=rows;f.inrow=e+1;f.value=b;f.china=templates.lunar_Info(f.value);var k=f.value.getFullYear()+"-"+(f.value.getMonth()+1)+"-"+f.value.getDate();switch(k){case"2011-11-22":f.china.l_day="廿七";f.china.color="";break;case"2011-11-23":f.china.l_day="小雪";f.china.color="#bc5016";break;case"2012-1-1":f.china.l_day="元旦";f.china.color="#bc5016";break;case"2012-1-20":f.china.l_day="廿七";f.china.color="";break;case"2012-1-21":f.china.l_day="大寒";f.china.color="#bc5016";break;}a.push(f);b=makeCal.addTime(b,1,"day");}calData.push(a);}},prepareData4Festival:function(j,b){b=makeCal.setTimeZero(b);madeRiliDate=new Date(b);var f=b,m=b;while(true){var h=worktime["y"+f.getFullYear()];var a=getMonthDateStr(f);if(h["d"+a]){f=makeCal.addTime(f,-1,"day");}else{f=makeCal.addTime(f,1,"day");break;}}while(true){var h=worktime["y"+m.getFullYear()];var a=getMonthDateStr(m);if(h["d"+a]){m=makeCal.addTime(m,1,"day");}else{m=makeCal.addTime(m,-1,"day");break;}}var g=f;var e=makeCal.getWeekFirst(g);var k=m;rows=6;var c=new Date(e);var l=makeCal.setTimeZero(new Date());makeCal.fillCalData(c,g,k,l);},showCal:function(c){if(typeof(c)=="undefined"){c=date=makeCal.setTimeZero(new Date());}c=makeCal.setTimeZero(c);if(downAppSwitch){var o=new Date();if(o.getFullYear()==c.getFullYear()&&o.getMonth()==c.getMonth()){$("#today_button").html("<a href='"+downAppLink+"' target='_blank' style='color:#493413;display:block;'>手机版</a>");$("#today_button").css("width","50px");$("#today_button").addClass("download_app_btn");}else{$("#today_button").html("今天");$("#today_button").css("width","40px");$("#today_button").removeClass("download_app_btn");}}$("#year_time").text(c.getFullYear()+"年"+(c.getMonth()+1)+"月");var r="<table id='caltable'> 						<thead class='tablehead'> 							<tr> 								<td class='thead"+rows+"'>一</td> 								<td class='thead"+rows+"'>二</td> 								<td class='thead"+rows+"'>三</td> 								<td class='thead"+rows+"'>四</td> 								<td class='thead"+rows+"'>五</td> 								<td class='thead"+rows+"' style='color:#bc5016;'>六</td> 								<td class='thead"+rows+"' style='color:#bc5016;'>日</td> 							</tr> 						</thead> 						<tbody>";var s="";for(var g=0;g<rows;g++){var a="<tr>";for(var f=0;f<7;f++){var s="";if(calData[g][f].before==true){s="before";}else{if(calData[g][f].after==true){s="after";}}var b=getMonthDateStr(calData[g][f].value);var l="";try{var m=worktime["y"+calData[g][f].year];if(m){l=m["d"+b];}}catch(k){}var n="";if(l){if(l.w=="上班"){s="workBlock";n="work";}else{s="restBlock";n="rest";}}if(calData[g][f].today==true){s="today today"+calData[g][f].rows;}var q="number";if(calData[g][f].weekend==true){q="weekendNum";}if(calData[g][f].before){q="before number";}else{if(calData[g][f].after){q="after number";}}var p="";if(calData[g][f].today==false&&calData[g][f].value.getTime()==c.getTime()){p=" clickBlock"+calData[g][f].rows;}var h="<td i="+g+" j="+f+" class='block block"+calData[g][f].rows+" "+s+p+"'>";h+="<div class='block_content block_content"+calData[g][f].rows+"'>";if(n=="work"){h+="<div class='workrest work'>班</div>";}else{if(n=="rest"){h+="<div class='workrest rest'>休</div>";}}if(calData[g][f].today==false){h+="	<div class='"+q+" number"+calData[g][f].rows+"'>"+calData[g][f].date+"</div>								<div class='chinaday chinaday"+calData[g][f].rows+" festival' style='color: "+calData[g][f].china.color+"'>"+(calData[g][f].china.l_day).substring(0,4)+"</div>";}else{h+="	<div class='"+q+" number"+calData[g][f].rows+"'>"+calData[g][f].date+"</div>								<div class='chinaday chinaday"+calData[g][f].rows+" festival' style='color: white;'>"+calData[g][f].china.l_day+"</div>";}if(calData[g][f].hasWork){h+="<img class='workDot workDot"+calData[g][f].rows+"' src='http://static.365rili.com/wannianlibaidu/BD_images/dot.png'/>";}h+="</div></td>";a+=h;}a+="<tr>";r+=a;}r+="</tbody></table>";$("#mainCal").empty();$("#mainCal").append(r);makeCal.makeAction();},initAction:function(){$("#next_button").bind("click",function(g){var f=currentDate.getMonth();var b=currentDate.getFullYear();var a=madeRiliDate.getMonth();f=a;f++;if(f>11){f=0;b++;}var c=a;currentDate=makeCal.addTime(currentDate,1,"month");if(currentDate.getMonth()!=(c+1)%12){currentDate.setDate(1);currentDate.setMonth(c+1);}$("#year_time").text(b+"年"+(f+1)+"月");$("#festival_rest").text("");makeCal.nextMonth(currentDate);});$("#prev_button").bind("click",function(g){var f=currentDate.getMonth();var b=currentDate.getFullYear();var a=madeRiliDate.getMonth();f=a;f--;if(f<0){f=11;b--;}var c=a;currentDate=makeCal.addTime(currentDate,-1,"month");if(currentDate.getMonth()!=(c+11)%12){currentDate.setDate(1);currentDate.setMonth((c+11)%12);}$("#year_time").text(b+"年"+(f+1)+"月");$("#festival_rest").text("");makeCal.prevMonth(currentDate);});$("#today_button").bind("click",function(a){if($(this).hasClass("download_app_btn")){return;}makeCal.showToday();$("#festival_rest").text("");});$("#single_today_button").bind("click",function(a){makeCal.showToday();$("#festival_rest").text("");});$("#top_bar_time").text(makeCal.get365riliTime());$("#festival_back_button").bind("click",function(){showContainers("cal_container");});$("#festival").bind("click",function(){showContainers("festival_container");$("#jieri_button").click();});$("#jieri_button").bind("click",function(){$("#mainJieri").show();$("#mainNongli").hide();if($("#jieri_button").hasClass("active_tab_button")==false){$("#jieri_button").addClass("active_tab_button");}$("#nongli_button").removeClass("active_tab_button");});$("#nongli_button").bind("click",function(){$("#mainNongli").show();$("#mainJieri").hide();if($("#nongli_button").hasClass("active_tab_button")==false){$("#nongli_button").addClass("active_tab_button");}$("#jieri_button").removeClass("active_tab_button");});$("#singleArrowLeftTd").bind("click",function(){currentDate=makeCal.addTime(currentDate,-1,"day");makeCal.pareData(currentDate);makeCal.showCal(currentDate);makeCal.makeHuangli(currentDate);});$("#singleArrowRightTd").bind("click",function(){currentDate=makeCal.addTime(currentDate,1,"day");makeCal.pareData(currentDate);makeCal.showCal(currentDate);makeCal.makeHuangli(currentDate);});$("#jieqiDiv").bind("click",function(a){getJieQiData(function(){name=$("#jieqiStr").text().substring(7);$("#jieqi_back_button").attr({from:"single_container"});for(var b=0;b<24;b++){if(name==jieqiData[b].name){var c=b;$("#jieqiName").text(jieqiData[c].name);$("#jieqiTime").text(jieqiData[c].time);$("#jieqiDescribe").html(jieqiData[c].des.replace(/(^|<br\/>)/g,"$1　　"));break;}}showContainers("jieqi_container");});});$("#jieqi_back_button").bind("click",function(){var a=$("#jieqi_back_button").attr("from");showContainers(a);});$(".smallJieqiTd").bind("click",function(a){getJieQiData(function(){ele=$(a.target);id=ele.attr("id");$("#jieqi_back_button").attr({from:"festival_container"});$("#jieqiName").text(jieqiData[id].name);$("#jieqiTime").text(jieqiData[id].time);$("#jieqiDescribe").html(jieqiData[id].des.replace(/(^|<br\/>)/g,"$1　　"));showContainers("jieqi_container");});});$(".jieriTd").bind("click",function(b){if($(this).attr("id")=="downApp_container"){return;}ele=$(this);jieri=ele.attr("jieri");settoFestival(jieri);var a;if(jieri=="qingming"){a=fangjiaData.qingmingjie;}else{a=fangjiaData[jieri];}$("#festival_rest").text(a);showContainers("cal_container");});setInterval(function(){var a=makeCal.get365riliTime();$("#top_bar_time").text(makeCal.get365riliTime());if(a=="00:00:00"&&showingToday){var b=new Date();makeCal.pareData(b);makeCal.showCal(b);makeCal.makeHuangli(b);$("#year_num").text(b.getFullYear());$("#month_num").text(b.getMonth()+1);}},1000);},makeAction:function(){$(".block").bind("click",function(b){var a=madeRiliDate.getMonth();ele=$(this);makeCal.makeHuangli(calData[ele.attr("i")][ele.attr("j")].value);showContainers("single_container");$("#festival_rest").text("");});$("#single_back_button").bind("click",function(){showContainers("cal_container");});},makeHuangli:function(c){currentDate=c;c=makeCal.setTimeZero(c);var b=c.getDate();lunar=templates.lunar_Info_detail(c,l);$("#singleNumTd").text(b);var m=c.getFullYear()+"年"+(c.getMonth()+1)+"月 ";switch(c.getDay()){case 1:m+="星期一";break;case 2:m+="星期二";break;case 3:m+="星期三";break;case 4:m+="星期四";break;case 5:m+="星期五";break;case 6:m+="星期六";break;case 0:m+="星期日";break;}m+=" ";$("#singleDateStr").text(m);var f=templates.lunar_Info(c).solarTerm;$("#festivalStr").text(templates.lunar_Info(c).festival);if(f!=""){$("#jieqiDiv").show();$("#jieqiStr").text("24节气 - "+f);}else{$("#jieqiDiv").hide();}$("#popDateStr").text(getFullDateStr(c));$("#popChineseStr").text((lunar.lunar).substring(2));var k=makeCal.setTimeZero(new Date());var h=k.getTime();var e=c.getTime();var g=Math.ceil((e-h)/86400000);var j="";if(k.getDate()==c.getDate()){j="今天";}if(g<0){j=(0-g)+"天前";}else{if(g>0){j=g+"天后";}}$("#dayafterorbefore").text(j);$("#chinaDay").text((lunar.lunar).substring(2));if(c.getFullYear()==2012&&(c.getMonth()==0&&c.getDate()<23)){lunar.y_Info=lunar.y_Info.replace("龙","兔");}if(c.getFullYear()==2013&&(c.getMonth()==0||(c.getMonth()==1&&c.getDate()<4))){lunar.y_Info=lunar.y_Info.replace("蛇","龙");lunar.y_Info=lunar.y_Info.replace("癸巳","壬辰");}info=lunar.y_Info;var a=info.split(" ");$("#nongliStr1").text(a[0]);$("#nongliStr2").text(a[1]);function l(n){Y=n.huangliY;Ys=Y.split(".");$("#YStr").empty();for(var o in Ys){$("#YStr").append(Ys[o]+" ");}J=n.huangliJ;Js=J.split(".");$("#JStr").empty();for(var o in Js){$("#JStr").append(Js[o]+" ");}}},getWeekFirst:function(b){var a=b.getDay();if(a==0){a=7;}return makeCal.addTime(b,0-a+1,"day");},getMonthFirst:function(a){ndate=new Date(a);ndate.setDate(1);return ndate;},addTime:function(a,b,c){ndate=new Date(a);switch(c){case"day":ndate.setDate(a.getDate()+b);break;case"week":ndate.setDate(a.getDate()+7*b);break;case"month":ndate.setMonth(a.getMonth()+b);break;case"year":ndate.setYear(a.getFullYear()+b);break;case"hour":ndate.setHours(a.getHours()+b);break;case"minute":ndate.setMinutes(a.getMinutes()+b);break;default:return ndate;}return ndate;},setTimeZero:function(a){ndate=new Date(a);ndate.setHours(0);ndate.setMinutes(0);ndate.setSeconds(0);ndate.setMilliseconds(0);return ndate;},createDay:function(){obj=new Object();obj.year=0;obj.month=0;obj.date=0;obj.day=0;obj.before=false;obj.after=false;obj.weekend=false;obj.china=null;obj.rows=0;obj.inrow=0;obj.today=false;obj.value=null;obj.hasWork=false;return obj;},nextMonth:function(a){makeCal.pareData(a);makeCal.showCal(a);showingToday=false;makeCal.makeHuangli(a);},prevMonth:function(a){makeCal.pareData(a);makeCal.showCal(a);showingToday=false;makeCal.makeHuangli(a);},showToday:function(){currentDate=new Date();makeCal.pareData(currentDate);makeCal.showCal(new Date());$("#year_time").text(currentDate.getFullYear()+"年"+(currentDate.getMonth()+1)+"月");showingToday=true;$("#festival_rest").text("");makeCal.makeHuangli(currentDate);},bind_funcbutton:function(b,c,a){$("#"+b).bind("click",function(f){$("#"+a).css({top:$("#"+b).offset().top+30+"px"});$("#"+a).css({left:$("#"+b).position().left-39+"px"});$("#"+a).css({display:"block"});if(b=="year_func"){var h=$("#year_num").text();var g=$("#yearitem"+h).position().top;$("#"+a).scrollTop(g);}});},get365riliTime:function(){var a=(function(){if(timeBeijing!=null){var b=new Date();var c=b.getTime()-timeSelf;b.setTime(timeBeijing+c);return b;}else{return new Date();}})();hour=a.getHours();minute=a.getMinutes();second=a.getSeconds();if(hour<10){hour="0"+hour;}if(minute<10){minute="0"+minute;}if(second<10){second="0"+second;}return hour+":"+minute+":"+second;}};function StringBuffer(){this._strings=new Array();}StringBuffer.prototype.append=function(a){this._strings.push(a);return this;};StringBuffer.prototype.toString=function(){var a=arguments.length==0?"":arguments[0];return this._strings.join(a);};var templates={month_day:function(a){var b=a||new Date();return b.getDate();},lunar_Info:function(e){var g=cacheMgr.getCld(e.getFullYear(),e.getMonth());var b=e.getDate();var h=g[b-1];var a={l_day:"",l_month:"",l_day_full:"",solarTerm:"",festival:""};a.l_day=cDay(h.lDay);a.l_month=h.lMonth;a.color="";var j,c;a.solarTerm=h.solarTerms;if(a.solarTerm=="undefined"){a.solarTerm="";}var f=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate();if(typeof SolarTermException[f]!="undefined"){a.solarTerm=SolarTermException[f];}j=h.lunarFestival;c=h.solarFestival;if(j.length>0){j=j+" "+c;}else{j=c;}if(j.length>0){a.festival=j;a.l_day=j;a.color="#bc5016";}if(a.solarTerm.length>0){a.l_day=a.solarTerm;}return a;},lunar_Info_detail:function(date,callback){var cld=cacheMgr.getCld(date.getFullYear(),date.getMonth());var year=date.getFullYear();var day=date.getDate();var cld_day=cld[day-1];var festival=[];var info={lunar:"",y_Info:"",huangliY:"无",huangliJ:"无"};info.lunar="农历"+(cld_day.isLeap?"闰 ":"")+templates.getChinaNum(cld_day.lMonth)+"月"+cDay(cld_day.lDay);info.y_Info=cld_day.cYear+"年"+this.lunar_year(date)+" "+cld_day.cMonth+"月"+cld_day.cDay+"日";try{if(year>=2008&&year<=2020){var huangliYearMonth=year+""+(cld_day.sMonth<10?("0"+cld_day.sMonth):cld_day.sMonth);if(eval("HuangLi.y"+huangliYearMonth)==null){var filename="http://baidu365.duapp.com/wannianlibaidu/js/huangli/month/"+huangliYearMonth+".js";$.getScript(filename,function(){var hl=eval("HuangLi.y"+huangliYearMonth+".d"+(cld_day.sMonth<10?("0"+cld_day.sMonth):cld_day.sMonth)+(cld_day.sDay<10?("0"+cld_day.sDay):cld_day.sDay));info.huangliY=hl.y;info.huangliJ=hl.j;if(hl.y.length>8&&hl.j.indexOf("诸事不宜")>=0){info.huangliJ="余事勿取";}if(callback){callback(info);}});}else{var hl=eval("HuangLi.y"+huangliYearMonth+".d"+(cld_day.sMonth<10?("0"+cld_day.sMonth):cld_day.sMonth)+(cld_day.sDay<10?("0"+cld_day.sDay):cld_day.sDay));info.huangliY=hl.y;info.huangliJ=hl.j;if(hl.y.length>8&&hl.j.indexOf("诸事不宜")>=0){info.huangliJ="余事勿取";}if(callback){callback(info);}}}else{if(callback){callback(info);}}}catch(e){}return info;},lunar_year:function(a){var b="【"+Animals[(a.getFullYear()-4)%12]+"年】";return b;},getChinaNum:function(b){var a;switch(b){case 1:a="一";break;case 2:a="二";break;case 3:a="三";break;case 4:a="四";break;case 5:a="五";break;case 6:a="六";break;case 7:a="七";break;case 8:a="八";break;case 9:a="九";break;case 10:a="十";break;case 11:a="十一";break;case 12:a="腊";break;}return a;},init_sel_festival:function(){var b=festival_main;if(festival_main){var c=new StringBuffer();c.append('<div id="festival_sel_body">');for(var a in festival_main){c.append('<div date="'+a).append('">').append(festival_main[a]+"</div>");}c.append("</div>");}$("#festival_sel_div").html(c.toString());$("#festival_sel_body>div").each(function(){$(this).click(function(){var e=$(this).attr("date").split("_");record.nav_date.setFullYear(e[0]);record.nav_date.setMonth(Number(e[1])-1);generic_cal(record.nav_date,record.elem_id);$("#festival_sel_div").hide();});$(this).hover(function(){$(this).addClass("year_bg");},function(){$(this).removeClass("year_bg");});});},init_sel_year:function(){var c=new StringBuffer();c.append('<div id="sel_body">');for(var b=1900;b<2050;b++){c.append("<div>").append(b).append("</div>");}c.append("</div>");var a=record.nav_date.getFullYear()-1900;$("#open_sel_div").html(c.toString());$("#sel_body>div").each(function(){$(this).click(function(){var e=$(this).html();record.nav_date.setFullYear(e);generic_cal(record.nav_date,record.elem_id);$("#open_sel_div").hide();});$(this).hover(function(){$(this).addClass("year_bg");},function(){$(this).removeClass("year_bg");});});},mousedown_hide_ele:function(a){$(document).bind("mousedown."+a,function(b){var e=b.target;var c=document.getElementById(a);while(true){if(e==c){return true;}else{if(e==document){$(document).unbind("mousedown."+a);$("#"+a).hide();return false;}else{e=$(e).parent()[0];}}}});}};function getMonthKey(a,b){return a.toString()+(b+1).toString().leftpad(2);}String.prototype.leftpad=function(a,e){if(!e){e="0";}var c="";for(var b=0;b<a-this.length;b++){c+=e;}return c+this;};window.makeCal=calander;function getMonthDateStr(a){month=a.getMonth()+1;day=a.getDate();if(month<10){month="0"+month;}if(day<10){day="0"+day;}return month+""+day;}function getFullDateStr(a){month=a.getMonth()+1;day=a.getDate();year=a.getFullYear();return year+"-"+month+"-"+day;}var SolarTermException={"2012-5-20":"小满","2012-5-21":"","2012-12-6":"","2012-12-7":"大雪","2013-2-3":"","2013-2-4":"立春","2013-7-22":"大暑","2013-7-23":"","2013-12-21":"","2013-12-22":"冬至","2014-3-5":"","2014-3-6":"惊蛰","2015-1-5":"","2015-1-6":"小寒","2016-6-6":"","2016-6-7":"","2017-7-22":"大暑","2017-7-23":"","2017-12-21":"","2017-12-22":"冬至","2018-2-18":"","2018-2-19":"雨水","2018-3-20":"","2018-3-21":"春分","2019-2-4":"立春","2019-2-5":"","2019-6-21":"夏至","2019-6-22":"","2020-7-6":"小暑","2020-7-7":"","2020-8-22":"处暑","2020-8-23":"","2020-12-6":"","2020-12-7":"大雪"};function getYearWeek(a){var b=new Date(a.getFullYear(),0,1);var e=a.getDay();if(e==0){e=7;}var c=b.getDay();if(c==0){c=7;}d=Math.round((a.getTime()-b.getTime()+(c-e)*(24*60*60*1000))/86400000);return Math.ceil(d/7)+1;}var downAppSwitch=true;var downAppLink="http://www.365rili.com/bd/transfer/redirect_baiduwap.html";if(false&&downAppSwitch){var now=new Date();var fromTime=new Date();var toTime=new Date();fromTime.setHours(7);fromTime.setMinutes(30);fromTime.setSeconds(0);toTime.setHours(21);toTime.setMinutes(30);toTime.setSeconds(0);if(now>fromTime&&now<toTime){downAppSwitch=false;}}function onReady(){$("#downApp_btn").html("<a href='"+downAppLink+"' style='color:#816526;' target='_blank'>手机版下载</a>");makeCal.init();gotoFestival();}window.onload=onReady;function gotoFestival(){var a=window.location.search.substring(1);var c=a.split("bd_param=");var b="";if(c.length>1){b=c[1];}b=b.replace("festival%3D","");switch(b){case"jieqi":showContainers("festival_container");$("#nongli_button").click();break;case"fangjia":showContainers("festival_container");$("#jieri_button").click();break;case"lichun":case"yushui":case"jingzhe":case"chunfen":case"qingming":case"guyu":case"lixia":case"xiaoman":case"mangzhong":case"xiazhi":case"xiaoshu":case"dashu":case"liqiu":case"chushu":case"bailu":case"qiufen":case"hanlu":case"shuangjiang":case"lidong":case"xiaoxue":case"daxue":case"dongzhi":case"xiaohan":case"dahan":getJieQiData(function(){for(var e=0;e<24;e++){if(b==jieqiData[e].ename){var f=e;$("#jieqiName").text(jieqiData[f].name);$("#jieqiTime").text(jieqiData[f].time);$("#jieqiDescribe").html(jieqiData[f].des.replace(/(^|<br\/>)/g,"$1　　"));break;}}showContainers("jieqi_container");});break;case"rili_2013":currentDate.setFullYear(2013);currentDate.setMonth(0);currentDate.setDate(1);makeCal.pareData(currentDate);makeCal.showCal(currentDate);$("#year_time").text(currentDate.getFullYear()+"年"+(currentDate.getMonth()+1)+"月");showingToday=true;makeCal.makeHuangli(currentDate);break;case"rili_2014":currentDate.setFullYear(2014);currentDate.setMonth(0);currentDate.setDate(1);makeCal.pareData(currentDate);makeCal.showCal(currentDate);$("#year_time").text(currentDate.getFullYear()+"年"+(currentDate.getMonth()+1)+"月");showingToday=true;makeCal.makeHuangli(currentDate);break;case"rili_2012":currentDate.setFullYear(2012);currentDate.setMonth(0);currentDate.setDate(1);makeCal.pareData(currentDate);makeCal.showCal(currentDate);$("#year_time").text(currentDate.getFullYear()+"年"+(currentDate.getMonth()+1)+"月");showingToday=true;makeCal.makeHuangli(currentDate);case"yuandan":case"chunjie":case"qingmingjie":case"laodong":case"duanwu":case"zhongqiu":case"guoqing":$("#festival_rest").text(fangjiaData[b]);settoFestival(b);break;default:$("#festival_rest").text("");break;}}function settoFestival(a){if(a=="qingming"){a="qingmingjie";}var b=festivalData[a].split("_");currentDate.setFullYear(parseInt(b[0],10));currentDate.setMonth(parseInt(b[1],10)-1,1);currentDate.setDate(parseInt(b[2],10));makeCal.prepareData4Festival((new Date()).getFullYear(),currentDate);makeCal.showCal(currentDate);makeCal.makeHuangli(currentDate);}