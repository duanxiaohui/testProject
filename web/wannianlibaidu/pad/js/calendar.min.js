(function(){var b,c;$.route=function(f,e){f=f||{};var d;(b||(b=/([\d\w_]+)/g)).lastIndex=0;while((d=b.exec(e))!==null){f=f[d[0]];if(f==undefined){break}}return f};$.format=function(){var e=$.makeArray(arguments),g=String(e.shift()||""),d=[],f=e[0];e=$.isArray(f)?f:typeof(f)=="object"?e:[e];$.each(e,function(h,j){d.push(g.replace(c||(c=/\{([\d\w\.]+)\}/g),function(i,l,k){k=l==="INDEX"?h:l.indexOf(".")<0?j[l]:$.route(j,l);return k===undefined?i:($.isFunction(k)?k.call(j,l):k)}))});return d.join("")};var a;$.padWithZero=function(d){return d.replace((a||(a=/(^|\D)(\d)(?=$|\D)/g)),"$10$2")}})();function Calendar(a){this.date=a?new Date(+a):(G.currDate||new Date)}Calendar.prototype={getMonthFirstDate:function(){var a=new Date(+this.date);a.setDate(1);return a},getCalendarFirstDate:function(c){var b=this.getMonthFirstDate(),a=b.getDay();b.setDate(b.getDate()-(c?a:a==0?6:(a-1)));return b}};$.widget("meixx.webCalendar",{options:{defDate:new Date(),onselect:$.noop},_create:function(){var b=this,a=$(this.element),d=this.options;
var c=this.today=d.defDate,e=c.getFullYear(),f=c.getMonth()+1;this.panel=a.find("ul.js-cld-panel");this.tmplDate='<li class="{monthClass}" date="{date}"><div class="date_box"><div class="icon"></div><div class="calendar_date">{solar}</div><div class="calendar_lunar">{lunar}</div></div></li>';this.initCalendar(e,f);d.onselect.call(b,c,lunar(c));this.handleClick();this.initDatePicker()},initCalendar:function(l,i){var o=this,f=$(this.element),e=this.options;var j=new Date(l,i-1,1),k=new Calendar(j),b=k.getCalendarFirstDate(),n=this.today;this.year=j.getFullYear();this.month=j.getMonth()+1;$("#sp_year").html(this.year);$("#sp_month").html(this.month);var m={},a={};$.each("m1d1 m1d2 m1d3 m2d9 m2d10 m2d11 m2d12 m2d13 m2d14 m2d15 m4d4 m4d5 m4d6 m4d29 m4d30 m5d1 m6d10 m6d11 m6d12 m9d19 m9d20 m9d21 m10d1 m10d2 m10d3 m10d4 m10d5 m10d6 m10d7".split(" "),function(c,d){m[d]="rest"});$.each("m1d5 m1d6 m2d16 m2d17 m4d7 m4d27 m4d28 m6d8 m6d9 m9d22 m9d29 m10d12".split(" "),function(c,d){a[d]="work"});var h=new Date(b),g=$.map(new Array(42),function(z,r){var u=h.getFullYear(),c=h.getMonth(),t=h.getDate(),v=h.getDay(),p=lunar(h);
var q=[],x="m"+(c+1)+"d"+t;c!=o.month-1&&q.push("befor");t==n.getDate()&&c==n.getMonth()&&u==n.getFullYear()&&q.push("today");(v==0||v==6)&&q.push("weekend");var s=p.festival();p.term?q.push("solar"):s.length?q.push("isolar"):"";if(u==2013){m[x]&&q.push(m[x],"vacation");a[x]&&q.push(a[x])}h.setDate(h.getDate()+1);return $.format(o.tmplDate,{monthClass:q.join(" "),solar:t,lunar:s[0]&&s[0].desc.length<7&&s[0].desc||p.term||p.dateIndex==0&&(p.lMonth+"月"+(p.isBigMonth?"大":"小"))||p.lDate,date:[u,c+1,t].join("/")})});this.panel.html(g)},handleClick:function(){var b=this,a=$(this.element),c=this.options;$("li",b.panel).live("click",function(){b.panel.find("li.on").removeClass("on");b.panel.find("li.reston").removeClass("reston").addClass("rest");b.panel.find("li.workon").removeClass("workon").addClass("work");var i=$(this).addClass("on"),f=i.attr("date"),h=new Date(f),e=h.getFullYear(),g=h.getMonth()+1;if(g!=b.month){b.initCalendar(e,g);b.panel.find('li[date="'+f+'"]').addClass("on");b.panel.find('li[date="'+f+'"]').click()
}else{c.onselect.call(b,h,lunar(h))}})},initDatePicker:function(){var b=this,a=$(this.element),c=this.options;a.find("div.operate_btn a").click(function(e){e.preventDefault();var d=$(this),f=d.attr("delta")-0;if(f){b.initCalendar(b.year,b.month+f)}else{b.initCalendar(b.today.getFullYear(),b.today.getMonth()+1);b.panel.find("li.today").click()}})},getYear:function(){return this.year},getMonth:function(){return this.month},getPanel:function(){return this.panel}});$.widget("meixx.dayDetail",{options:{},_create:function(){var b=this,a=$(this.element),c=this.options;this.tmpl='<div class="alm_date">{padmonth}月{paddate}日 {week}</div><div class="alm_content">{istoday}		<div class="today_date">{date}</div><p>农历{lmonth}月{ldate}</p><p>{gzyear}年 {gzmonth}月 {gzdate}日</p><p>【{animal}年】</p>		<div class="yj_box e_clear"><div class="yi"></div><div class="ji"></div></div></div>'},init:function(e,g){var j=this,c=$(this.element),b=this.options;var i=e.getFullYear(),f=e.getMonth()+1,h=e.getDate(),a=new Date();
c.html($.format(this.tmpl,{year:i,padmonth:("0"+f).slice(-2),paddate:("0"+h).slice(-2),date:h,week:"星期"+g.cnDay,animal:g.animal,istoday:a.getDate()==h&&a.getMonth()==e.getMonth()&&a.getFullYear()==i?'<div class="today_icon"></div>':"",lmonth:g.lMonth,ldate:g.lDate,gzyear:g.gzYear,gzmonth:g.gzMonth,gzdate:g.gzDate}));this.loadLuckyData(i,f,h)},loadLuckyData:function(h,a,g){var c=this,b=$(this.element),e=this.options;var f="d"+("0"+a).slice(-2)+("0"+g).slice(-2);if(window.HuangLi&&HuangLi["y"+h]){this.fillLuckyData(HuangLi["y"+h][f])}else{if(h>2007&&h<2021){$.getScript("http://up1.365rili.com/js/huangli/hl"+h+".js",function(){c.fillLuckyData(HuangLi["y"+h][f])})}else{this.fillLuckyData({y:"",j:""})}}},fillLuckyData:function(e){var b=this,a=$(this.element),d=this.options;var f=e.y.replace(/^\.|\.$/g,"").split("."),c=e.j.replace(/^\.|\.$/g,"").split(".");a.find("div.yi").html(dealString(f)).attr("title",f.join(" "));a.find("div.ji").html(dealString(c)).attr("title",c.join(" "))}});function dealString(a){a=a.sort(function(e,d){return e.length-d.length
});var c=[],b;$.each(a,function(d,e){c.push(e)});return c.slice(0,5).join("<br>")}$.widget("zmc.vacationLayer",{options:{},_create:function(){var b=this,a=$(this.element),c=this.options;a.append(c.tmplHead+$.format(c.tmplBody,c.data)+c.tmplTail);a.click(function(){var e=$("div.vac_solar_layer",this),d=e.is(":visible");$("#div_buttons div.vac_solar_layer").not(e).hide();e[d?"hide":"show"]()});a.find("li").click(function(e){e.stopPropagation();var h=$(this),f=c.type=="v"?2013:($("#bd").webCalendar("getYear")-($("#bd").webCalendar("getMonth")==1?1:0)),d=h.attr("idx")-0;var g=c.type=="v"?h.attr("month")-0:Math.ceil((d+1)/2)+1;a.find("div.vac_solar_layer").hide();$("#bd").webCalendar("initCalendar",f,g);if(c.type=="s"){$("#bd").webCalendar("getPanel").find("li:not(.befor).solar:"+(d%2?"last":"first")).addClass("on").click()}});if(c.bdParam.slice(0,4)!="rili"){switch(c.bdParam){case"jieqi":c.type=="s"&&a.click();break;case"jiaqi":c.type=="v"&&a.click();break;default:if(c.bdParam){a.find('div.vac_solar_layer li[pinyin="'+c.bdParam+'"]').click()
}}}}});(function(){var b,a;$.query=function(c){if(!b){b={};if(a=location.search.slice(1)+"&"+location.hash.slice(1)){$.each(a.split("&"),function(e,f,d,g){f=f.split("="),d=f[0],g=f[1];if(d in b){if($.isArray(b[d])){b[d].push(g)}else{b[d]=[b[d],g]}}else{b[d]=g}})}}return b[c]}})();$(function(){var b=$("#div_day_detail"),a=($.query("bd_param")||"").toLowerCase();b.dayDetail();$("#bd").webCalendar({defDate:a.slice(0,4)=="rili"?new Date(a.split("_")[1],0,1):void (0),onselect:function(e,c){b.dayDetail("init",e,c)}});$("#div_buttons div.operate_vacation").vacationLayer({type:"v",bdParam:a,tmplHead:'<div class="vac_solar_layer vac_layer none"><h3>2013年公休放假安排</h3><ul>',tmplTail:"</ul></div>",tmplBody:'<li month="{month}" pinyin="{py}"><p class="name">{name}</p><p class="time">{time}</p></li>',data:[{name:"元旦",time:"1月1日~3日",month:1,py:"yuandan"},{name:"春节",time:"2月9日~15日",month:2,py:"chunjie"},{name:"清明节",time:"4月4日~6日",month:4,py:"qingming"},{name:"劳动节",time:"4月29日~5月1日",month:5,py:"laodong"},{name:"端午节",time:"6月10日~12日",month:6,py:"duanwu"},{name:"中秋节",time:"9月19日~9月21日",month:9,py:"zhongqiu"},{name:"国庆节",time:"10月1日~10月7日",month:10,py:"guoqing"}]});
$("#div_buttons div.solar_terms").vacationLayer({type:"s",bdParam:a,tmplHead:'<div class="vac_solar_layer solar_layer none"><h3>中国农历·二十四节气</h3><ul>',tmplTail:"</ul></div>",tmplBody:'<li idx="{INDEX}" pinyin="{py}"><p>{name}</p></li>',data:[{name:"立春",py:"lichun"},{name:"雨水",py:"yushui"},{name:"惊蛰",py:"jingzhe"},{name:"春分",py:"chunfen"},{name:"清明",py:"qingming"},{name:"谷雨",py:"guyu"},{name:"立夏",py:"lixia"},{name:"小满",py:"xiaoman"},{name:"芒种",py:"mangzhong"},{name:"夏至",py:"xiazhi"},{name:"小暑",py:"xiaoshu"},{name:"大暑",py:"dashu"},{name:"立秋",py:"liqiu"},{name:"处暑",py:"chushu"},{name:"白露",py:"bailu"},{name:"秋分",py:"qiufen"},{name:"寒露",py:"hanlu"},{name:"霜降",py:"shuangjiang"},{name:"立冬",py:"lidong"},{name:"小雪",py:"xiaoxue"},{name:"大雪",py:"daxue"},{name:"冬至",py:"dongzhi"},{name:"小寒",py:"xiaohan"},{name:"大寒",py:"dahan"}]})});