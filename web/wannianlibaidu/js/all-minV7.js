var JSON=function(){var a={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b={"boolean":function(a){return String(a)},number:function(a){return isFinite(a)?String(a):"null"},string:function(b){/["\\\x00-\x1f]/.test(b)&&(b=b.replace(/([\x00-\x1f\\"])/g,function(b,e){var f=a[e];if(f)return f;f=e.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)}));return'"'+b+'"'},object:function(a){if(a){var c=[],g,f,h,j,k;if(a instanceof Array){c[0]=
"[";j=a.length;for(h=0;h<j;h+=1)if(k=a[h],f=b[typeof k])k=f(k),typeof k=="string"&&(g&&(c[c.length]=","),c[c.length]=k,g=true);c[c.length]="]"}else if(a instanceof Object){c[0]="{";for(h in a)if(k=a[h],f=b[typeof k])k=f(k),typeof k=="string"&&(g&&(c[c.length]=","),c.push(b.string(h),":",k),g=true);c[c.length]="}"}else return;return c.join("")}return"null"}};return{copyright:"(c)2005 JSON.org",license:"http://www.crockford.com/JSON/license.html",stringify:function(a){var c=b[typeof a];return c&&(a=
c(a),typeof a=="string")?a:null},parse:function(a){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+a+")")}catch(b){return false}}}}(),lunarInfo=[19416,19168,42352,21717,53856,55632,21844,22191,39632,21970,19168,42422,42192,53840,53909,46415,54944,44450,38320,18807,18815,42160,46261,27216,27968,43860,11119,38256,21234,18800,25958,54432,59984,27285,23263,11104,34531,37615,51415,51551,54432,55462,46431,22176,42420,9695,37584,53938,43344,46423,27808,46416,
21333,19887,42416,17779,21183,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,38310,38335,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,20854,21183,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,
53430,53855,54560,56645,46496,22224,21938,18864,42359,42160,43600,45653,27951,44448,19299,37759,18936,18800,25776,26790,59999,27424,42692,43759,37600,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,19285,19311,42352,21732,53856,59752,54560,55968,27302,22239,19168,43476,42192,53584,62034,54560],solarMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Gan="\u7532,\u4e59,\u4e19,\u4e01,\u620a,\u5df1,\u5e9a,\u8f9b,\u58ec,\u7678".split(","),
Zhi="\u5b50,\u4e11,\u5bc5,\u536f,\u8fb0,\u5df3,\u5348,\u672a,\u7533,\u9149,\u620c,\u4ea5".split(","),Animals="\u9f20,\u725b,\u864e,\u5154,\u9f99,\u86c7,\u9a6c,\u7f8a,\u7334,\u9e21,\u72d7,\u732a".split(","),solarTerm="\u5c0f\u5bd2,\u5927\u5bd2,\u7acb\u6625,\u96e8\u6c34,\u60ca\u86f0,\u6625\u5206,\u6e05\u660e,\u8c37\u96e8,\u7acb\u590f,\u5c0f\u6ee1,\u8292\u79cd,\u590f\u81f3,\u5c0f\u6691,\u5927\u6691,\u7acb\u79cb,\u5904\u6691,\u767d\u9732,\u79cb\u5206,\u5bd2\u9732,\u971c\u964d,\u7acb\u51ac,\u5c0f\u96ea,\u5927\u96ea,\u51ac\u81f3".split(","),
sTermInfo=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758],nStr1="\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d,\u4e03,\u516b,\u4e5d,\u5341".split(","),nStr2=["\u521d","\u5341","\u5eff","\u5345","\u25a1"],monthName="JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC".split(","),cmonthName="\u6b63,\u4e8c,\u4e09,\u56db,\u4e94,\u516d,\u4e03,\u516b,\u4e5d,\u5341,\u5341\u4e00,\u814a".split(","),
sFtv="0101*\u5143\u65e6,0214 \u60c5\u4eba\u8282,0308 \u5987\u5973\u8282,0312 \u690d\u6811\u8282,0401 \u611a\u4eba\u8282,0422 \u5730\u7403\u65e5,0501 \u52b3\u52a8\u8282,0504 \u9752\u5e74\u8282,0531 \u65e0\u70df\u65e5,0601 \u513f\u7ae5\u8282,0606 \u7231\u773c\u65e5,0701 \u5efa\u515a\u65e5,0707 \u6297\u6218\u7eaa\u5ff5\u65e5,0801 \u5efa\u519b\u8282,0910 \u6559\u5e08\u8282,0918 \u4e5d\u00b7\u4e00\u516b\u4e8b\u53d8\u7eaa\u5ff5\u65e5,1001*\u56fd\u5e86\u8282,1031 \u4e07\u5723\u8282,1111 \u5149\u68cd\u8282,1201 \u827e\u6ecb\u75c5\u65e5,1213 \u5357\u4eac\u5927\u5c60\u6740\u7eaa\u5ff5\u65e5,1224 \u5e73\u5b89\u591c,1225 \u5723\u8bde\u8282".split(","),
wFtv=["0520 \u6bcd\u4eb2\u8282","0630 \u7236\u4eb2\u8282","1144 \u611f\u6069\u8282"],lFtv="0101*\u6625\u8282,0115 \u5143\u5bb5\u8282,0202 \u9f99\u62ac\u5934,0505 \u7aef\u5348\u8282,0707 \u4e03\u5915,0715 \u4e2d\u5143\u8282,0815 \u4e2d\u79cb\u8282,0909 \u91cd\u9633\u8282,1208 \u814a\u516b\u8282,1223 \u5c0f\u5e74,0100*\u9664\u5915".split(",");function lYearDays(a){var b,e=348;for(b=32768;b>8;b>>=1)e+=lunarInfo[a-1900]&b?1:0;return e+leapDays(a)}
function leapDays(a){return leapMonth(a)?(lunarInfo[a-1899]&15)==15?30:29:0}function leapMonth(a){a=lunarInfo[a-1900]&15;return a==15?0:a}function monthDays(a,b){return lunarInfo[a-1900]&65536>>b?30:29}
function Lunar(a){for(var b=0,e=0,c=(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(1900,0,31))/864E5,a=1900;a<2100&&c>0;a++)e=lYearDays(a),c-=e;c<0&&(c+=e,a--);this.year=a;b=leapMonth(a);this.isLeap=false;for(a=1;a<13&&c>0;a++){b>0&&a==b+1&&this.isLeap==false?(--a,this.isLeap=true,e=leapDays(this.year)):e=monthDays(this.year,a);if(this.isLeap==true&&a==b+1)this.isLeap=false;c-=e}if(c==0&&b>0&&a==b+1)this.isLeap?this.isLeap=false:(this.isLeap=true,--a);c<0&&(c+=e,--a);this.month=a;this.day=
c+1}function getSolarDate(a,b,e,c){for(var g=0,f=1900;f<a;f++)g+=lYearDays(f);for(f=1;f<b;f++)f==leapMonth(a)&&(g+=leapDays(a)),g+=monthDays(a,f);c&&(g+=monthDays(a,f));g+=parseInt(e)-1;return new Date((new Date(1900,0,31)).valueOf()+g*864E5)}function solarDays(a,b){return b==1?a%4==0&&a%100!=0||a%400==0?29:28:solarMonth[b]}function cyclical(a){return Gan[a%10]+Zhi[a%12]}
function calElement(a,b,e,c,g,f,h,j,k,m,n){this.isToday=false;this.sYear=a;this.sMonth=b;this.sDay=e;this.week=c;this.lYear=g;this.lMonth=f;this.lDay=h;this.isLeap=j;this.cYear=k;this.cMonth=m;this.cDay=n;this.solarTerms=this.solarFestival=this.lunarFestival=this.color=""}function sTerm(a,b){return(new Date(3.15569259747E10*(a-1900)+sTermInfo[b]*6E4+Date.UTC(1900,0,6,2,5))).getUTCDate()}
function calendar(a,b){var e,c,g,f,h=1,j=0,k,m,n=Array(3),o=0,q=0;e=new Date(a,b,1,0,0,0,0);this.length=solarDays(a,b);this.firstWeek=e.getDay();k=b<2?cyclical(a-1900+36-1):cyclical(a-1900+36);var r=sTerm(a,2),s=sTerm(a,b*2);m=cyclical((a-1900)*12+b+12);for(var p=Date.UTC(a,b,1,0,0,0,0)/864E5+25577,l=0;l<this.length;l++){if(h>j)e=new Date(a,b,l+1),c=new Lunar(e),g=c.year,f=c.month,h=c.day,j=(c=c.isLeap)?leapDays(g):monthDays(g,f),o==0&&(q=f),n[o++]=l-h+1;b==1&&l+1==r&&(k=cyclical(a-1900+36));l+1==
s&&(m=cyclical((a-1900)*12+b+13));e=cyclical(p+l);this[l]=new calElement(a,b+1,l+1,nStr1[(l+this.firstWeek)%7],g,f,h++,c,k,m,e)}g=sTerm(a,b*2)-1;f=sTerm(a,b*2+1)-1;this[g].solarTerms=solarTerm[b*2];this[f].solarTerms=solarTerm[b*2+1];for(l in sFtv)if(sFtv[l].match(/^(\d{2})(\d{2})([\s\*])(.+)$/)&&Number(RegExp.$1)==b+1&&(this[Number(RegExp.$2)-1].solarFestival+=RegExp.$4+" ",RegExp.$3=="*"))this[Number(RegExp.$2)-1].color="red";for(l in wFtv)wFtv[l].match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/)&&Number(RegExp.$1)==
b+1&&(g=Number(RegExp.$2),f=Number(RegExp.$3),g<5?this[(this.firstWeek>f?7:0)+7*(g-1)+f-this.firstWeek].solarFestival+=RegExp.$5+" ":(g-=5,h=(this.firstWeek+this.length-1)%7,this[this.length-h-7*g+f-(f>h?7:0)-1].solarFestival+=RegExp.$5+" "));for(l in lFtv)if(lFtv[l].match(/^(\d{2})(.{2})([\s\*])(.+)$/)&&(g=Number(RegExp.$1)-q,g==-11&&(g=1),g>=0&&g<o&&(f=n[g]+Number(RegExp.$2)-1,f>=0&&f<this.length&&this[f].isLeap!=true&&(this[f].lunarFestival+=RegExp.$4+" ",RegExp.$3=="*"))))this[f].color="red"}
function cDay(a){var b;switch(a){case 10:b="\u521d\u5341";break;case 20:b="\u4e8c\u5341";break;case 30:b="\u4e09\u5341";break;default:b=nStr2[Math.floor(a/10)],b+=nStr1[a%10]}return b}
var worktime={y2013:{d0101:{w:"\u653e\u5047"},d0102:{w:"\u653e\u5047"},d0103:{w:"\u653e\u5047"},d0105:{w:"\u4e0a\u73ed"},d0106:{w:"\u4e0a\u73ed"},d0209:{w:"\u653e\u5047"},d0210:{w:"\u653e\u5047"},d0211:{w:"\u653e\u5047"},d0212:{w:"\u653e\u5047"},d0213:{w:"\u653e\u5047"},d0214:{w:"\u653e\u5047"},d0215:{w:"\u653e\u5047"},d0216:{w:"\u4e0a\u73ed"},d0217:{w:"\u4e0a\u73ed"},d0404:{w:"\u653e\u5047"},d0405:{w:"\u653e\u5047"},d0406:{w:"\u653e\u5047"},d0407:{w:"\u4e0a\u73ed"},d0427:{w:"\u4e0a\u73ed"},d0428:{w:"\u4e0a\u73ed"},
d0429:{w:"\u653e\u5047"},d0430:{w:"\u653e\u5047"},d0501:{w:"\u653e\u5047"},d0608:{w:"\u4e0a\u73ed"},d0609:{w:"\u4e0a\u73ed"},d0610:{w:"\u653e\u5047"},d0611:{w:"\u653e\u5047"},d0612:{w:"\u653e\u5047"},d0919:{w:"\u653e\u5047"},d0920:{w:"\u653e\u5047"},d0921:{w:"\u653e\u5047"},d0922:{w:"\u4e0a\u73ed"},d0929:{w:"\u4e0a\u73ed"},d1001:{w:"\u653e\u5047"},d1002:{w:"\u653e\u5047"},d1003:{w:"\u653e\u5047"},d1004:{w:"\u653e\u5047"},d1005:{w:"\u653e\u5047"},d1006:{w:"\u653e\u5047"},d1007:{w:"\u653e\u5047"},d1012:{w:"\u4e0a\u73ed"}}},
festival_main={"2013_01_01":"\u5143\u65e6","2013_02_10":"\u6625\u8282","2013_04_04":"\u6e05\u660e\u8282","2013_05_01":"\u52b3\u52a8\u8282","2013_06_12":"\u7aef\u5348\u8282","2013_09_19":"\u4e2d\u79cb\u8282","2013_10_01":"\u56fd\u5e86\u8282"};$.dom=function(a){return document.getElementById(a)};function StringBuffer(){this._strings=[]}StringBuffer.prototype.append=function(a){this._strings.push(a);return this};
StringBuffer.prototype.toString=function(){return this._strings.join(arguments.length==0?"":arguments[0])};String.prototype.leftpad=function(a,b){b||(b="0");for(var e="",c=0;c<a-this.length;c++)e+=b;return e+this};function getMonthKey(a,b){return a.toString()+(b+1).toString().leftpad(2)}function getDateKey(a){return a.getFullYear().toString()+"-"+(a.getMonth()+1).toString().leftpad(2)+"-"+a.getDate().toString().leftpad(2)}function is_leap_year(a){return a%400==0||a%100!=0&&a%4==0?1:0}
function getDaysByMonth(a){return[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]][is_leap_year(a.getFullYear())][a.getMonth()]}
var cacheMgr={cldCache:{},getCld:function(a,b){var e=getMonthKey(a,b),c=this.cldCache[e];typeof c=="undefined"&&(c=new calendar(a,b),this.cldCache[e]=c);return c}},cal365={date:{date_part:function(a){a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a},month_view_start:function(a,b){return this.week_start(this.month_start(a),b)},week_start:function(a,b){var e=a.getDay();b&&(e==0?e=6:e--);return this.date_part(this.add(a,-1*e,"day"))},month_start:function(a){a.setDate(1);return this.date_part(a)},
add:function(a,b,e){var c=new Date(a.valueOf());switch(e){case "day":c.setDate(c.getDate()+b);break;case "week":c.setDate(c.getDate()+7*b);break;case "month":c.setMonth(c.getMonth()+b);break;case "year":c.setYear(c.getFullYear()+b);break;case "hour":c.setHours(c.getHours()+b);break;case "minute":c.setMinutes(c.getMinutes()+b);break;default:return defaults.date["add_"+e](a,b,e)}return c},to_fixed:function(a){return a<10?"0"+a:a},copy:function(a){return new Date(a.valueOf())},date_to_str:function(a,
b){a=a.replace(/%[a-zA-Z]/g,function(a){switch(a){case "%d":return'"+cal365.date.to_fixed(date.getDate())+"';case "%m":return'"+cal365.date.to_fixed((date.getMonth()+1))+"';case "%j":return'"+date.getDate()+"';case "%n":return'"+(date.getMonth()+1)+"';case "%y":return'"+cal365.date.to_fixed(date.getYear()%100)+"';case "%Y":return'"+date.getFullYear()+"';case "%D":return'"+cal365.locale.date.day_short[date.getDay()]+"';case "%l":return'"+cal365.locale.date.day_full[date.getDay()]+"';case "%M":return'"+cal365.locale.date.month_short[date.getMonth()]+"';
case "%F":return'"+cal365.locale.date.month_full[date.getMonth()]+"';case "%h":return'"+cal365.date.to_fixed((date.getHours()+11)%12+1)+"';case "%H":return'"+cal365.date.to_fixed(date.getHours())+"';case "%i":return'"+cal365.date.to_fixed(date.getMinutes())+"';case "%a":return'"+(date.getHours()>11?"pm":"am")+"';case "%A":return'"+(date.getHours()>11?"PM":"AM")+"';case "%s":return'"+cal365.date.to_fixed(date.getSeconds())+"';default:return a}});b&&(a=a.replace(/date\.get/g,"date.getUTC"));return new Function("date",
'return "'+a+'";')},str_to_date:function(a,b){for(var e="var temp=date.split(/[^0-9a-zA-Z]+/g);",c=a.match(/%[a-zA-Z]/g),g=0;g<c.length;g++)switch(c[g]){case "%j":case "%d":e+="set[2]=temp["+g+"]||0;";break;case "%n":case "%m":e+="set[1]=(temp["+g+"]||1)-1;";break;case "%y":e+="set[0]=temp["+g+"]*1+(temp["+g+"]>50?1900:2000);";break;case "%h":case "%H":e+="set[3]=temp["+g+"]||0;";break;case "%i":e+="set[4]=temp["+g+"]||0;";break;case "%Y":e+="set[0]=temp["+g+"]||0;";break;case "%a":case "%A":e+="set[3]=set[3]%12+((temp["+
g+"]||'').toLowerCase()=='am'?0:12);";break;case "%s":e+="set[5]=temp["+g+"]||0;"}c="set[0],set[1],set[2],set[3],set[4],set[5]";b&&(c=" Date.UTC("+c+")");return new Function("date","var set=[0,0,0,0,0,0]; "+e+" return new Date("+c+");")}},templates:{},config:{default_date:"%Y-%m-%d %H:%i",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%Y/%m/%d %H:%i",api_date:"%Y-%m-%d %H:%i",server_utc:false}};
cal365.init_templates=function(){var a=cal365.date.date_to_str,b=cal365.config;(function(a,b){for(var g in b)a[g]||(a[g]=b[g])})(cal365.templates,{day_date:a(b.default_date),month_date:a(b.month_date),week_date:function(a,b){return cal365.templates.day_date(a)+" &ndash; "+cal365.templates.day_date(cal365.date.add(b,-1,"day"))},day_scale_date:a(b.default_date),month_scale_date:a(b.week_date),week_scale_date:a(b.day_date),hour_scale:a(b.hour_date),time_picker:a(b.hour_date),event_date:a(b.hour_date),
month_day:a(b.month_day),xml_date:cal365.date.str_to_date(b.xml_date,b.server_utc),load_format:a(b.load_date,b.server_utc),xml_format:a(b.xml_date,b.server_utc),api_date:cal365.date.str_to_date(b.api_date),event_header:function(a,b){return cal365.templates.event_date(a)+" - "+cal365.templates.event_date(b)},event_text:function(a,b,g){return g.text},event_class:function(){return""},month_date_class:function(){return""},week_date_class:function(){return""},event_bar_date:function(a){return cal365.templates.event_date(a)+
" "},event_bar_text:function(a,b,g){return g.text}})};
cal365.locale={date:{month_full:"\u4e00\u6708,\u4e8c\u6708,\u4e09\u6708,\u56db\u6708,\u4e94\u6708,\u516d\u6708,\u4e03\u6708,\u516b\u6708,\u4e5d\u6708,\u5341\u6708,\u5341\u4e00\u6708,\u5341\u4e8c\u6708".split(","),month_short:"1\u6708,2\u6708,3\u6708,4\u6708,5\u6708,6\u6708,7\u6708,8\u6708,9\u6708,10\u6708,11\u6708,12\u6708".split(","),day_full:"\u661f\u671f\u65e5,\u661f\u671f\u4e00,\u661f\u671f\u4e8c,\u661f\u671f\u4e09,\u661f\u671f\u56db,\u661f\u671f\u4e94,\u661f\u671f\u516d".split(","),day_short:"\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(",")}};
var CalUtil={monthViewInfo:function(a,b){var e=cal365.date,c={},g=e.copy(a),g=e.month_view_start(g,b);c.start=e.copy(e.week_start(g,b));var f=e.copy(a);f.setMonth(a.getMonth()+1);f.setDate(1);c.row=Math.ceil((f.valueOf()-g.valueOf())/6048E5);c.end=e.add(c.start,7*c.row,"day");return c}},DataHandler={cachedData:{from:new Date,to:new Date},loadCld:{},getLoadCld:function(a,b,e){for(var c=[],a=getDateKey(a)+"-"+getDateKey(b),b=0;b<e.length;b++){var g=a+"-"+e[b];typeof DataHandler.loadCld[g]=="undefined"&&
(c.push(e[b]),DataHandler.loadCld[g]={})}return c.length>0?c.join(","):false},resultData:{},resultDataById:{},getSchByPeriod:function(a,b,e){var c=a,g=b;if(a>=this.cachedData.from)c=this.cachedData.to;if(b<=this.cachedData.to)g=this.cachedData.from;var f=calendarHandler.getSelectedArray();(f=DataHandler.getLoadCld(a,b,f))?$.ajax({data:{fromDate:cal365.templates.load_format(a),toDate:cal365.templates.load_format(b),timeZone:-(new Date).getTimezoneOffset()/60,calendarId:f},url:"http://www.365rili.com/schedule/list.jsonp",
dataType:"jsonp",jsonp:"callback",success:function(a){for(var b=0;b<a.length;b++)DataHandler.formatSchData(a[b].schlist,g);if(DataHandler.cachedData.from>c)DataHandler.cachedData.from=c;if(DataHandler.cachedData.to<g)DataHandler.cachedData.to=g;e&&e()}}):e&&e()},getSchByMonth:function(a,b,e){var c=cal365.date.month_view_start(a,e),a=cal365.date.add(c,CalUtil.monthViewInfo(a,e).row*7,"day");this.getSchByPeriod(c,a,b)},getSchedulesByRange:function(a,b,e,c){var g={},f=e||DataHandler.resultData;typeof a==
"string"&&(a=cal365.templates.api_date(a));typeof b=="string"&&(b=cal365.templates.api_date(b));a=cal365.date.date_part(a);for(b=cal365.date.date_part(b);a<=b;){e="d"+getDateKey(a);g[e]={schList:[],num:0};if(f[e]){for(var h=[],j=0;j<f[e].schList.length;j++)for(var k=f[e].schList[j],m=0;m<c.length;m++)if(k.cid==c[m]){h.push(k);break}g[e].schList=h;g[e].num=h.length}a=cal365.date.add(a,1,"day")}var a=0,n;for(n in g)if(e=g[n],e.num>a)a=e.num;g.maxNum=a;return g},formatSchData:function(a,b){for(var e=
{},c=0;c<a.length;c++){var g=a[c];if(""==g.text)g.text="(\u65e0\u6807\u9898)";var f=cal365.templates.api_date(g.start_time),h=new Date(f.valueOf()+g.duration*1E3),j=cal365.date.copy(f),j=cal365.date.add(cal365.date.date_part(j),1,"day");g.isDisplay=0;if(j>=h)h="d"+getDateKey(f),e[h]||(e[h]={schList:[]}),e[h].schList.push(g);else for(var k=cal365.date.copy(f);k<h&&k<b;)f="d"+getDateKey(k),j=DataHandler.copySch(g),j.cross_st=cal365.templates.day_date(k)+":00",k=cal365.date.add(cal365.date.date_part(k),
1,"day"),j.cross_et=k<=h?cal365.templates.day_date(k)+":00":cal365.templates.day_date(h)+":00",e[f]||(e[f]={schList:[]}),e[f].schList.push(j)}DataHandler.mergeData(DataHandler.resultData,e);DataHandler.formatSchDataById(a)},formatSchDataById:function(a){for(var b={},e=0;e<a.length;e++)b[a[e].id]=a[e];$.extend(true,DataHandler.resultDataById,b)},mergeData:function(a,b){for(var e in b){if(a[e])for(var c=b[e].schList,g=a[e].schList,f=0;f<c.length;++f){for(var h=false,j=0;j<g.length;++j)if(g[j].id==c[f].id){g[j]=
c[f];h=true;break}h||g.push(c[f])}else a[e]=b[e];a[e].schList.sort(function(a,b){if(a.allday_event)return-1;if(b.allday_event)return 1;var c=cal365.templates.api_date(a.start_time).getTime(),e=cal365.templates.api_date(b.start_time).getTime();return c-e})}},delSchById:function(a){for(var b in DataHandler.resultData)for(var e=DataHandler.resultData[b].schList,c=0;c<e.length;++c)e[c].id==a&&(e.splice(c,1),--c);delete DataHandler.resultDataById[a]},updateSch:function(a,b){DataHandler.delSchById(a[0].id);
DataHandler.formatSchData(a,b)},copySch:function(a){var b=function(){};b.prototype=a;return new b}};
(function(a){var b=/^d(\d{4})-(\d{2})-(\d{2})/,e=/^0/,c=null,g=null,f=null,h=null,j=null,k=function(a){g&&DataHandler.getSchByMonth(g,function(){var b=CalUtil.monthViewInfo(g,true),e=b.start,b=b.end,f=[];f.push(c);j=DataHandler.getSchedulesByRange(e,b,DataHandler.resultData,f);a&&a()},true)},m=function(a,c,g,h,p){var l={};l.schTitle=a;(l.alldayEvent=c)?l.startTime=getDateKey(f)+" 09:00:00":(g+="",h+="",l.startTime=getDateKey(f)+" "+g.leftpad(2)+":"+h.leftpad(2)+":00");l.timeZone=-(new Date).getTimezoneOffset()/
60;var m=cal365.date.add(cal365.templates.api_date(l.startTime),1,"day");$.ajax({data:l,url:"http://www.365rili.com/schedule/update.jsonp",dataType:"jsonp",jsonp:"callback",success:function(a){for(var c=0;c<a.length;c++)DataHandler.formatSchData(a[c].schlist,m);k(function(){for(var a in j)if(a!="maxNum"){var c=j[a].num,g=a.replace(b,function(a,b,c,g){return b+"-"+c.replace(e,"")+"-"+g.replace(e,"")});c>0&&p(cal365.templates.api_date(g))}})}})},n={drawSch:function(a){$("#taskList").children().remove();
var b=[];if(a.length>0)for(var c=0;c<3&&c<a.length;c++){var e;a:{e=a[c].text;for(var g=0,f=void 0,f=0;f<e.length;f++){var h=e.charCodeAt(f);h>=1&&h<=126||65376<=h&&h<=65439?g++:g+=2;if(g>=10){e=e.substring(0,f+1);break a}}}e.length<a[c].text.length&&(e+="...");g="&nbsp;";a[c].allday_event||(g=a[c].start_time.split(" ")[1].split(":"),g.splice(2),g=g.join(":")+"&nbsp;");b.push("<div class='workitem'>");b.push("<div class='tastWorkDot'></div>");a[c].allday_event?b.push("<div style='margin-left:11px;'>"+
e+"</div>"):(b.push("<div class='taskWorkTime'>"+g+"</div>"),b.push("<div style='margin-left:5px;'>"+e+"</div>"));b.push("</div>")}$("#taskList").html(b.join(""))}};if(a.calendarHandler)a._calendarHandler=a.calendarHandler;a.calendarHandler={init:function(a){typeof a=="number"?c=a:typeof a=="string"&&(c=parseInt(a));g=f=new Date;cal365.init_templates()},isLogin:function(){return!!c},getSelectedArray:function(){var a=[];a.push(c);return a},prepareData4:function(a,c,f){var h=new Date;h.setYear(a);h.setMonth(c-
1);h.setDate(1);g=h instanceof Date?h:null;k(function(){for(var a in j)if(a!="maxNum"){var c=j[a].num,g=a.replace(b,function(a,b,c,g){return b+"-"+c.replace(e,"")+"-"+g.replace(e,"")});c>0&&(c=cal365.templates.api_date(g),f(c))}})},getSelectedDate:function(){return f},setSelectedDate:function(a){typeof a=="string"?f=cal365.templates.api_date(a):a instanceof Date&&(f=a)},getSch:function(){return j["d"+getDateKey(h)]},addSch:function(a,b,c,e,g){m(a,b,c,e,g)},drawSch:function(){this.isLogin()&&n.drawSch(this.getSch().schList)},
setHoverDate:function(a){typeof a=="string"?h=cal365.templates.api_date(a):a instanceof Date&&(h=a)}}})(window);var HuangLi={},calData=[],currentDate=new Date,rows,showingToday=true,taskHover_inblock=false,taskHover_inhover=false,madeRiliDate=new Date,record={elem_id:"",nav_date:new Date},timeSelf=0,timeBeijing;function clock(a){timeSelf=(new Date).getTime();timeBeijing=a*1E3}
var calander={init:function(){makeCal.pareData(new Date);makeCal.showCal(new Date);makeCal.initAction();makeCal.makeHuangli(currentDate)},pareData:function(a){a=makeCal.setTimeZero(a);madeRiliDate=new Date(a);var a=makeCal.getMonthFirst(a),b=makeCal.getWeekFirst(a),e=makeCal.addTime(a,1,"month"),c=makeCal.addTime(e,-1,"day");rows=Math.ceil((e.valueOf()-b.valueOf())/6048E5);b=new Date(b);e=makeCal.setTimeZero(new Date);makeCal.fillCalData(b,a,c,e)},fillCalData:function(a,b,e,c){calData=[];for(var g=
0;g<rows;g++){for(var f=[],h=0;h<7;h++){var j=makeCal.createDay();j.year=a.getFullYear();j.month=a.getMonth();j.date=a.getDate();if(a.getTime()<b.getTime())j.before=true;else if(a.getTime()>e.getTime())j.after=true;if(a.getTime()==c.getTime())j.today=true;if(h==5||h==6)j.weekend=true;j.rows=rows;j.inrow=g+1;j.value=a;j.china=templates.lunar_Info(j.value);switch(j.value.getFullYear()+"-"+(j.value.getMonth()+1)+"-"+j.value.getDate()){case "2011-11-22":j.china.l_day="\u5eff\u4e03";j.china.color="";break;
case "2011-11-23":j.china.l_day="\u5c0f\u96ea";j.china.color="#bc5016";break;case "2012-1-1":j.china.l_day="\u5143\u65e6";j.china.color="#bc5016";break;case "2012-1-20":j.china.l_day="\u5eff\u4e03";j.china.color="";break;case "2012-1-21":j.china.l_day="\u5927\u5bd2",j.china.color="#bc5016"}f.push(j);a=makeCal.addTime(a,1,"day")}calData.push(f)}},prepareData4Festival:function(a,b){b=makeCal.setTimeZero(b);madeRiliDate=new Date(b);for(var e=b,c=b;;){var g=worktime["y"+e.getFullYear()],f=getMonthDateStr(e);
if(g["d"+f])e=makeCal.addTime(e,-1,"day");else{e=makeCal.addTime(e,1,"day");break}}for(;;)if(g=worktime["y"+c.getFullYear()],f=getMonthDateStr(c),g["d"+f])c=makeCal.addTime(c,1,"day");else{c=makeCal.addTime(c,-1,"day");break}g=makeCal.getWeekFirst(e);rows=5;g=new Date(g);f=makeCal.setTimeZero(new Date);makeCal.fillCalData(g,e,c,f)},showCal:function(a){typeof a=="undefined"&&(a=date=makeCal.setTimeZero(new Date));a=makeCal.setTimeZero(a);$("#festival_detail_str").text("");$("#month_num").text(a.getMonth()+
1);$("#year_num").text(a.getFullYear());for(var b="<table> \t\t\t\t\t\t<thead class='tablehead'> \t\t\t\t\t\t\t<tr> \t\t\t\t\t\t\t\t<td class='thead"+rows+"'>\u4e00</td> \t\t\t\t\t\t\t\t<td class='thead"+rows+"'>\u4e8c</td> \t\t\t\t\t\t\t\t<td class='thead"+rows+"'>\u4e09</td> \t\t\t\t\t\t\t\t<td class='thead"+rows+"'>\u56db</td> \t\t\t\t\t\t\t\t<td class='thead"+rows+"'>\u4e94</td> \t\t\t\t\t\t\t\t<td class='thead"+rows+"' style='color:#bc5016;'>\u516d</td> \t\t\t\t\t\t\t\t<td class='thead"+rows+
"' style='color:#bc5016;'>\u65e5</td> \t\t\t\t\t\t\t</tr> \t\t\t\t\t\t</thead> \t\t\t\t\t\t<tbody>",e="",c=0;c<rows;c++){for(var g="<tr>",f=0;f<7;f++){e="";calData[c][f].before==true?e="before":calData[c][f].after==true&&(e="after");var h=getMonthDateStr(calData[c][f].value),j="";try{var k=worktime["y"+calData[c][f].year];k&&(j=k["d"+h])}catch(m){}h="";j&&(j.w=="\u4e0a\u73ed"?(e="workBlock",h="work"):(e="restBlock",h="rest"));calData[c][f].today==true&&(e="today today"+calData[c][f].rows);j="number";
calData[c][f].weekend==true&&(j="weekendNum");calData[c][f].before?j="before number":calData[c][f].after&&(j="after number");var n="";calData[c][f].today==false&&calData[c][f].value.getTime()==a.getTime()&&(n=" clickBlock"+calData[c][f].rows);e="<td i="+c+" j="+f+" class='block block"+calData[c][f].rows+" "+e+n+"'>";e+="<div class='block_content block_content"+calData[c][f].rows+"'>";h=="work"?e+="<div class='workrest work'></div>":h=="rest"&&(e+="<div class='workrest rest'></div>");e+=calData[c][f].today==
false?"\t<div class='"+j+" number"+calData[c][f].rows+"'>"+calData[c][f].date+"</div>\t\t\t\t\t\t\t\t<div class='chinaday chinaday"+calData[c][f].rows+" festival' style='color: "+calData[c][f].china.color+"'>"+calData[c][f].china.l_day+"</div>":"\t<div class='"+j+" number"+calData[c][f].rows+"'>"+calData[c][f].date+"</div>\t\t\t\t\t\t\t\t<div class='chinaday chinaday"+calData[c][f].rows+" festival'>"+calData[c][f].china.l_day+"</div>";calData[c][f].hasWork&&(e+="<img class='workDot workDot"+calData[c][f].rows+
"' src='http://static.365rili.com/wannianlibaidu/BD_images/dot.png'/>");e+="</div></td>";g+=e}g+="<tr>";b+=g}b+="</tbody></table>";$("#mainCal").empty();$("#mainCal").append(b);calendarHandler.prepareData4(a.getFullYear(),a.getMonth()+1,this.appendScheduleIcon);makeCal.makeAction()},appendScheduleIcon:function(a){if(a.getTime()<calData[0][0].value.getTime())return false;var b=(a.getTime()-calData[0][0].value.getTime())/864E5;if(b>7*rows-1)return false;a=Math.floor(b/7);b=Math.floor(b)%7;if(!calData[a][b].hasWork)calData[a][b].hasWork=
true,$("td[i="+a+"][j="+b+"] div:first-child").append("<img class='workDot workDot"+calData[a][b].rows+"' src='http://static.365rili.com/wannianlibaidu/BD_images/dot.png'/>")},initAction:function(){$("#next_button").bind("click",function(){var a=currentDate.getMonth(),b=currentDate.getFullYear(),c=madeRiliDate.getMonth(),a=c;a++;a>11&&(a=0,b++);currentDate=makeCal.addTime(currentDate,1,"month");currentDate.getMonth()!=(c+1)%12&&(currentDate.setDate(1),currentDate.setMonth(c+1));$("#year_num").text(b);
$("#month_num").text(a+1);$("#festival").text("\u5047\u671f\u5b89\u6392");makeCal.nextMonth(currentDate)});$("#prev_button").bind("click",function(){var a=currentDate.getMonth(),b=currentDate.getFullYear(),c=madeRiliDate.getMonth(),a=c;a--;a<0&&(a=11,b--);currentDate=makeCal.addTime(currentDate,-1,"month");currentDate.getMonth()!=(c+11)%12&&(currentDate.setDate(1),currentDate.setMonth((c+11)%12));$("#year_num").text(b);$("#month_num").text(a+1);$("#festival").text("\u5047\u671f\u5b89\u6392");makeCal.prevMonth(currentDate)});
$("#today_button").bind("click",function(){makeCal.showToday()});$("#top_bar_time").text(makeCal.get365riliTime());$("#year_num").text(currentDate.getFullYear());$("#month_num").text(currentDate.getMonth()+1);setInterval(function(){var a=makeCal.get365riliTime();$("#top_bar_time").text(makeCal.get365riliTime());a=="00:00:00"&&showingToday&&(a=new Date,makeCal.pareData(a),makeCal.showCal(a),makeCal.makeHuangli(a),$("#year_num").text(a.getFullYear()),$("#month_num").text(a.getMonth()+1))},1E3);$("#festival").bind("click",
function(){$("#festival_select_selecter").css("display")=="block"?$("#festival_select_selecter").css({display:"none"}):($("#festival_select_selecter").css({top:$("#festival").offset().top+30+"px"}),$("#festival_select_selecter").css({left:$("#festival").position().left+15+"px"}),$("#festival_select_selecter").css({display:"block"}))});$("#month_func").bind("click",function(){$("#month_select_selecter").css("display")=="block"?$("#month_select_selecter").css({display:"none"}):($("#month_select_selecter").css({top:$("#month_func").offset().top+
30+"px"}),$("#month_select_selecter").css({left:$("#month_func").position().left+"px"}),$("#month_select_selecter").css({display:"block"}))});$("#year_func").bind("click",function(){if($("#year_select_selecter").css("display")=="block")$("#year_select_selecter").css({display:"none"});else{$("#year_select_selecter").css({top:$("#year_func").offset().top+30+"px"});$("#year_select_selecter").css({left:$("#year_func").position().left+"px"});$("#year_select_selecter").css({display:"block"});var a=$("#year_num").text(),
a=$("#yearitem"+a).position().top;$("#year_select_selecter").scrollTop(a)}});for(var a=1900;a<=2050;a++)$("#year_select_selecter").append('<div id="yearitem'+a+'" data='+a+' class="select_item year_item">'+a+"</div>");for(a=1;a<=12;a++)$("#month_select_selecter").append("<div data="+(a-1)+' class="select_item month_item">'+a+"\u6708</div>");for(var b in festival_main)$("#festival_select_selecter").append("<div data="+b+' class="select_item festival_item">'+festival_main[b]+"</div>");$("#popHourSelectList").append('<div class="hourItem" data="-1">\u5168\u5929</div>');
for(a=0;a<24;a++)$("#popHourSelectList").append('<div class="hourItem" data="'+a+'">'+a+"\u70b9</div>");for(a=0;a<60;a+=5)$("#popMinuteSelectList").append('<div class="minItem" data="'+a+'">'+a+"\u5206</div>");$("#popMinuteSelect").bind("click",function(){$("#popMinuteSelectList").css({display:"block"})});$("#popHourSelect").bind("click",function(){$("#popHourSelectList").css({display:"block"})});$(".minItem").bind("click",function(a){$("#popMinuteSelectNumb").html($(a.target).html())});$(".hourItem").bind("click",
function(a){$("#popHourSelectNumb").html($(a.target).html());$(a.target).attr("data")=="-1"?$("#popMinuteSelect").css({visibility:"hidden"}):$("#popMinuteSelect").css({visibility:"visible"})});$(".year_item").bind("click",function(a){data=$(a.target).attr("data");currentDate.setFullYear(data);$("#year_num").text(currentDate.getFullYear());makeCal.pareData(currentDate);makeCal.showCal(currentDate);makeCal.makeHuangli(currentDate);$("#festival").text("\u5047\u671f\u5b89\u6392");showingToday=false});
$(".month_item").bind("click",function(a){data=$(a.target).attr("data");currentDate.setMonth(data);currentDate.getMonth()!=data&&(currentDate.setDate(1),currentDate.setMonth(data));$("#month_num").text(currentDate.getMonth()+1);makeCal.pareData(currentDate);makeCal.showCal(currentDate);makeCal.makeHuangli(currentDate);$("#festival").text("\u5047\u671f\u5b89\u6392");showingToday=false});$(".festival_item").bind("click",function(a){var b=$(a.target).attr("data").split("_");currentDate.setFullYear(parseInt(b[0],
10));currentDate.setMonth(parseInt(b[1],10)-1,1);currentDate.setDate(parseInt(b[2],10));$("#year_num").text(currentDate.getFullYear());$("#month_num").text(currentDate.getMonth()+1);$("#festival").text($(a.target).text());makeCal.prepareData4Festival((new Date).getFullYear(),currentDate);makeCal.showCal(currentDate);makeCal.makeHuangli(currentDate);showingToday=false;a=$(a.target).attr("data");a=="2013_01_01"?$("#festival_detail_str").text("1\u67081\u65e5\u81f33\u65e5\u653e\u50473\u5929\uff0c1\u67085\u65e5\u30016\u65e5\u4e0a\u73ed\u3002"):
a=="2013_02_10"?$("#festival_detail_str").text("2\u67089\u65e5\u81f32\u670815\u65e5\u653e\u50477\u5929\uff0c2\u670816\u300117\u65e5\u4e0a\u73ed\u3002"):a=="2013_04_04"?$("#festival_detail_str").text("4\u67084\u65e5\u81f36\u65e5\u653e\u50473\u5929\uff0c4\u67087\u65e5\u4e0a\u73ed\u3002"):a=="2013_05_01"?$("#festival_detail_str").text("4\u670829\u65e5\u81f35\u67081\u65e5\u653e\u50473\u5929\uff0c4\u670827\u300128\u65e5\u4e0a\u73ed\u3002"):a=="2013_06_12"?$("#festival_detail_str").text("6\u670810\u65e5\u81f36\u670812\u65e5\u653e\u50473\u5929\uff0c6\u67088\u30019\u65e5\u4e0a\u73ed\u3002"):
a=="2013_09_19"?$("#festival_detail_str").text("9\u670819\u65e5\u81f39\u670821\u65e5\u653e\u50473\u5929\uff0c9\u670822\u65e5\u4e0a\u73ed\u3002"):a=="2013_10_01"&&$("#festival_detail_str").text("10\u67081\u65e5\u81f310\u67087\u65e5\u653e\u50477\u5929\uff0c9\u670829\u65e5\u300110\u670812\u65e5\u4e0a\u73ed\u3002")});$("body").bind("click",function(a){a.target.id!="year_func"&&a.target.id!="year_num"&&a.target.id!="year_str"&&$("#year_select_selecter").css({display:"none"});a.target.id!="month_func"&&
a.target.id!="month_num"&&a.target.id!="month_str"&&$("#month_select_selecter").css({display:"none"});a.target.id!="festival_button"&&a.target.id!="festival"&&($("#festival_select_block").css({display:"none"}),$("#festival_select_selecter").css({display:"none"}));if($(a.target).hasClass("minuteselect")==false)$("#popMinuteSelectList").css({display:"none"}),document.getElementById("popMinuteSelectList").style.display="none";if($(a.target).hasClass("hourselect")==false)$("#popHourSelectList").css({display:"none"}),
document.getElementById("popHourSelectList").style.display="none";$(a.target).attr("class")!="YJdiv"&&$(a.target).attr("class")!="popYJ"&&$(a.target).attr("class")!="popWord"&&$(a.target).attr("class")!="popHuangliItemY"&&$(a.target).attr("class")!="popHuangliItemJ"&&$(a.target).attr("class")!="popStr"&&$("#huangliDiv").css({display:"none"})});var e=false,c=false;$("#YJdiv").bind("mouseover",function(){e=true;setTimeout(function(){(e||c)&&$("#huangliDiv").css({display:"block"})},500)});$("#YJdiv").bind("mouseout",
function(){e=false;c==false&&setTimeout(function(){c==false&&e==false&&$("#huangliDiv").css({display:"none"})},500)});$("#huangliDiv").bind("mouseover",function(){c=true;setTimeout(function(){(e||c)&&$("#huangliDiv").css({display:"block"})},500)});$("#huangliDiv").bind("mouseout",function(){c=false;e==false&&setTimeout(function(){c==false&&e==false&&$("#huangliDiv").css({display:"none"})},500)});$("#plusDivCreate").bind("click",function(){try{var a=parseInt($("#popHourSelectNumb").html()),b=parseInt($("#popMinuteSelectNumb").html()),
c=$("#popTextarea").val().replace(/^\s*|\s*$/g,"");if(c.length==0){$("#popTextarea").css("border-color","red");var e=0,k=setInterval(function(){e++%2==0?$("#popTextarea").css("border-color","#888"):$("#popTextarea").css("border-color","red");e>=5&&clearInterval(k)},200);return}var m=false;$("#popHourSelectNumb").text()=="\u5168\u5929"&&(m=true);calendarHandler.addSch(c,m,a,b,makeCal.appendScheduleIcon)}catch(n){}$("#popTextarea").val("");$("#poparea").val("");$("#popHourSelectNumb").html("\u5168\u5929");
$("#popMinuteSelectNumb").html("0\u5206");$("#plusDivEle").css({display:"none"});$("#plusDiv").css({display:"none"})});$("#cal_plusbutton").bind("click",function(){calendarHandler.isLogin()?$("#plusDiv").css("display")=="block"?$("#closePlus").click():($("#plusTime").text(getFullDateStr(currentDate)),$("#plusDiv").css({display:"block"}),$("#plusDivEle").css({display:"block"}),$("#popSHI").css({visibility:"hidden"}),$("#popFEN").css({visibility:"hidden"}),$("#popMinuteSelect").css({visibility:"hidden"})):
bd_loginOrAuth()});$("#closePlus").bind("click",function(){$("#popTextarea").val("");$("#plusDiv").css({display:"none"});$("#plusDivEle").css({display:"none"});$("#popMinuteSelectNumb").text("0\u5206");$("#popHourSelectNumb").text("\u5168\u5929")})},makeAction:function(){$(".block").bind("click",function(a){var b=madeRiliDate.getMonth();for(ele=$(a.target);;)if(ele.hasClass("block"))break;else ele=ele.parent();$(".block").removeClass("clickBlock4");$(".block").removeClass("clickBlock5");$(".block").removeClass("clickBlock6");
click_date=calData[ele.attr("i")][ele.attr("j")].value;click_date.getMonth()==(b+11)%12?makeCal.prevMonth(click_date):click_date.getMonth()==(b+1)%12?makeCal.nextMonth(click_date):(ele.hasClass("today")==false&&(ele.hasClass("block4")?ele.addClass("clickBlock4"):ele.hasClass("block5")?ele.addClass("clickBlock5"):ele.hasClass("block6")&&ele.addClass("clickBlock6")),makeCal.makeHuangli(calData[ele.attr("i")][ele.attr("j")].value))});$("#cal_down").bind("mouseover",function(a){ele=$(a.target);for(a=
0;a<5;a++)if(ele.hasClass("block"))break;else ele=ele.parent();var a=ele.attr("i"),b=ele.attr("j");ele.hasClass("block")&&calData[a][b].hasWork?(a=calData[a][b].value,calendarHandler.setHoverDate(a),calendarHandler.drawSch(),ele.hasClass("block4")?($("#taskHover").css({display:"block"}),$("#taskHover").css({left:ele.position().left-35+"px"}),$("#taskHover").css({top:ele.position().top+66+"px"})):ele.hasClass("block5")?($("#taskHover").css({display:"block"}),$("#taskHover").css({left:ele.position().left-
35+"px"}),$("#taskHover").css({top:ele.position().top+53+"px"})):ele.hasClass("block6")&&($("#taskHover").css({display:"block"}),$("#taskHover").css({left:ele.position().left-35+"px"}),$("#taskHover").css({top:ele.position().top+46+"px"}))):$("#taskHover").css({display:"none"})})},makeHuangli:function(a){currentDate=a;var a=makeCal.setTimeZero(a),b=a.getDate();lunar=templates.lunar_Info_detail(a,function(a){Y=a.huangliY;Ys=Y.split(".");$("#ylist").empty();var b=0,c;for(c in Ys){b++;if(b>5)break;$("#ylist").append('<div class="YJdiv">'+
Ys[c]+"</div>")}$("#popYStr").empty();for(c in Ys)$("#popYStr").append('<div class="popHuangliItemY">'+Ys[c]+"</div>");J=a.huangliJ;Js=J.split(".");$("#jlist").empty();b=0;for(c in Js){b++;if(b>5)break;$("#jlist").append('<div class="YJdiv">'+Js[c]+"</div>")}$("#popJStr").empty();for(c in Js)$("#popJStr").append('<div class="popHuangliItemJ">'+Js[c]+"</div>")});$("#right_big_date").text(b);b=a.getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708 ";switch(a.getDay()){case 1:b+="\u661f\u671f\u4e00";break;
case 2:b+="\u661f\u671f\u4e8c";break;case 3:b+="\u661f\u671f\u4e09";break;case 4:b+="\u661f\u671f\u56db";break;case 5:b+="\u661f\u671f\u4e94";break;case 6:b+="\u661f\u671f\u516d";break;case 0:b+="\u661f\u671f\u65e5"}b+=" ";b+=getYearWeek(a);b+="\u5468 ";$("#gregorianDayStr").text(b);$("#popDateStr").text(getFullDateStr(a));$("#popChineseStr").text(lunar.lunar.substring(2));var b=makeCal.setTimeZero(new Date),e=b.getTime(),c=a.getTime(),e=Math.ceil((c-e)/864E5),c="";b.getDate()==a.getDate()&&(c="\u4eca\u5929");
e<0?c=0-e+"\u5929\u524d":e>0&&(c=e+"\u5929\u540e");$("#dayafterorbefore").text(c);$("#chinaDay").text(lunar.lunar.substring(2));if(a.getFullYear()==2012&&a.getMonth()==0&&a.getDate()<23)lunar.y_Info=lunar.y_Info.replace("\u9f99","\u5154");if(a.getFullYear()==2013&&(a.getMonth()==0||a.getMonth()==1&&a.getDate()<4))lunar.y_Info=lunar.y_Info.replace("\u86c7","\u9f99"),lunar.y_Info=lunar.y_Info.replace("\u7678\u5df3","\u58ec\u8fb0");info=lunar.y_Info;b=info.split(" ");$("#chinaDay2").text(b[0]);$("#chinaDay3").text(b[1]);
calendarHandler.setSelectedDate(a)},getWeekFirst:function(a){var b=a.getDay();b==0&&(b=7);return makeCal.addTime(a,0-b+1,"day")},getMonthFirst:function(a){ndate=new Date(a);ndate.setDate(1);return ndate},addTime:function(a,b,e){ndate=new Date(a);switch(e){case "day":ndate.setDate(a.getDate()+b);break;case "week":ndate.setDate(a.getDate()+7*b);break;case "month":ndate.setMonth(a.getMonth()+b);break;case "year":ndate.setYear(a.getFullYear()+b);break;case "hour":ndate.setHours(a.getHours()+b);break;
case "minute":ndate.setMinutes(a.getMinutes()+b)}return ndate},setTimeZero:function(a){ndate=new Date(a);ndate.setHours(0);ndate.setMinutes(0);ndate.setSeconds(0);ndate.setMilliseconds(0);return ndate},createDay:function(){return obj={year:0,month:0,date:0,day:0,before:false,after:false,weekend:false,china:null,rows:0,inrow:0,today:false,value:null,hasWork:false}},nextMonth:function(a){makeCal.pareData(a);makeCal.showCal(a);showingToday=false;makeCal.makeHuangli(a)},prevMonth:function(a){makeCal.pareData(a);
makeCal.showCal(a);showingToday=false;makeCal.makeHuangli(a)},showToday:function(){currentDate=new Date;makeCal.pareData(currentDate);makeCal.showCal(new Date);$("#festival").text("\u5047\u671f\u5b89\u6392");$("#year_num").text(currentDate.getFullYear());$("#month_num").text(currentDate.getMonth()+1);showingToday=true;makeCal.makeHuangli(currentDate)},bind_funcbutton:function(a,b,e){$("#"+a).bind("click",function(){$("#"+e).css({top:$("#"+a).offset().top+30+"px"});$("#"+e).css({left:$("#"+a).position().left-
39+"px"});$("#"+e).css({display:"block"});if(a=="year_func"){var b=$("#year_num").text(),b=$("#yearitem"+b).position().top;$("#"+e).scrollTop(b)}})},get365riliTime:function(){var a;if(timeBeijing!=null){a=new Date;var b=a.getTime()-timeSelf;a.setTime(timeBeijing+b)}else a=new Date;hour=a.getHours();minute=a.getMinutes();second=a.getSeconds();hour<10&&(hour="0"+hour);minute<10&&(minute="0"+minute);second<10&&(second="0"+second);return hour+":"+minute+":"+second}};
function StringBuffer(){this._strings=[]}StringBuffer.prototype.append=function(a){this._strings.push(a);return this};StringBuffer.prototype.toString=function(){return this._strings.join(arguments.length==0?"":arguments[0])};
var templates={lunar_Info:function(a){var b=cacheMgr.getCld(a.getFullYear(),a.getMonth()),e=a.getDate(),b=b[e-1],e={l_day:"",l_month:"",l_day_full:""};e.l_day=cDay(b.lDay);e.l_month=b.lMonth;e.color="";var c,g;c=b.lunarFestival;if(c.length>0)c.length>4&&(g=c.toString(),c=c.substr(0,3)+"..."),e.color="#bc5016";else if(c=b.solarTerms,g=c.toString(),a=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate(),typeof SolarTermException[a]!="undefined"&&(c=g=SolarTermException[a]),c.length>0){if(e.color="#bc5016",
c=="\u6e05\u660e"||c=="\u8292\u79cd"||c=="\u590f\u81f3"||c=="\u51ac\u81f3")e.color="#bc5016",c=="\u6e05\u660e"&&(c="\u6e05\u660e\u8282")}else if(c=b.solarFestival,g=c.toString(),c.length>4)c.length>3&&(c=c.substr(0,3)+".."),e.color="#bc5016";if(c.length>0)e.l_day=c,e.l_day_full=g;return e},lunar_Info_detail:function(a,b){var e=cacheMgr.getCld(a.getFullYear(),a.getMonth()),c=a.getFullYear(),g=a.getDate(),f=e[g-1],h={lunar:"",y_Info:"",huangliY:"\u65e0",huangliJ:"\u65e0"};h.lunar="\u519c\u5386"+(f.isLeap?
"\u95f0 ":"")+templates.getChinaNum(f.lMonth)+"\u6708"+cDay(f.lDay);h.y_Info=f.cYear+"\u5e74"+this.lunar_year(a)+" "+f.cMonth+"\u6708"+f.cDay+"\u65e5";try{if(c>=2008&&c<=2020){var j=c+""+(f.sMonth<10?"0"+f.sMonth:f.sMonth);if(eval("HuangLi.y"+j)==null)$.getScript("http://up1.365rili.com/js/huangli/month/"+j+".js",function(){var a=eval("HuangLi.y"+j+".d"+(f.sMonth<10?"0"+f.sMonth:f.sMonth)+(f.sDay<10?"0"+f.sDay:f.sDay));h.huangliY=a.y;h.huangliJ=a.j;b&&b(h)});else{var k=eval("HuangLi.y"+j+".d"+(f.sMonth<
10?"0"+f.sMonth:f.sMonth)+(f.sDay<10?"0"+f.sDay:f.sDay));h.huangliY=k.y;h.huangliJ=k.j;b&&b(h)}}else b&&b(h)}catch(m){}return h},lunar_year:function(a){return"\u3010"+Animals[(a.getFullYear()-4)%12]+"\u5e74\u3011"},getChinaNum:function(a){var b;switch(a){case 1:b="\u4e00";break;case 2:b="\u4e8c";break;case 3:b="\u4e09";break;case 4:b="\u56db";break;case 5:b="\u4e94";break;case 6:b="\u516d";break;case 7:b="\u4e03";break;case 8:b="\u516b";break;case 9:b="\u4e5d";break;case 10:b="\u5341";break;case 11:b=
"\u5341\u4e00";break;case 12:b="\u814a"}return b}};window.makeCal=calander;function getMonthDateStr(a){month=a.getMonth()+1;day=a.getDate();month<10&&(month="0"+month);day<10&&(day="0"+day);return month+""+day}function getFullDateStr(a){month=a.getMonth()+1;day=a.getDate();year=a.getFullYear();return year+"-"+month+"-"+day}
var SolarTermException={"2012-5-20":"\u5c0f\u6ee1","2012-5-21":"","2012-12-6":"","2012-12-7":"\u5927\u96ea","2013-2-3":"","2013-2-4":"\u7acb\u6625","2013-7-22":"\u5927\u6691","2013-7-23":"","2013-12-21":"","2013-12-22":"\u51ac\u81f3","2014-3-5":"","2014-3-6":"\u60ca\u86f0","2015-1-5":"","2015-1-6":"\u5c0f\u5bd2","2016-6-6":"","2016-6-7":"\u5927\u96ea","2017-7-22":"\u5927\u6691","2017-7-23":"","2017-12-21":"","2017-12-22":"\u51ac\u81f3","2018-2-18":"","2018-2-19":"\u96e8\u6c34","2018-3-20":"","2018-3-21":"\u6625\u5206",
"2019-2-4":"\u7acb\u6625","2019-2-5":"","2019-6-21":"\u590f\u81f3","2019-6-22":"","2020-7-6":"\u5c0f\u6691","2020-7-7":"","2020-8-22":"\u5904\u6691","2020-8-23":"","2020-12-6":"","2020-12-7":"\u5927\u96ea"};function getYearWeek(a){var b=new Date(a.getFullYear(),0,1),e=a.getDay();e==0&&(e=7);var c=b.getDay();c==0&&(c=7);d=Math.round((a.getTime()-b.getTime()+(c-e)*864E5)/864E5);return Math.ceil(d/7)+1}
$(document).ready(function(){calendarHandler.init();makeCal.init();if(document.body.clientWidth>540){var a=Math.floor((document.body.clientWidth-540)/2);$("#middle").css("left",a+"px")}gotoFestival();getUrlParam("t")=="t"?($("#cal_365riliUser").hide(),$("#cal_plusbutton").hide()):$.getScript("http://static.365rili.com/wannianlibaidu/js/loginV2.js")});
function getUrlParam(a){var b,e,c;b=window.location.href;e=b.indexOf("?");end=b.indexOf("#");if(end<0)end=b.length;b=b.substring(e+1,end).split("&");for(i=0;i<b.length;i++)if(c=b[i],e=c.indexOf("="),c.substring(0,e)==a)return c.substring(e+1);return null}
function gotoFestival(){var a=window.location.search.substring(1).split("&"),b="",e;for(e in a){var c=a[e].split("=");if(c.length==2&&c[0]=="s_param"){a=decodeURIComponent(c[1]).split("=");a.length==2&&(b=a[1]);break}}switch(b){case "yuandan":$("#festival_select_selecter div:nth-child(1)").trigger("click");break;case "chunjie":$("#festival_select_selecter div:nth-child(2)").trigger("click");break;case "qingming":$("#festival_select_selecter div:nth-child(3)").trigger("click");break;case "laodong":$("#festival_select_selecter div:nth-child(4)").trigger("click");
break;case "duanwu":$("#festival_select_selecter div:nth-child(5)").trigger("click");break;case "zhongqiu":$("#festival_select_selecter div:nth-child(6)").trigger("click");break;case "guoqing":$("#festival_select_selecter div:nth-child(7)").trigger("click")}};
